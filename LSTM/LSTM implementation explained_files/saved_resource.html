<!DOCTYPE html>
<!-- saved from url=(0301)https://disqus.com/embed/comments/?base=default&f=apaszke&t_i=lstm-explained&t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&t_e=LSTM%20implementation%20explained&t_d=LSTM%20implementation%20explained&t_t=LSTM%20implementation%20explained&s_o=default#version=d952d33e35a1c499438fbdfafc2ef715 -->
<html lang="en" dir="ltr" class="js no-touch localstorage sessionstorage contenteditable use-opacity-transitions"><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Disqus Comments</title>

    
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <style>
        .alert--warning {
            border-radius: 3px;
            padding: 10px 15px;
            margin-bottom: 10px;
            background-color: #FFE070;
            color: #A47703;
        }

        .alert--warning a,
        .alert--warning a:hover,
        .alert--warning strong {
            color: #A47703;
            font-weight: bold;
        }

        .alert--error p,
        .alert--warning p {
            margin-top: 5px;
            margin-bottom: 5px;
        }
        
        </style>
    
    <style>
        html {
            overflow: hidden;
        }

        #error {
            display: none;
        }

        .clearfix:after {
            content: "";
            display: block;
            height: 0;
            clear: both;
            visibility: hidden;
        }

        
    </style>

<script src="./cb=gapi.loaded_0" async=""></script><script crossorigin="anonymous" id="bootstrap-script" data-app="lounge" src="./lounge.load.d952d33e35a1c499438fbdfafc2ef715.js"></script><meta http-equiv="Content-Security-Policy" content="script-src https:;"><link rel="stylesheet" href="./lounge.5f04e83cf97ee6a6cf16dc8e296ed78d.css"><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="lounge/main" src="./lounge.bundle.987c6346e2effb8e4f350d48ecf53d13.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="remote/config" src="./config.js"></script><style id="css_1493011107766"></style><!--<base target="_parent">--><base href="." target="_parent"><link rel="stylesheet" href="./discovery.ec9371c4ef39ecee074c2acf24d5e0e2.css"><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="ga" src="./ga.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="discovery/main" src="./discovery.bundle.6aa8d068ba5176f85f980f898293fefa.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="fb" src="./sdk.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="gapi" src="./api.js" gapi_processed="true"></script><style type="text/css">.fb_hidden{position:absolute;top:-10000px;z-index:10001}.fb_reposition{overflow:hidden;position:relative}.fb_invisible{display:none}.fb_reset{background:none;border:0;border-spacing:0;color:#000;cursor:auto;direction:ltr;font-family:"lucida grande", tahoma, verdana, arial, sans-serif;font-size:11px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:1;margin:0;overflow:visible;padding:0;text-align:left;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;visibility:visible;white-space:normal;word-spacing:normal}.fb_reset>div{overflow:hidden}.fb_link img{border:none}@keyframes fb_transform{from{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}.fb_animate{animation:fb_transform .3s forwards}
.fb_dialog{background:rgba(82, 82, 82, .7);position:absolute;top:-10000px;z-index:10001}.fb_reset .fb_dialog_legacy{overflow:visible}.fb_dialog_advanced{padding:10px;-moz-border-radius:8px;-webkit-border-radius:8px;border-radius:8px}.fb_dialog_content{background:#fff;color:#333}.fb_dialog_close_icon{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 0 transparent;cursor:pointer;display:block;height:15px;position:absolute;right:18px;top:17px;width:15px}.fb_dialog_mobile .fb_dialog_close_icon{top:5px;left:5px;right:auto}.fb_dialog_padding{background-color:transparent;position:absolute;width:1px;z-index:-1}.fb_dialog_close_icon:hover{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -15px transparent}.fb_dialog_close_icon:active{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -30px transparent}.fb_dialog_loader{background-color:#f6f7f9;border:1px solid #606060;font-size:24px;padding:20px}.fb_dialog_top_left,.fb_dialog_top_right,.fb_dialog_bottom_left,.fb_dialog_bottom_right{height:10px;width:10px;overflow:hidden;position:absolute}.fb_dialog_top_left{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 0;left:-10px;top:-10px}.fb_dialog_top_right{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -10px;right:-10px;top:-10px}.fb_dialog_bottom_left{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -20px;bottom:-10px;left:-10px}.fb_dialog_bottom_right{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -30px;right:-10px;bottom:-10px}.fb_dialog_vert_left,.fb_dialog_vert_right,.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{position:absolute;background:#525252;filter:alpha(opacity=70);opacity:.7}.fb_dialog_vert_left,.fb_dialog_vert_right{width:10px;height:100%}.fb_dialog_vert_left{margin-left:-10px}.fb_dialog_vert_right{right:0;margin-right:-10px}.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{width:100%;height:10px}.fb_dialog_horiz_top{margin-top:-10px}.fb_dialog_horiz_bottom{bottom:0;margin-bottom:-10px}.fb_dialog_iframe{line-height:0}.fb_dialog_content .dialog_title{background:#6d84b4;border:1px solid #365899;color:#fff;font-size:14px;font-weight:bold;margin:0}.fb_dialog_content .dialog_title>span{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yd/r/Cou7n-nqK52.gif) no-repeat 5px 50%;float:left;padding:5px 0 7px 26px}body.fb_hidden{-webkit-transform:none;height:100%;margin:0;overflow:visible;position:absolute;top:-10000px;left:0;width:100%}.fb_dialog.fb_dialog_mobile.loading{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ya/r/3rhSv5V8j3o.gif) white no-repeat 50% 50%;min-height:100%;min-width:100%;overflow:hidden;position:absolute;top:0;z-index:10001}.fb_dialog.fb_dialog_mobile.loading.centered{width:auto;height:auto;min-height:initial;min-width:initial;background:none}.fb_dialog.fb_dialog_mobile.loading.centered #fb_dialog_loader_spinner{width:100%}.fb_dialog.fb_dialog_mobile.loading.centered .fb_dialog_content{background:none}.loading.centered #fb_dialog_loader_close{color:#fff;display:block;padding-top:20px;clear:both;font-size:18px}#fb-root #fb_dialog_ipad_overlay{background:rgba(0, 0, 0, .45);position:absolute;bottom:0;left:0;right:0;top:0;width:100%;min-height:100%;z-index:10000}#fb-root #fb_dialog_ipad_overlay.hidden{display:none}.fb_dialog.fb_dialog_mobile.loading iframe{visibility:hidden}.fb_dialog_content .dialog_header{-webkit-box-shadow:white 0 1px 1px -1px inset;background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#738ABA), to(#2C4987));border-bottom:1px solid;border-color:#1d4088;color:#fff;font:14px Helvetica, sans-serif;font-weight:bold;text-overflow:ellipsis;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0;vertical-align:middle;white-space:nowrap}.fb_dialog_content .dialog_header table{-webkit-font-smoothing:subpixel-antialiased;height:43px;width:100%}.fb_dialog_content .dialog_header td.header_left{font-size:12px;padding-left:5px;vertical-align:middle;width:60px}.fb_dialog_content .dialog_header td.header_right{font-size:12px;padding-right:5px;vertical-align:middle;width:60px}.fb_dialog_content .touchable_button{background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#4966A6), color-stop(.5, #355492), to(#2A4887));border:1px solid #29487d;-webkit-background-clip:padding-box;-webkit-border-radius:3px;-webkit-box-shadow:rgba(0, 0, 0, .117188) 0 1px 1px inset, rgba(255, 255, 255, .167969) 0 1px 0;display:inline-block;margin-top:3px;max-width:85px;line-height:18px;padding:4px 12px;position:relative}.fb_dialog_content .dialog_header .touchable_button input{border:none;background:none;color:#fff;font:12px Helvetica, sans-serif;font-weight:bold;margin:2px -12px;padding:2px 6px 3px 6px;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog_content .dialog_header .header_center{color:#fff;font-size:16px;font-weight:bold;line-height:18px;text-align:center;vertical-align:middle}.fb_dialog_content .dialog_content{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/y9/r/jKEcVPZFk-2.gif) no-repeat 50% 50%;border:1px solid #555;border-bottom:0;border-top:0;height:150px}.fb_dialog_content .dialog_footer{background:#f6f7f9;border:1px solid #555;border-top-color:#ccc;height:40px}#fb_dialog_loader_close{float:left}.fb_dialog.fb_dialog_mobile .fb_dialog_close_button{text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog.fb_dialog_mobile .fb_dialog_close_icon{visibility:hidden}#fb_dialog_loader_spinner{animation:rotateSpinner 1.2s linear infinite;background-color:transparent;background-image:url(https://static.xx.fbcdn.net/rsrc.php/v3/yD/r/t-wz8gw1xG1.png);background-repeat:no-repeat;background-position:50% 50%;height:24px;width:24px}@keyframes rotateSpinner{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
.fb_iframe_widget{display:inline-block;position:relative}.fb_iframe_widget span{display:inline-block;position:relative;text-align:justify}.fb_iframe_widget iframe{position:absolute}.fb_iframe_widget_fluid_desktop,.fb_iframe_widget_fluid_desktop span,.fb_iframe_widget_fluid_desktop iframe{max-width:100%}.fb_iframe_widget_fluid_desktop iframe{min-width:220px;position:relative}.fb_iframe_widget_lift{z-index:1}.fb_hide_iframes iframe{position:relative;left:-10000px}.fb_iframe_widget_loader{position:relative;display:inline-block}.fb_iframe_widget_fluid{display:inline}.fb_iframe_widget_fluid span{width:100%}.fb_iframe_widget_loader iframe{min-height:32px;z-index:2;zoom:1}.fb_iframe_widget_loader .FB_Loader{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/y9/r/jKEcVPZFk-2.gif) no-repeat;height:32px;width:32px;margin-left:-16px;position:absolute;left:50%;z-index:4}</style></head>
<body>
    

    
    <div id="error" class="alert--error">
        <p>We were unable to load Disqus. If you are a moderator please see our <a href="https://docs.disqus.com/help/83/"> troubleshooting guide</a>. </p>
    </div>

    
    <script type="text/json" id="disqus-forumData">{"session":{"canModerate":false,"audienceSyncVerified":false,"mustVerify":false,"canReply":true,"mustVerifyEmail":false},"features":{},"forum":{"raw_guidelines":null,"twitterName":"","guidelines":null,"favicon":{"permalink":"https://disqus.com/api/forums/favicons/apaszke.jpg","cache":"//a.disquscdn.com/1492794604/images/favicon-default.png"},"disableDisqusBranding":false,"id":"apaszke","createdAt":"2015-08-30T17:54:14.422204","category":"Tech","founder":"172362162","daysAlive":0,"installCompleted":true,"pk":"3762125","channel":null,"description":"","raw_description":"","permissions":{},"name":"Adam's blog","language":"en","settings":{"supportLevel":0,"adsDRNativeEnabled":false,"colorScheme":"auto","adsVideoEnabled":false,"adsProductVideoEnabled":false,"adsPositionTopEnabled":false,"ssoRequired":false,"unapproveLinks":false,"adsEnabled":false,"adsProductLinksThumbnailsEnabled":false,"adsProductStoriesEnabled":false,"organicDiscoveryEnabled":true,"allowMedia":true,"disable3rdPartyTrackers":false,"adsProductDisplayEnabled":false,"discoveryMax":false,"discoveryLocked":false,"moderatorText":"","linkAffiliationEnabled":true,"allowAnonPost":false,"hasCustomAvatar":false,"adultContent":false,"promotedDiscoveryEnabled":false,"allowAnonVotes":false,"mustVerify":true,"adsSettingsLocked":false,"mustVerifyEmail":true,"audienceSyncEnabled":false,"typeface":"auto","adsPositionBottomEnabled":false,"mediaembedEnabled":true,"adsProductLinksEnabled":false,"validateAllPosts":false,"discoveryThumbnailsEnabled":false,"isVIP":false,"adsPositionInthreadEnabled":false},"organizationId":2724004,"url":"","daysThreadAlive":0,"avatar":{"small":{"permalink":"https://disqus.com/api/forums/avatars/apaszke.jpg?size=32","cache":"//a.disquscdn.com/1492794604/images/noavatar32.png"},"large":{"permalink":"https://disqus.com/api/forums/avatars/apaszke.jpg?size=92","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png"}},"signedUrl":""}}</script>

    
    <script type="text/json" id="disqus-threadData">{"cursor":{"hasPrev":false,"prev":null,"total":43,"hasNext":false,"next":"1:0:0"},"code":0,"response":{"lastModified":1488896117,"posts":[{"dislikes":0,"numReports":0,"likes":3,"message":"\u003cp>Hi,  can you please update this with the training code too? \u003cbr>Also, would be great if you could have another article explaining how to build LSTM networks using the 'rnn' package (with nn.Sequencer and stuff), and how it compares to using nngraph.\u003c/p>\u003cp>Thanks for the really good explanation about building the LSTM!\u003c/p>","id":"2403096907","isHighlighted":false,"author":{"username":"aravindsrinivasl","about":"","name":"Aravind Srinivas L","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.237431,"profileUrl":"https://disqus.com/by/aravindsrinivasl/","url":"","reputation":1.237431,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2015-12-10T14:14:31","id":"186827635","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/aravindsrinivasl.jpg","cache":"https://c.disquscdn.com/uploads/users/18682/7635/avatar32.jpg?1464748477"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/aravindsrinivasl.jpg","cache":"https://c.disquscdn.com/uploads/users/18682/7635/avatar92.jpg?1464748477","large":{"permalink":"https://disqus.com/api/users/avatars/aravindsrinivasl.jpg","cache":"https://c.disquscdn.com/uploads/users/18682/7635/avatar92.jpg?1464748477"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2015-12-10T14:16:11","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Hi,  can you please update this with the training code too? \nAlso, would be great if you could have another article explaining how to build LSTM networks using the 'rnn' package (with nn.Sequencer and stuff), and how it compares to using nngraph.\n\nThanks for the really good explanation about building the LSTM!","canVote":false,"thread":"4081981091","forum":"apaszke","depth":0,"points":3,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Hi Aravind. Sorry for a late reply. I haven't used rnn package yet, because nngraph fitted nicely into my models so far. I'm planning to do some extensions to this post, which include adding a section on training LSTM networks.\u003c/p>","id":"2542268015","isHighlighted":false,"author":{"username":"adampaszke","about":"","name":"Adam Paszke","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.238224,"profileUrl":"https://disqus.com/by/adampaszke/","url":"","reputation":1.238224,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2015-08-30T21:53:02","id":"172362162","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-02-28T23:25:53","parent":2403096907,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Hi Aravind. Sorry for a late reply. I haven't used rnn package yet, because nngraph fitted nicely into my models so far. I'm planning to do some extensions to this post, which include adding a section on training LSTM networks.","canVote":false,"thread":"4081981091","forum":"apaszke","depth":1,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>I think there is no such thing as rnn package, you have to build RNN with nngraph.\u003c/p>","id":"2534353533","isHighlighted":false,"author":{"username":"disqus_TsTw5z52iB","about":"","name":"Bruce Zhang","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.233917,"profileUrl":"https://disqus.com/by/disqus_TsTw5z52iB/","url":"","reputation":1.233917,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2016-01-29T08:56:33","id":"194044248","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_TsTw5z52iB.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/disqus_TsTw5z52iB.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_TsTw5z52iB.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-02-25T10:18:16","parent":2403096907,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"I think there is no such thing as rnn package, you have to build RNN with nngraph.","canVote":false,"thread":"4081981091","forum":"apaszke","depth":1,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>In fact there is an rnn package by Nicholas L\u00e9onard, but it's not included in torch core. See \u003ca href=\"https://disq.us/url?url=https%3A%2F%2Fgithub.com%2FElement-Research%2Frnn%3A2cchRibNtQPiAEfpdDv4dAfhfk8&amp;cuid=3762125\" rel=\"nofollow noopener\">this repository\u003c/a>.\u003c/p>","id":"2542264658","isHighlighted":false,"author":{"username":"adampaszke","about":"","name":"Adam Paszke","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.238224,"profileUrl":"https://disqus.com/by/adampaszke/","url":"","reputation":1.238224,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2015-08-30T21:53:02","id":"172362162","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-02-28T23:24:24","parent":2534353533,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"In fact there is an rnn package by Nicholas L\u00e9onard, but it's not included in torch core. See \u003ca href=\"https://github.com/Element-Research/rnn\">this repository\u003c/a>.","canVote":false,"thread":"4081981091","forum":"apaszke","depth":2,"points":0,"moderationLabels":["links"],"isEdited":true},{"dislikes":0,"numReports":0,"likes":1,"message":"\u003cp>hi great stuff.\u003cbr>i'm gonno ask this just to be sure :\u003cbr>you have 3 inputs for forward pass\u003cbr>so f i want to us it in multiple steps i have to give this layer the resuls of the last step for two of those inputs right?\u003cbr>this is making it too hard could you just take the input and somehow insert the ht-1  ?\u003c/p>","id":"2492364557","isHighlighted":false,"author":{"username":"disqus_aISFArTPT6","about":"","name":"soshiant","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.23603,"profileUrl":"https://disqus.com/by/disqus_aISFArTPT6/","url":"","reputation":1.23603,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2016-02-02T18:10:08","id":"194596855","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_aISFArTPT6.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/disqus_aISFArTPT6.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_aISFArTPT6.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-02-02T18:20:30","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"hi great stuff.\ni'm gonno ask this just to be sure :\nyou have 3 inputs for forward pass\nso f i want to us it in multiple steps i have to give this layer the resuls of the last step for two of those inputs right?\nthis is making it too hard could you just take the input and somehow insert the ht-1  ?","canVote":false,"thread":"4081981091","forum":"apaszke","depth":0,"points":1,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Yes, two of the outputs are inputs in the next time step. Unfortunately, I don't think it can be done in a simpler way.\u003c/p>","id":"2542272838","isHighlighted":false,"author":{"username":"adampaszke","about":"","name":"Adam Paszke","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.238224,"profileUrl":"https://disqus.com/by/adampaszke/","url":"","reputation":1.238224,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2015-08-30T21:53:02","id":"172362162","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-02-28T23:28:11","parent":2492364557,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Yes, two of the outputs are inputs in the next time step. Unfortunately, I don't think it can be done in a simpler way.","canVote":false,"thread":"4081981091","forum":"apaszke","depth":1,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Hi, i'm trying to implement own LSTM for better understanding. Unfortunately my backprop algorithm doesn't pass gradient check. Could you kindly help me?\u003c/p>","id":"3190751591","isHighlighted":false,"author":{"username":"igorchernobaev","about":"","name":"Igor Chernobaev","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.236921,"profileUrl":"https://disqus.com/by/igorchernobaev/","url":"","reputation":1.236921,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2015-10-12T17:47:08","id":"178294769","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/igorchernobaev.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/igorchernobaev.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/igorchernobaev.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-03-07T14:15:16","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Hi, i'm trying to implement own LSTM for better understanding. Unfortunately my backprop algorithm doesn't pass gradient check. Could you kindly help me?","canVote":false,"thread":"4081981091","forum":"apaszke","depth":0,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Excellent post - very helpful.  Much appreciated Adam!\u003c/p>","id":"2978686662","isHighlighted":false,"author":{"username":"faiyazlalani","about":"","name":"Faiyaz Lalani","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.240109,"profileUrl":"https://disqus.com/by/faiyazlalani/","url":"","reputation":1.240109,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2016-11-01T02:28:49","id":"228451061","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/faiyazlalani.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/faiyazlalani.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/faiyazlalani.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-11-01T02:31:17","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Excellent post - very helpful.  Much appreciated Adam!","canVote":false,"thread":"4081981091","forum":"apaszke","depth":0,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>I am interested in knowing that how lstm model is trained.\u003c/p>","id":"2948125410","isHighlighted":false,"author":{"username":"disqus_d0sJQt6fLf","about":"","name":"fnm","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.235932,"profileUrl":"https://disqus.com/by/disqus_d0sJQt6fLf/","url":"","reputation":1.235932,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2016-10-13T08:02:07","id":"226348288","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_d0sJQt6fLf.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/disqus_d0sJQt6fLf.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_d0sJQt6fLf.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-10-13T08:45:31","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"I am interested in knowing that how lstm model is trained.","canVote":false,"thread":"4081981091","forum":"apaszke","depth":0,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>It would be cool to have the training procedure as well\u003c/p>","id":"2794888435","isHighlighted":false,"author":{"username":"yitzhakspielberg","about":"","name":"Yitzhak Spielberg","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.23667,"profileUrl":"https://disqus.com/by/yitzhakspielberg/","url":"","reputation":1.23667,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2016-07-21T07:22:28","id":"215820942","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/yitzhakspielberg.jpg","cache":"https://c.disquscdn.com/uploads/users/21582/942/avatar32.jpg?1469086410"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/yitzhakspielberg.jpg","cache":"https://c.disquscdn.com/uploads/users/21582/942/avatar92.jpg?1469086410","large":{"permalink":"https://disqus.com/api/users/avatars/yitzhakspielberg.jpg","cache":"https://c.disquscdn.com/uploads/users/21582/942/avatar92.jpg?1469086410"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-07-21T07:33:02","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"It would be cool to have the training procedure as well","canVote":false,"thread":"4081981091","forum":"apaszke","depth":0,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Hi, how do I build a model with multiple lstm layers? for ordinary neural nets I used nn.sequential to build the model and model:forward(x) to calculate the output. How does it work in this case? A simple example, let's say with 2 lstm layers would be really helpful.\u003c/p>","id":"2794847588","isHighlighted":false,"author":{"username":"yitzhakspielberg","about":"","name":"Yitzhak Spielberg","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.23667,"profileUrl":"https://disqus.com/by/yitzhakspielberg/","url":"","reputation":1.23667,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2016-07-21T07:22:28","id":"215820942","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/yitzhakspielberg.jpg","cache":"https://c.disquscdn.com/uploads/users/21582/942/avatar32.jpg?1469086410"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/yitzhakspielberg.jpg","cache":"https://c.disquscdn.com/uploads/users/21582/942/avatar92.jpg?1469086410","large":{"permalink":"https://disqus.com/api/users/avatars/yitzhakspielberg.jpg","cache":"https://c.disquscdn.com/uploads/users/21582/942/avatar92.jpg?1469086410"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-07-21T07:24:56","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Hi, how do I build a model with multiple lstm layers? for ordinary neural nets I used nn.sequential to build the model and model:forward(x) to calculate the output. How does it work in this case? A simple example, let's say with 2 lstm layers would be really helpful.","canVote":false,"thread":"4081981091","forum":"apaszke","depth":0,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>solved. just found the multilayer example above.\u003c/p>","id":"2794890520","isHighlighted":false,"author":{"username":"yitzhakspielberg","about":"","name":"Yitzhak Spielberg","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.23667,"profileUrl":"https://disqus.com/by/yitzhakspielberg/","url":"","reputation":1.23667,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2016-07-21T07:22:28","id":"215820942","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/yitzhakspielberg.jpg","cache":"https://c.disquscdn.com/uploads/users/21582/942/avatar32.jpg?1469086410"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/yitzhakspielberg.jpg","cache":"https://c.disquscdn.com/uploads/users/21582/942/avatar92.jpg?1469086410","large":{"permalink":"https://disqus.com/api/users/avatars/yitzhakspielberg.jpg","cache":"https://c.disquscdn.com/uploads/users/21582/942/avatar92.jpg?1469086410"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-07-21T07:33:29","parent":2794847588,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"solved. just found the multilayer example above.","canVote":false,"thread":"4081981091","forum":"apaszke","depth":1,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Hi, Thank you for this nice post about LSTM, I would like to explain me how we could implement the LSTM attention.\u003c/p>","id":"2783959255","isHighlighted":false,"author":{"username":"mohammed_jabreel","about":"","name":"Mohammed Jabreel","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.235932,"profileUrl":"https://disqus.com/by/mohammed_jabreel/","url":"","reputation":1.235932,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2016-07-15T00:34:45","id":"215127778","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/mohammed_jabreel.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/mohammed_jabreel.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/mohammed_jabreel.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-07-15T00:35:40","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Hi, Thank you for this nice post about LSTM, I would like to explain me how we could implement the LSTM attention.","canVote":false,"thread":"4081981091","forum":"apaszke","depth":0,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Nice LSTM post, but I have a question,how the gate units can protect the gradient inside the cell from harmful changes during the training, if there existes some explanation in math?\u003c/p>","id":"2752671300","isHighlighted":false,"author":{"username":"disqus_69LPgvlRKI","about":"","name":"simon","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.235932,"profileUrl":"https://disqus.com/by/disqus_69LPgvlRKI/","url":"","reputation":1.235932,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2016-06-27T08:47:21","id":"213022569","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_69LPgvlRKI.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/disqus_69LPgvlRKI.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_69LPgvlRKI.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-06-27T08:48:52","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Nice LSTM post, but I have a question,how the gate units can protect the gradient inside the cell from harmful changes during the training, if there existes some explanation in math?","canVote":false,"thread":"4081981091","forum":"apaszke","depth":0,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Noob question: How can I compute the RNN output with this? layer:forward() only gives the updated hidden and cell state...but how do I get the networks predictions?\u003c/p>","id":"2725100813","isHighlighted":false,"author":{"username":"lucanaterop","about":"","name":"Luca Naterop","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.2356639999999999,"profileUrl":"https://disqus.com/by/lucanaterop/","url":"","reputation":1.2356639999999999,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2013-07-25T20:25:53","id":"64200016","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/lucanaterop.jpg","cache":"https://c.disquscdn.com/uploads/users/6420/16/avatar32.jpg?1468161995"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/lucanaterop.jpg","cache":"https://c.disquscdn.com/uploads/users/6420/16/avatar92.jpg?1468161995","large":{"permalink":"https://disqus.com/api/users/avatars/lucanaterop.jpg","cache":"https://c.disquscdn.com/uploads/users/6420/16/avatar92.jpg?1468161995"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-06-11T15:50:54","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Noob question: How can I compute the RNN output with this? layer:forward() only gives the updated hidden and cell state...but how do I get the networks predictions?","canVote":false,"thread":"4081981091","forum":"apaszke","depth":0,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Hi, nice article. The LSTM obtained above won't have tied weights. Hence, I had 2 questions.\u003c/p>\u003cp>1) Is it more common to have tied weights between different LSTM units.\u003cbr>2) Can this simply be achieved by getting the parameters pointer of the first unit, and setting the parameters of all successive units to point to that pointer (Similar for gradient)\u003c/p>","id":"2646947651","isHighlighted":false,"author":{"username":"disqus_FE6W9KzWs8","about":"Super Zero","name":"Gaurav Pandey","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.2376699999999998,"profileUrl":"https://disqus.com/by/disqus_FE6W9KzWs8/","url":"","reputation":1.2376699999999998,"location":"Jungles of Africa","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2014-04-10T15:18:11","id":"102620122","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_FE6W9KzWs8.jpg","cache":"https://c.disquscdn.com/uploads/users/10262/122/avatar32.jpg?1461831047"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/disqus_FE6W9KzWs8.jpg","cache":"https://c.disquscdn.com/uploads/users/10262/122/avatar92.jpg?1461831047","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_FE6W9KzWs8.jpg","cache":"https://c.disquscdn.com/uploads/users/10262/122/avatar92.jpg?1461831047"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-04-28T08:10:46","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Hi, nice article. The LSTM obtained above won't have tied weights. Hence, I had 2 questions.\n\n1) Is it more common to have tied weights between different LSTM units.\n2) Can this simply be achieved by getting the parameters pointer of the first unit, and setting the parameters of all successive units to point to that pointer (Similar for gradient)","canVote":false,"thread":"4081981091","forum":"apaszke","depth":0,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Hi. Thanks for this! It would be great if you could also update the training code. This has been very helpful for me in learning about LSTM.\u003c/p>","id":"2542259263","isHighlighted":false,"author":{"username":"disqus_JKmCckR2Jw","about":"","name":"Mahati","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.235932,"profileUrl":"https://disqus.com/by/disqus_JKmCckR2Jw/","url":"","reputation":1.235932,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2016-02-28T23:18:50","id":"198542359","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_JKmCckR2Jw.jpg","cache":"https://c.disquscdn.com/uploads/users/19854/2359/avatar32.jpg?1456701532"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/disqus_JKmCckR2Jw.jpg","cache":"https://c.disquscdn.com/uploads/users/19854/2359/avatar92.jpg?1456701532","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_JKmCckR2Jw.jpg","cache":"https://c.disquscdn.com/uploads/users/19854/2359/avatar92.jpg?1456701532"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-02-28T23:20:07","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Hi. Thanks for this! It would be great if you could also update the training code. This has been very helpful for me in learning about LSTM.","canVote":false,"thread":"4081981091","forum":"apaszke","depth":0,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Hi Mahati. Great to hear that it was helpful for you. I am planning to expand this post in the near future and there will be some training examples provided.\u003c/p>","id":"2542262312","isHighlighted":false,"author":{"username":"adampaszke","about":"","name":"Adam Paszke","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.238224,"profileUrl":"https://disqus.com/by/adampaszke/","url":"","reputation":1.238224,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2015-08-30T21:53:02","id":"172362162","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-02-28T23:22:30","parent":2542259263,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Hi Mahati. Great to hear that it was helpful for you. I am planning to expand this post in the near future and there will be some training examples provided.","canVote":false,"thread":"4081981091","forum":"apaszke","depth":1,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Once you have your \"layer\" variable, can you use it as a traditional nn.Module and start the training?\u003c/p>","id":"2444132313","isHighlighted":false,"author":{"username":"disqus_Pcs7K2lnNd","about":"","name":"Marco Damonte","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.2324929999999998,"profileUrl":"https://disqus.com/by/disqus_Pcs7K2lnNd/","url":"","reputation":1.2324929999999998,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2016-01-05T13:13:30","id":"190738230","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_Pcs7K2lnNd.jpg","cache":"https://c.disquscdn.com/uploads/users/19073/8230/avatar32.jpg?1461337342"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/disqus_Pcs7K2lnNd.jpg","cache":"https://c.disquscdn.com/uploads/users/19073/8230/avatar92.jpg?1461337342","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_Pcs7K2lnNd.jpg","cache":"https://c.disquscdn.com/uploads/users/19073/8230/avatar92.jpg?1461337342"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-01-07T09:12:26","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Once you have your \"layer\" variable, can you use it as a traditional nn.Module and start the training?","canVote":false,"thread":"4081981091","forum":"apaszke","depth":0,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Yes! gModule has the same API as all nn modules.\u003c/p>","id":"2542261364","isHighlighted":false,"author":{"username":"adampaszke","about":"","name":"Adam Paszke","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.238224,"profileUrl":"https://disqus.com/by/adampaszke/","url":"","reputation":1.238224,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2015-08-30T21:53:02","id":"172362162","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-02-28T23:21:45","parent":2444132313,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Yes! gModule has the same API as all nn modules.","canVote":false,"thread":"4081981091","forum":"apaszke","depth":1,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>\u003ca data-dsq-mention=\"adampaszke:disqus\" href=\"https://disqus.com/by/adampaszke/\" rel=\"nofollow noopener\">Adam Paszke\u003c/a>, what is the dimension of preactivations? I think it is just a 1D vector of size 4 * rnn_size,  but why the first argument of nn.Narrow(2, 1, 3 * rnn_size) is 2?\u003c/p>","id":"2337287437","isHighlighted":false,"author":{"username":"aiqunhuang","about":"","name":"Aiqun Huang","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.237973,"profileUrl":"https://disqus.com/by/aiqunhuang/","url":"","reputation":1.237973,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2014-07-18T15:53:39","id":"114896406","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/aiqunhuang.jpg","cache":"https://c.disquscdn.com/uploads/users/11489/6406/avatar32.jpg?1446414669"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/aiqunhuang.jpg","cache":"https://c.disquscdn.com/uploads/users/11489/6406/avatar92.jpg?1446414669","large":{"permalink":"https://disqus.com/api/users/avatars/aiqunhuang.jpg","cache":"https://c.disquscdn.com/uploads/users/11489/6406/avatar92.jpg?1446414669"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2015-11-01T04:22:42","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"@adampaszke:disqus, what is the dimension of preactivations? I think it is just a 1D vector of size 4 * rnn_size,  but why the first argument of nn.Narrow(2, 1, 3 * rnn_size) is 2?","canVote":false,"thread":"4081981091","forum":"apaszke","depth":0,"points":0,"moderationLabels":[],"isEdited":true},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>\u003ca data-dsq-mention=\"adampaszke:disqus\" href=\"https://disqus.com/by/adampaszke/\" rel=\"nofollow noopener\">Adam Paszke\u003c/a>, I think I got it. The 1st argument of nn.Narrow should be 2, which means along the column dimension choosing 3*rnn_size columns, and in the case of preactivations, each column has only 1 element.\u003cbr>\u003c/p>","id":"2337760514","isHighlighted":false,"author":{"username":"aiqunhuang","about":"","name":"Aiqun Huang","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.237973,"profileUrl":"https://disqus.com/by/aiqunhuang/","url":"","reputation":1.237973,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2014-07-18T15:53:39","id":"114896406","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/aiqunhuang.jpg","cache":"https://c.disquscdn.com/uploads/users/11489/6406/avatar32.jpg?1446414669"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/aiqunhuang.jpg","cache":"https://c.disquscdn.com/uploads/users/11489/6406/avatar92.jpg?1446414669","large":{"permalink":"https://disqus.com/api/users/avatars/aiqunhuang.jpg","cache":"https://c.disquscdn.com/uploads/users/11489/6406/avatar92.jpg?1446414669"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2015-11-01T16:28:09","parent":2337287437,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"@adampaszke:disqus, I think I got it. The 1st argument of nn.Narrow should be 2, which means along the column dimension choosing 3*rnn_size columns, and in the case of preactivations, each column has only 1 element.\n","canVote":false,"thread":"4081981091","forum":"apaszke","depth":1,"points":0,"moderationLabels":[],"isEdited":true},{"dislikes":0,"numReports":0,"likes":1,"message":"\u003cp>Yeah. This module runs in batch mode only, so even if you're only doing one step at a time, you should input a 1xN matrix. The activations for respective cells are in the columns :)\u003c/p>\u003cp>In this way you can train or predict with LSTMs on several inputs in parallel (if you add more rows).\u003c/p>","id":"2337782274","isHighlighted":false,"author":{"username":"adampaszke","about":"","name":"Adam Paszke","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.238224,"profileUrl":"https://disqus.com/by/adampaszke/","url":"","reputation":1.238224,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2015-08-30T21:53:02","id":"172362162","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2015-11-01T16:46:54","parent":2337760514,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Yeah. This module runs in batch mode only, so even if you're only doing one step at a time, you should input a 1xN matrix. The activations for respective cells are in the columns :)\n\n\nIn this way you can train or predict with LSTMs on several inputs in parallel (if you add more rows).","canVote":false,"thread":"4081981091","forum":"apaszke","depth":2,"points":1,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Thanks \u003ca data-dsq-mention=\"adampaszke:disqus\" href=\"https://disqus.com/by/adampaszke/\" rel=\"nofollow noopener\">Adam Paszke\u003c/a> for such detailed step-by-step LSTM explanation. I have a question. In original paper and other sources there is nothing like rnn_size (basically, rnn_size equals to 1 there). Having rnn_size &gt; 1 just sounds like having rnn_size number of all the gates (so, instead of 4 gates it will be 4*rnn_size). The question is how did you come up with that param? Did you have a chance to see the affect of different rnn_size in prediction quality? any link is helpful, thanks!\u003c/p>","id":"2333428554","isHighlighted":false,"author":{"username":"disqus_cBTeXGHYne","about":"","name":"Maxim  Ivanov","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.2324929999999998,"profileUrl":"https://disqus.com/by/disqus_cBTeXGHYne/","url":"","reputation":1.2324929999999998,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2015-10-29T17:21:24","id":"180691959","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_cBTeXGHYne.jpg","cache":"https://c.disquscdn.com/uploads/users/18069/1959/avatar32.jpg?1446143477"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/disqus_cBTeXGHYne.jpg","cache":"https://c.disquscdn.com/uploads/users/18069/1959/avatar92.jpg?1446143477","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_cBTeXGHYne.jpg","cache":"https://c.disquscdn.com/uploads/users/18069/1959/avatar92.jpg?1446143477"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2015-10-29T17:49:56","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Thanks @adampaszke:disqus for such detailed step-by-step LSTM explanation. I have a question. In original paper and other sources there is nothing like rnn_size (basically, rnn_size equals to 1 there). Having rnn_size > 1 just sounds like having rnn_size number of all the gates (so, instead of 4 gates it will be 4*rnn_size). The question is how did you come up with that param? Did you have a chance to see the affect of different rnn_size in prediction quality? any link is helpful, thanks!","canVote":false,"thread":"4081981091","forum":"apaszke","depth":0,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>oh, I see. LSTM.create(3,2) can be considered as layer with 2 LSTM units. Each of them is original LSTM unit with 4 gates. Makes sense?\u003c/p>","id":"2333501354","isHighlighted":false,"author":{"username":"disqus_cBTeXGHYne","about":"","name":"Maxim  Ivanov","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.2324929999999998,"profileUrl":"https://disqus.com/by/disqus_cBTeXGHYne/","url":"","reputation":1.2324929999999998,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2015-10-29T17:21:24","id":"180691959","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_cBTeXGHYne.jpg","cache":"https://c.disquscdn.com/uploads/users/18069/1959/avatar32.jpg?1446143477"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/disqus_cBTeXGHYne.jpg","cache":"https://c.disquscdn.com/uploads/users/18069/1959/avatar92.jpg?1446143477","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_cBTeXGHYne.jpg","cache":"https://c.disquscdn.com/uploads/users/18069/1959/avatar92.jpg?1446143477"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2015-10-29T18:31:16","parent":2333428554,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"oh, I see. LSTM.create(3,2) can be considered as layer with 2 LSTM units. Each of them is original LSTM unit with 4 gates. Makes sense?","canVote":false,"thread":"4081981091","forum":"apaszke","depth":1,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Exactly! This would be the layer that accepts an input vector of length 3 and uses 2 LSTM units to generate output of length 2. Second parameter (let's call it x) determines how many units will be used (so there will be 4*x gates).\u003c/p>\u003cp>Regarding Your question about the prediction quality, I'd say it depends on a problem. Bigger sizes allow the layer to be more expressive and exhibit more complex behaviour, but can also lead to overfitting (just like with the regular Linear layers). In the 'Visualizing and Understanding Recurrent Networks' paper You can find a table that lists some benchmark results for LSTM networks with varying number of layers and sizes (on top of page 4).\u003c/p>","id":"2333848755","isHighlighted":false,"author":{"username":"adampaszke","about":"","name":"Adam Paszke","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.238224,"profileUrl":"https://disqus.com/by/adampaszke/","url":"","reputation":1.238224,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2015-08-30T21:53:02","id":"172362162","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2015-10-29T22:08:04","parent":2333501354,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Exactly! This would be the layer that accepts an input vector of length 3 and uses 2 LSTM units to generate output of length 2. Second parameter (let's call it x) determines how many units will be used (so there will be 4*x gates).\n\nRegarding Your question about the prediction quality, I'd say it depends on a problem. Bigger sizes allow the layer to be more expressive and exhibit more complex behaviour, but can also lead to overfitting (just like with the regular Linear layers). In the 'Visualizing and Understanding Recurrent Networks' paper You can find a table that lists some benchmark results for LSTM networks with varying number of layers and sizes (on top of page 4).","canVote":false,"thread":"4081981091","forum":"apaszke","depth":2,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Really good article. I am glad that someone explain the LSTM. It is hard to understand without good examples. I want to ask you, if you have plan to expand this article about training the LSTM?\u003c/p>","id":"2319806084","isHighlighted":false,"author":{"username":"peteruherek","about":"","name":"Peter Uherek","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.233646,"profileUrl":"https://disqus.com/by/peteruherek/","url":"","reputation":1.233646,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2014-01-07T14:08:35","id":"89533556","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/peteruherek.jpg","cache":"https://c.disquscdn.com/uploads/users/8953/3556/avatar32.jpg?1445461711"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/peteruherek.jpg","cache":"https://c.disquscdn.com/uploads/users/8953/3556/avatar92.jpg?1445461711","large":{"permalink":"https://disqus.com/api/users/avatars/peteruherek.jpg","cache":"https://c.disquscdn.com/uploads/users/8953/3556/avatar92.jpg?1445461711"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2015-10-21T21:08:30","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Really good article. I am glad that someone explain the LSTM. It is hard to understand without good examples. I want to ask you, if you have plan to expand this article about training the LSTM?","canVote":false,"thread":"4081981091","forum":"apaszke","depth":0,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":1,"message":"\u003cp>I'll try to, if only I'll have some time :)\u003c/p>\u003cp>It's very similar to training regular NN modules. Do you know the API? You can read more in \u003ca href=\"https://disq.us/url?url=https%3A%2F%2Fgithub.com%2Ftorch%2Fnn%2Fblob%2Fmaster%2Fdoc%2Fmodule.md%3A5TyRqHzYRhxbwBGgKDPRaL3d9Wg&amp;cuid=3762125\" rel=\"nofollow noopener\">here\u003c/a> and \u003ca href=\"https://disq.us/url?url=https%3A%2F%2Fgithub.com%2Ftorch%2Fnn%2Fblob%2Fmaster%2Fdoc%2Ftraining.md%23example-of-manual-training-of-a-neural-network%3AaX038om_lNKiLrjsjwVnRC2pqjk&amp;cuid=3762125\" rel=\"nofollow noopener\">here (just the exmaple of manual training)\u003c/a>. I hope this helps at least a bit!\u003c/p>","id":"2319812144","isHighlighted":false,"author":{"username":"adampaszke","about":"","name":"Adam Paszke","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.238224,"profileUrl":"https://disqus.com/by/adampaszke/","url":"","reputation":1.238224,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2015-08-30T21:53:02","id":"172362162","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2015-10-21T21:12:17","parent":2319806084,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"I'll try to, if only I'll have some time :)\n\nIt's very similar to training regular NN modules. Do you know the API? You can read more in \u003ca href=\"https://github.com/torch/nn/blob/master/doc/module.md\">here\u003c/a> and \u003ca href=\"https://github.com/torch/nn/blob/master/doc/training.md#example-of-manual-training-of-a-neural-network\">here (just the exmaple of manual training)\u003c/a>. I hope this helps at least a bit!","canVote":false,"thread":"4081981091","forum":"apaszke","depth":1,"points":1,"moderationLabels":["links"],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>How to use\u003c/p>\u003cp>layer:backward()\u003c/p>","id":"2304665761","isHighlighted":false,"author":{"username":"bibekanandakundu","about":"","name":"Bibekananda Kundu","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.23667,"profileUrl":"https://disqus.com/by/bibekanandakundu/","url":"","reputation":1.23667,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2015-10-08T08:46:52","id":"177745908","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/bibekanandakundu.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/bibekanandakundu.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/bibekanandakundu.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2015-10-13T09:17:04","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"How to use \n\nlayer:backward()","canVote":false,"thread":"4081981091","forum":"apaszke","depth":0,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Can you please provide the code for training the LSTM ?\u003c/p>","id":"2304642397","isHighlighted":false,"author":{"username":"bibekanandakundu","about":"","name":"Bibekananda Kundu","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.23667,"profileUrl":"https://disqus.com/by/bibekanandakundu/","url":"","reputation":1.23667,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2015-10-08T08:46:52","id":"177745908","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/bibekanandakundu.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/bibekanandakundu.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/bibekanandakundu.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2015-10-13T09:01:33","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Can you please provide the code for training the LSTM ?","canVote":false,"thread":"4081981091","forum":"apaszke","depth":0,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>I really liked your article, and it's encouraged me to have a go building LSTMs too. I forked your examples and have been testing it, to try and do learning with it on some data I have. But, I think I'm misunderstand how training fits into your example.\u003c/p>\u003cp>My code is on github along with test data. \u003ca href=\"https://disq.us/url?url=https%3A%2F%2Fgithub.com%2Fbytesumo%2FLSTM-Experiments%2Fblob%2Fmaster%2Ftc_lstm.lua%3A2O47SxeiOJeIJtY9pK4kzH59FA8&amp;cuid=3762125\" rel=\"nofollow noopener\">https://github.com/bytesumo...\u003c/a>\u003c/p>\u003cp>Maybe you could glance at it, offer a pointer to fixing the training process? \u003cbr>Many thanks, Andrew.\u003c/p>","id":"2281740898","isHighlighted":false,"author":{"username":"minkymorgan","about":"","name":"Andrew Morgan","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.2324929999999998,"profileUrl":"https://disqus.com/by/minkymorgan/","url":"","reputation":1.2324929999999998,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2015-09-30T11:48:37","id":"176752555","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/minkymorgan.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/minkymorgan.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/minkymorgan.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2015-09-30T11:53:20","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"I really liked your article, and it's encouraged me to have a go building LSTMs too. I forked your examples and have been testing it, to try and do learning with it on some data I have. But, I think I'm misunderstand how training fits into your example. \n\nMy code is on github along with test data. https://github.com/bytesumo/LSTM-Experiments/blob/master/tc_lstm.lua\n\nMaybe you could glance at it, offer a pointer to fixing the training process? \nMany thanks, Andrew.","canVote":false,"thread":"4081981091","forum":"apaszke","depth":0,"points":0,"moderationLabels":["links"],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>The link you posted gives me a 404 :/\u003cbr>Did you solve the issue? I can't see LSTM implementation in your code.\u003c/p>","id":"2287686610","isHighlighted":false,"author":{"username":"adampaszke","about":"","name":"Adam Paszke","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.238224,"profileUrl":"https://disqus.com/by/adampaszke/","url":"","reputation":1.238224,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2015-08-30T21:53:02","id":"172362162","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2015-10-03T11:27:50","parent":2281740898,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"The link you posted gives me a 404 :/\nDid you solve the issue? I can't see LSTM implementation in your code.","canVote":false,"thread":"4081981091","forum":"apaszke","depth":1,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>yeah ... so my initial enthusiasm ebbed as I realised my attempt was rubbish! So ditched it and settled on trying some experiments with a working library rnn. My experimental code is here. \u003ca href=\"https://disq.us/url?url=https%3A%2F%2Fgithub.com%2Fbytesumo%2FLSTM-Experiments%3AummHjBixQ494XwiRvfM494oKklk&amp;cuid=3762125\" rel=\"nofollow noopener\">https://github.com/bytesumo...\u003c/a>\u003cbr>Still not sure it learns anything, but most bugs ironed out now.\u003c/p>","id":"2291128732","isHighlighted":false,"author":{"username":"minkymorgan","about":"","name":"Andrew Morgan","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.2324929999999998,"profileUrl":"https://disqus.com/by/minkymorgan/","url":"","reputation":1.2324929999999998,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2015-09-30T11:48:37","id":"176752555","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/minkymorgan.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/minkymorgan.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/minkymorgan.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2015-10-05T14:16:30","parent":2287686610,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"yeah ... so my initial enthusiasm ebbed as I realised my attempt was rubbish! So ditched it and settled on trying some experiments with a working library rnn. My experimental code is here. https://github.com/bytesumo/LSTM-Experiments\nStill not sure it learns anything, but most bugs ironed out now.","canVote":false,"thread":"4081981091","forum":"apaszke","depth":2,"points":0,"moderationLabels":["links"],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Hi, this model may better have a updateOutput() &amp; backward() since it behaves different from Containers such as Sequential &amp; Concat. While it's exactly what you need to define in training, but putting things together (combine all layers in a complete Module) permits you convenience to optimize parameters as a whole. Cheers.\u003c/p>","id":"2281366551","isHighlighted":false,"author":{"username":"vikingender","about":"","name":"Viking Ender","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.246967,"profileUrl":"https://disqus.com/by/vikingender/","url":"","reputation":1.246967,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2013-11-09T13:29:32","id":"81098224","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/vikingender.jpg","cache":"https://c.disquscdn.com/uploads/users/8109/8224/avatar32.jpg?1444569281"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/vikingender.jpg","cache":"https://c.disquscdn.com/uploads/users/8109/8224/avatar92.jpg?1444569281","large":{"permalink":"https://disqus.com/api/users/avatars/vikingender.jpg","cache":"https://c.disquscdn.com/uploads/users/8109/8224/avatar92.jpg?1444569281"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2015-09-30T06:37:34","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Hi, this model may better have a updateOutput() & backward() since it behaves different from Containers such as Sequential & Concat. While it's exactly what you need to define in training, but putting things together (combine all layers in a complete Module) permits you convenience to optimize parameters as a whole. Cheers.","canVote":false,"thread":"4081981091","forum":"apaszke","depth":0,"points":0,"moderationLabels":[],"isEdited":true},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Uh, you could combine the layers in some kind of container, but I haven't tried it yet. Anyway, it's a thing worth adding here! Thanks!\u003c/p>","id":"2287690054","isHighlighted":false,"author":{"username":"adampaszke","about":"","name":"Adam Paszke","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.238224,"profileUrl":"https://disqus.com/by/adampaszke/","url":"","reputation":1.238224,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2015-08-30T21:53:02","id":"172362162","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2015-10-03T11:32:21","parent":2281366551,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Uh, you could combine the layers in some kind of container, but I haven't tried it yet. Anyway, it's a thing worth adding here! Thanks!","canVote":false,"thread":"4081981091","forum":"apaszke","depth":1,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>I have an implementation here, the LSTM module mainly was copied from yours. So your code should work with mine as well. \u003ca href=\"https://disq.us/url?url=https%3A%2F%2Fgithub.com%2FKHN190%2Ftorch-RNN%2Ftree%2Fmaster%2Fbone%3ArzO2MdzZlqcZoDytBcjMphRUq6w&amp;cuid=3762125\" rel=\"nofollow noopener\">https://github.com/KHN190/t...\u003c/a>\u003c/p>","id":"2288078625","isHighlighted":false,"author":{"username":"vikingender","about":"","name":"Viking Ender","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.246967,"profileUrl":"https://disqus.com/by/vikingender/","url":"","reputation":1.246967,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2013-11-09T13:29:32","id":"81098224","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/vikingender.jpg","cache":"https://c.disquscdn.com/uploads/users/8109/8224/avatar32.jpg?1444569281"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/vikingender.jpg","cache":"https://c.disquscdn.com/uploads/users/8109/8224/avatar92.jpg?1444569281","large":{"permalink":"https://disqus.com/api/users/avatars/vikingender.jpg","cache":"https://c.disquscdn.com/uploads/users/8109/8224/avatar92.jpg?1444569281"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2015-10-03T17:15:38","parent":2287690054,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"I have an implementation here, the LSTM module mainly was copied from yours. So your code should work with mine as well. https://github.com/KHN190/torch-RNN/tree/master/bone","canVote":false,"thread":"4081981091","forum":"apaszke","depth":2,"points":0,"moderationLabels":["links"],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>I see. It might be convenient, but you code is too big to put it in here. And I'm not sure if it wouldn't be simpler to write another nngraph module wrapping individual layers, or your own function to construct and connect all the layers into a single network in advance.\u003c/p>","id":"2298555431","isHighlighted":false,"author":{"username":"adampaszke","about":"","name":"Adam Paszke","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.238224,"profileUrl":"https://disqus.com/by/adampaszke/","url":"","reputation":1.238224,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2015-08-30T21:53:02","id":"172362162","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2015-10-09T16:20:16","parent":2288078625,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"I see. It might be convenient, but you code is too big to put it in here. And I'm not sure if it wouldn't be simpler to write another nngraph module wrapping individual layers, or your own function to construct and connect all the layers into a single network in advance.","canVote":false,"thread":"4081981091","forum":"apaszke","depth":3,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>I don't see a way to escape from crafting the parameters updating. In my case, it's implemented in the partner functions of boneRecurrent. In your case, it must be somewhere during the training. For reusability it's better to create a Container. For one-go experiment, you need to modify training code a bit from side to side. But on one thing you are right, nn.gModule forces a lot of inconvenience in coding (e.x. I can't do resizeAs in a module, simply because the input is no more a tensor! It's nngraph.Node then). I think it's a fault of Torch.\u003c/p>","id":"2301312341","isHighlighted":false,"author":{"username":"vikingender","about":"","name":"Viking Ender","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.246967,"profileUrl":"https://disqus.com/by/vikingender/","url":"","reputation":1.246967,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2013-11-09T13:29:32","id":"81098224","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/vikingender.jpg","cache":"https://c.disquscdn.com/uploads/users/8109/8224/avatar32.jpg?1444569281"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/vikingender.jpg","cache":"https://c.disquscdn.com/uploads/users/8109/8224/avatar92.jpg?1444569281","large":{"permalink":"https://disqus.com/api/users/avatars/vikingender.jpg","cache":"https://c.disquscdn.com/uploads/users/8109/8224/avatar92.jpg?1444569281"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2015-10-11T13:14:40","parent":2298555431,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"I don't see a way to escape from crafting the parameters updating. In my case, it's implemented in the partner functions of boneRecurrent. In your case, it must be somewhere during the training. For reusability it's better to create a Container. For one-go experiment, you need to modify training code a bit from side to side. But on one thing you are right, nn.gModule forces a lot of inconvenience in coding (e.x. I can't do resizeAs in a module, simply because the input is no more a tensor! It's nngraph.Node then). I think it's a fault of Torch.","canVote":false,"thread":"4081981091","forum":"apaszke","depth":4,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Well thanks for the sharing, I just started to learn these RNN,LSTM,Lua and Torch things... And they are really hard to understand.. Your work is very helpful and I do really appreciate it .. Yes , thank you ...\u003c/p>","id":"2273097779","isHighlighted":false,"author":{"username":"ayanaaltaqin","about":"","name":"Ayana Altaqin","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.232124,"profileUrl":"https://disqus.com/by/ayanaaltaqin/","url":"","reputation":1.232124,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2015-09-25T04:23:36","id":"176106852","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/ayanaaltaqin.jpg","cache":"https://c.disquscdn.com/uploads/users/17610/6852/avatar32.jpg?1443155027"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/ayanaaltaqin.jpg","cache":"https://c.disquscdn.com/uploads/users/17610/6852/avatar92.jpg?1443155027","large":{"permalink":"https://disqus.com/api/users/avatars/ayanaaltaqin.jpg","cache":"https://c.disquscdn.com/uploads/users/17610/6852/avatar92.jpg?1443155027"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2015-09-25T04:23:45","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Well thanks for the sharing, I just started to learn these RNN,LSTM,Lua and Torch things... And they are really hard to understand.. Your work is very helpful and I do really appreciate it .. Yes , thank you ...","canVote":false,"thread":"4081981091","forum":"apaszke","depth":0,"points":0,"moderationLabels":[],"isEdited":true},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>I think CMulTable() should be the product while the CAddTable() the sum in their descriptions.\u003c/p>\u003cp>Thanks :)\u003c/p>","id":"2244419488","isHighlighted":false,"author":{"username":"disqus_YQTggpvnhi","about":"","name":"Ozan \u00c7a\u011flayan","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.2324929999999998,"profileUrl":"https://disqus.com/by/disqus_YQTggpvnhi/","url":"","reputation":1.2324929999999998,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2015-09-09T14:53:56","id":"173802795","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_YQTggpvnhi.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/disqus_YQTggpvnhi.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_YQTggpvnhi.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2015-09-09T14:54:04","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"I think CMulTable() should be the product while the CAddTable() the sum in their descriptions.\n\nThanks :)","canVote":false,"thread":"4081981091","forum":"apaszke","depth":0,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>You've got me, thanks! ;)\u003c/p>","id":"2248245692","isHighlighted":false,"author":{"username":"adampaszke","about":"","name":"Adam Paszke","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.238224,"profileUrl":"https://disqus.com/by/adampaszke/","url":"","reputation":1.238224,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2015-08-30T21:53:02","id":"172362162","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2015-09-11T15:47:49","parent":2244419488,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"You've got me, thanks! ;)","canVote":false,"thread":"4081981091","forum":"apaszke","depth":1,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>The figures is very clear and this page makes the LSTM very easy to understand, I certainly got lot of things from this article, it makes sense. What's more, I'm also curious about the bp procedure of LSTM, maybe there will be some supplyment posts later ^ ^\u003c/p>","id":"2242323613","isHighlighted":false,"author":{"username":"disqus_3BWuyN6Mlh","about":"","name":"joe","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.232124,"profileUrl":"https://disqus.com/by/disqus_3BWuyN6Mlh/","url":"","reputation":1.232124,"location":"Chengdu","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2015-09-08T12:52:08","id":"173655427","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_3BWuyN6Mlh.jpg","cache":"https://c.disquscdn.com/uploads/users/17365/5427/avatar32.jpg?1441717075"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/disqus_3BWuyN6Mlh.jpg","cache":"https://c.disquscdn.com/uploads/users/17365/5427/avatar92.jpg?1441717075","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_3BWuyN6Mlh.jpg","cache":"https://c.disquscdn.com/uploads/users/17365/5427/avatar92.jpg?1441717075"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2015-09-08T12:54:39","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"The figures is very clear and this page makes the LSTM very easy to understand, I certainly got lot of things from this article, it makes sense. What's more, I'm also curious about the bp procedure of LSTM, maybe there will be some supplyment posts later ^ ^","canVote":false,"thread":"4081981091","forum":"apaszke","depth":0,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Hey! Sorry for the late reply!\u003c/p>\u003cp>It's great to hear that you liked it! Saying 'bp procedure' do you mean the exact derivations or just the training code? It's really easy to train these models with a few calls like :backward(). There are some examples in torch docs e.g.: \u003ca href=\"https://disq.us/url?url=https%3A%2F%2Fgithub.com%2Ftorch%2Fnn%2Fblob%2Fmaster%2Fdoc%2Ftraining.md%3AEIH9JOUWXiUZdlrn7UI-271vHgE&amp;cuid=3762125\" rel=\"nofollow noopener\">https://github.com/torch/nn...\u003c/a>\u003c/p>","id":"2248250367","isHighlighted":false,"author":{"username":"adampaszke","about":"","name":"Adam Paszke","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.238224,"profileUrl":"https://disqus.com/by/adampaszke/","url":"","reputation":1.238224,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2015-08-30T21:53:02","id":"172362162","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/adampaszke.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2015-09-11T15:50:30","parent":2242323613,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Hey! Sorry for the late reply!\n\nIt's great to hear that you liked it! Saying 'bp procedure' do you mean the exact derivations or just the training code? It's really easy to train these models with a few calls like :backward(). There are some examples in torch docs e.g.: https://github.com/torch/nn/blob/master/doc/training.md","canVote":false,"thread":"4081981091","forum":"apaszke","depth":1,"points":0,"moderationLabels":["links"],"isEdited":false}],"thread":{"feed":"https://apaszke.disqus.com/lstm_networks_explained/latest.rss","identifiers":["lstm-explained"],"dislikes":0,"likes":12,"message":"","id":"4081981091","createdAt":"2015-08-30T22:02:32","category":"3938641","author":"172362162","isSpam":false,"signedLink":"http://disq.us/?url=http%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&key=LyNkJcWlfiA28pO5yPXRzA","isDeleted":false,"hasStreaming":false,"raw_message":"","isClosed":false,"link":"http://apaszke.github.io/lstm-explained.html","slug":"lstm_networks_explained","forum":"apaszke","clean_title":"LSTM networks explained","posts":43,"moderators":[172362162],"title":"LSTM networks explained","highlightedPost":null}},"order":"popular"}</script>

    

    <div id="fixed-content"></div>


    
        
<script type="text/json" id="disqus-urls">{
    "root":"//disqus.com",
    "next":"https://c.disquscdn.com/next/current/embed"
}</script>

        
        <script>!function () {
            var d = document;
            var toH = d.head.appendChild.bind(d.head);

            var v = window.location.href.match(/[#&?]version=([0-9a-f]{32})/);
            var src = 'https://c.disquscdn.com/next/embed/lounge.load';
            if (v)
                src += '.' + v[1];
            src += '.js';

            var s = d.createElement('script');
            s.crossOrigin = 'anonymous';
            s.id = 'bootstrap-script';
            s.setAttribute('data-app', 'lounge');
            s.src = src;
            toH(s);

            var m = d.createElement('meta');
            m.setAttribute('http-equiv', 'Content-Security-Policy');
            m.setAttribute('content', "script-src https:;");
            toH(m);
        }();</script>
    


<script src="./common.bundle.08b03b11c747b79c4d4135b49e2f8725.js"></script><div id="layout" data-tracking-area="layout"><div id="onboard" data-tracking-area="onboard"><div></div></div><div id="highlighted-post" data-tracking-area="highlighted" class="highlighted-post" style="display: none;"></div><div id="global-alert"></div><header id="main-nav" data-tracking-area="main-nav"><nav class="nav nav-primary"><ul><li class="nav-tab nav-tab--primary tab-conversation active" data-role="post-count"><a class="publisher-nav-color"><span class="comment-count">43 comments</span><span class="comment-count-placeholder">Comments</span></a></li><li class="nav-tab nav-tab--primary tab-community"><a href="https://disqus.com/home/forums/apaszke/" class="publisher-nav-color" data-action="community-sidebar" data-forum="apaszke" id="community-tab"><span class="community-name"><strong>Adam's blog</strong></span><strong class="community-name-placeholder">Community</strong></a></li><li class="nav-tab nav-tab--primary dropdown user-menu" data-role="logout"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="dropdown-toggle" data-toggle="dropdown">
<span class="dropdown-toggle-wrapper">

<span>
Login
</span>

</span> <span class="caret"></span>
</a>
<ul class="dropdown-menu">


<li>
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="auth:disqus">Disqus</a>
</li>
<li>
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="auth:facebook">Facebook</a>
</li>
<li>
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="auth:twitter">Twitter</a>
</li>
<li>
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="auth:google">Google</a>
</li>



</ul>
</li><li class="nav-tab nav-tab--primary notification-menu unread" data-role="notification-menu"><a href="https://disqus.com/home/inbox/" class="notification-container" data-action="home" data-home-path="home/inbox/">
<span class="notification-icon icon-comment" aria-hidden=""></span>
<span class="notification-count" data-role="notification-count">1</span>
</a>
</li></ul></nav></header><section id="conversation" data-role="main" data-tracking-area="main"><div class="nav nav-secondary" data-tracking-area="secondary-nav"><ul><li id="recommend-button" class="nav-tab nav-tab--secondary recommend dropdown"><div class="thread-likes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="recommend" title="Recommend this discussion" class="dropdown-toggle ">
<span class="label label-default"><span class="recommend-icon icon-heart-empty"></span> Recommend</span>
<span class="label label-recommended"><span class="recommend-icon icon-heart"></span> Recommended</span>
<span class="label label-count">12</span>
</a>
<ul class="dropdown-menu dropdown-menu--coachmark">
<li>
<h2 class="coachmark__heading">Discussion Recommended!</h2>
<p class="coachmark__description">Recommending means this is a discussion worth sharing. It gets shared to your followers' Disqus feeds, and gives the creator kudos!</p>
<a href="https://disqus.com/home/?utm_source=disqus_embed&amp;utm_content=recommend_btn" class="btn btn-primary coachmark__button" target="_blank">
 Find More Discussions 
</a>
</li>
</ul>
</div></li><li id="thread-share-menu" class="nav-tab nav-tab--secondary dropdown share-menu hidden-sm"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="dropdown-toggle" data-toggle="dropdown" title="Share">
<span class="icon-export"></span>
<span class="label">Share</span>
</a>
<ul class="share-menu dropdown-menu">
<li>
<div class="share-menu__label">Share this discussion on</div>
<ul>
<li class="twitter">
<a data-action="share:twitter" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Twitter</a>
</li>
<li class="facebook">
<a data-action="share:facebook" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#">Facebook</a>
</li>
</ul>
</li>
</ul>
</li><li data-role="post-sort" class="nav-tab nav-tab--secondary dropdown sorting pull-right"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="dropdown-toggle" data-toggle="dropdown">Sort by Best<span class="caret"></span></a><ul class="dropdown-menu pull-right"><li class="selected"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="sort" data-sort="popular">Best<i aria-hidden="true" class="icon-checkmark"></i></a></li><li class=""><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="sort" data-sort="desc">Newest<i aria-hidden="true" class="icon-checkmark"></i></a></li><li class=""><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="sort" data-sort="asc">Oldest<i aria-hidden="true" class="icon-checkmark"></i></a></li></ul></li></ul></div><div id="posts"><div id="form" class="textarea-wrapper--top-level"><form class="reply"><div class="postbox">
<div role="alert"></div>
<div class="avatar">
<span class="user">
<img data-role="user-avatar" src="./noavatar92.7b2fde640943965cc88df0cdee365907.png" alt="Avatar">
</span>
</div>

<div class="textarea-wrapper" data-role="textarea" dir="auto"><div><span class="placeholder">Join the discussion…</span><div class="textarea" tabindex="0" role="textbox" aria-multiline="true" contenteditable="PLAINTEXT-ONLY" data-role="editable" aria-label="Join the discussion…" style="overflow: auto; word-wrap: break-word; max-height: 350px;"><p><br></p></div><div style="display: none;"><ul class="user-mention__list">
<li class="header user-mention__header">
<h5>in this conversation</h5>
</li>
</ul>
</div></div>
<div data-role="drag-drop-placeholder" class="media-drag-hover" style="display: none">
<div class="drag-text">
⬇ Drag and drop your images here to upload them.
</div>
</div>
<div class="media-preview empty" data-role="media-preview"><ul data-role="media-progress-list"></ul>
<ul data-role="media-rich-list"></ul>
<div class="media-expanded empty" data-role="media-preview-expanded">
<img src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" data-role="media-preview-expanded-image" alt="Media preview placeholder">
</div>
</div>
<div class="edit-alert" role="postbox-alert"></div>
<div class="post-actions">
<ul class="wysiwyg">
<li class="wysiwyg__item" data-role="media-uploader"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" tabindex="-1" data-action="attach" class="attach" title="Upload Images"><span>Attach</span></a>
<input type="file" data-role="media-upload" tabindex="-1" accept="image/*">
</li>
</ul>
</div>
</div>

<div data-role="login-form"><div><section class="auth-section logged-out">
<div class="connect">
<h6>Log in with</h6>
<ul data-role="login-menu" class="services login-buttons">

<li class="auth-disqus">
<button type="button" data-action="auth:disqus" title="Disqus" class="connect__button"><i class="icon-disqus"></i></button>
</li>
<li class="auth-facebook">
<button type="button" data-action="auth:facebook" title="Facebook" class="connect__button"><i class="icon-facebook-circle"></i></button>
</li>
<li class="auth-twitter">
<button type="button" data-action="auth:twitter" title="Twitter" class="connect__button"><i class="icon-twitter-circle"></i></button>
</li>
<li class="auth-google">
<button type="button" data-action="auth:google" title="Google" class="connect__button"><i class="icon-google-plus-circle"></i></button>
</li>
</ul>
</div>
<div class="guest">
<h6 class="guest-form-title">
<span class="register-text"> or sign up with Disqus </span>
<span class="guest-text"> or pick a name </span>
</h6>

<div class="help-tooltip__wrapper help-icon">
<div id="rules" class="tooltip show help-tooltip">
<h3 class="help-tooltip__heading">Disqus is a discussion network</h3>
<ul class="help-tooltip__list">
<li><span>Disqus never moderates or censors. The rules on this community are its own.</span></li>
<li><span>Your email is safe with us. It's only used for moderation and optional notifications.</span></li>
<li><span>Don't be a jerk or do anything illegal. Everything is easier that way.</span></li>
</ul>
<p class="clearfix"><a href="https://docs.disqus.com/kb/terms-and-policies/" class="btn btn-small help-tooltip__button" target="_blank">Read full terms and conditions</a></p>
</div>
</div>

<p class="input-wrapper">
<input dir="auto" type="text" placeholder="Name" name="display_name" id="view93_display_name" maxlength="30" class="input--text">
</p>

<div class="guest-details " data-role="guest-details">
<p class="input-wrapper">
<input dir="auto" type="email" placeholder="Email" name="email" id="view93_email" class="input--text">
</p>

<p class="input-wrapper">
<input dir="auto" type="password" class="register-text input--text" placeholder="Password" name="password" id="view93_password">
</p>

<div class="acceptance-wrapper register-text">
By signing up, you agree to the Disqus <a target="_blank" href="https://help.disqus.com/customer/portal/articles/1753105-basic-rules-for-disqus-powered-profiles-and-discussions">Basic Rules</a>, <a target="_blank" href="https://help.disqus.com/customer/portal/articles/466260-terms-of-service">Terms of Service</a>, and <a target="_blank" href="https://help.disqus.com/customer/portal/articles/466259-privacy-policy">Privacy Policy</a>.
</div>
<div class="acceptance-wrapper guest-text">
By posting, you agree to the Disqus <a target="_blank" href="https://help.disqus.com/customer/portal/articles/1753105-basic-rules-for-disqus-powered-profiles-and-discussions">Basic Rules</a>, <a target="_blank" href="https://help.disqus.com/customer/portal/articles/466260-terms-of-service">Terms of Service</a>, and <a target="_blank" href="https://help.disqus.com/customer/portal/articles/466259-privacy-policy">Privacy Policy</a>.
</div>

<input type="checkbox" name="author-guest" style="display:none">

<div class="proceed" data-role="submit-btn-container">
<button type="submit" class="proceed__button btn submit" aria-label="Next"><span class="icon-proceed"></span><div class="spinner"></div></button>
</div>
</div>
</div>
</section>

</div></div>
</div>
</form></div><button class="alert alert--realtime" data-role="realtime-notification" style="display: none;"></button><div id="no-posts" style="display: none;"></div><ul id="post-list" class="post-list"><li class="post" id="post-2403096907"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/aravindsrinivasl/" class="user" data-action="profile" data-username="aravindsrinivasl">
<img data-role="user-avatar" data-user="186827635" src="./avatar92.jpg" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/aravindsrinivasl/" data-action="profile" data-username="aravindsrinivasl" data-role="username">Aravind Srinivas L</a></span>

</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="https://apaszke.github.io/lstm-explained.html#comment-2403096907" data-role="relative-time" class="time-ago" title="Thursday, December 10, 2015 6:16 AM">a year ago</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Hi,  can you please update this with the training code too? <br>Also, would be great if you could have another article explaining how to build LSTM networks using the 'rnn' package (with nn.Sequencer and stuff), and how it compares to using nngraph.</p><p>Thanks for the really good explanation about building the LSTM!</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-3" data-action="upvote" title="">

<span class="updatable count" data-role="likes">3</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/13qqpfv" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2403096907">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"><li class="post" id="post-2542268015"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/adampaszke/" class="user" data-action="profile" data-username="adampaszke">
<img data-role="user-avatar" data-user="172362162" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/adampaszke/" data-action="profile" data-username="adampaszke" data-role="username">Adam Paszke</a></span>
<span class="badge moderator">Mod</span>

<span><a href="https://apaszke.github.io/lstm-explained.html#comment-2403096907" class="parent-link" data-role="parent-link"><i aria-hidden="true" class="icon-forward" title="in reply to"></i> Aravind Srinivas L</a></span>
</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="https://apaszke.github.io/lstm-explained.html#comment-2542268015" data-role="relative-time" class="time-ago" title="Sunday, February 28, 2016 3:25 PM">a year ago</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Hi Aravind. Sorry for a late reply. I haven't used rnn package yet, because nngraph fitted nicely into my models so far. I'm planning to do some extensions to this post, which include adding a section on training LSTM networks.</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/161lmjz" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2542268015">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"></ul>
</li><li class="post" id="post-2534353533"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/disqus_TsTw5z52iB/" class="user" data-action="profile" data-username="disqus_TsTw5z52iB">
<img data-role="user-avatar" data-user="194044248" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_TsTw5z52iB/" data-action="profile" data-username="disqus_TsTw5z52iB" data-role="username">Bruce Zhang</a></span>

<span><a href="https://apaszke.github.io/lstm-explained.html#comment-2403096907" class="parent-link" data-role="parent-link"><i aria-hidden="true" class="icon-forward" title="in reply to"></i> Aravind Srinivas L</a></span>
</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="https://apaszke.github.io/lstm-explained.html#comment-2534353533" data-role="relative-time" class="time-ago" title="Thursday, February 25, 2016 2:18 AM">a year ago</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>I think there is no such thing as rnn package, you have to build RNN with nngraph.</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/15wvzp9" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2534353533">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"><li class="post" id="post-2542264658"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/adampaszke/" class="user" data-action="profile" data-username="adampaszke">
<img data-role="user-avatar" data-user="172362162" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/adampaszke/" data-action="profile" data-username="adampaszke" data-role="username">Adam Paszke</a></span>
<span class="badge moderator">Mod</span>

<span><a href="https://apaszke.github.io/lstm-explained.html#comment-2534353533" class="parent-link" data-role="parent-link"><i aria-hidden="true" class="icon-forward" title="in reply to"></i> Bruce Zhang</a></span>
</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="https://apaszke.github.io/lstm-explained.html#comment-2542264658" data-role="relative-time" class="time-ago" title="Sunday, February 28, 2016 3:24 PM">a year ago</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>In fact there is an rnn package by Nicholas Léonard, but it's not included in torch core. See <a href="https://disq.us/url?url=https%3A%2F%2Fgithub.com%2FElement-Research%2Frnn%3A2cchRibNtQPiAEfpdDv4dAfhfk8&amp;cuid=3762125" rel="nofollow noopener">this repository</a>.</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/161ljyq" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2542264658">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"></ul>
</li></ul>
</li></ul>
</li><li class="post" id="post-2492364557"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/disqus_aISFArTPT6/" class="user" data-action="profile" data-username="disqus_aISFArTPT6">
<img data-role="user-avatar" data-user="194596855" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_aISFArTPT6/" data-action="profile" data-username="disqus_aISFArTPT6" data-role="username">soshiant</a></span>

</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="https://apaszke.github.io/lstm-explained.html#comment-2492364557" data-role="relative-time" class="time-ago" title="Tuesday, February 2, 2016 10:20 AM">a year ago</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>hi great stuff.<br>i'm gonno ask this just to be sure :<br>you have 3 inputs for forward pass<br>so f i want to us it in multiple steps i have to give this layer the resuls of the last step for two of those inputs right?<br>this is making it too hard could you just take the input and somehow insert the ht-1  ?</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-1" data-action="upvote" title="">

<span class="updatable count" data-role="likes">1</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/157w0st" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2492364557">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"><li class="post" id="post-2542272838"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/adampaszke/" class="user" data-action="profile" data-username="adampaszke">
<img data-role="user-avatar" data-user="172362162" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/adampaszke/" data-action="profile" data-username="adampaszke" data-role="username">Adam Paszke</a></span>
<span class="badge moderator">Mod</span>

<span><a href="https://apaszke.github.io/lstm-explained.html#comment-2492364557" class="parent-link" data-role="parent-link"><i aria-hidden="true" class="icon-forward" title="in reply to"></i> soshiant</a></span>
</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="https://apaszke.github.io/lstm-explained.html#comment-2542272838" data-role="relative-time" class="time-ago" title="Sunday, February 28, 2016 3:28 PM">a year ago</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Yes, two of the outputs are inputs in the next time step. Unfortunately, I don't think it can be done in a simpler way.</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/161lq9y" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2542272838">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"></ul>
</li></ul>
</li><li class="post" id="post-3190751591"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/igorchernobaev/" class="user" data-action="profile" data-username="igorchernobaev">
<img data-role="user-avatar" data-user="178294769" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/igorchernobaev/" data-action="profile" data-username="igorchernobaev" data-role="username">Igor Chernobaev</a></span>

</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="https://apaszke.github.io/lstm-explained.html#comment-3190751591" data-role="relative-time" class="time-ago" title="Tuesday, March 7, 2017 6:15 AM">2 months ago</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Hi, i'm trying to implement own LSTM for better understanding. Unfortunately my backprop algorithm doesn't pass gradient check. Could you kindly help me?</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1grovon" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:3190751591">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"></ul>
</li><li class="post" id="post-2978686662"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/faiyazlalani/" class="user" data-action="profile" data-username="faiyazlalani">
<img data-role="user-avatar" data-user="228451061" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/faiyazlalani/" data-action="profile" data-username="faiyazlalani" data-role="username">Faiyaz Lalani</a></span>

</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="https://apaszke.github.io/lstm-explained.html#comment-2978686662" data-role="relative-time" class="time-ago" title="Monday, October 31, 2016 7:31 PM">6 months ago</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Excellent post - very helpful.  Much appreciated Adam!</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1d9flc6" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2978686662">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"></ul>
</li><li class="post" id="post-2948125410"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/disqus_d0sJQt6fLf/" class="user" data-action="profile" data-username="disqus_d0sJQt6fLf">
<img data-role="user-avatar" data-user="226348288" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_d0sJQt6fLf/" data-action="profile" data-username="disqus_d0sJQt6fLf" data-role="username">fnm</a></span>

</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="https://apaszke.github.io/lstm-explained.html#comment-2948125410" data-role="relative-time" class="time-ago" title="Thursday, October 13, 2016 1:45 AM">6 months ago</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>I am interested in knowing that how lstm model is trained.</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1cr8k4i" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2948125410">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"></ul>
</li><li class="post" id="post-2794888435"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/yitzhakspielberg/" class="user" data-action="profile" data-username="yitzhakspielberg">
<img data-role="user-avatar" data-user="215820942" src="./avatar92(1).jpg" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/yitzhakspielberg/" data-action="profile" data-username="yitzhakspielberg" data-role="username">Yitzhak Spielberg</a></span>

</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="https://apaszke.github.io/lstm-explained.html#comment-2794888435" data-role="relative-time" class="time-ago" title="Thursday, July 21, 2016 12:33 AM">9 months ago</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>It would be cool to have the training procedure as well</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1a805pv" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2794888435">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"></ul>
</li><li class="post" id="post-2794847588"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/yitzhakspielberg/" class="user" data-action="profile" data-username="yitzhakspielberg">
<img data-role="user-avatar" data-user="215820942" src="./avatar92(1).jpg" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/yitzhakspielberg/" data-action="profile" data-username="yitzhakspielberg" data-role="username">Yitzhak Spielberg</a></span>

</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="https://apaszke.github.io/lstm-explained.html#comment-2794847588" data-role="relative-time" class="time-ago" title="Thursday, July 21, 2016 12:24 AM">9 months ago</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Hi, how do I build a model with multiple lstm layers? for ordinary neural nets I used nn.sequential to build the model and model:forward(x) to calculate the output. How does it work in this case? A simple example, let's say with 2 lstm layers would be really helpful.</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1a7za78" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2794847588">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"><li class="post" id="post-2794890520"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/yitzhakspielberg/" class="user" data-action="profile" data-username="yitzhakspielberg">
<img data-role="user-avatar" data-user="215820942" src="./avatar92(1).jpg" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/yitzhakspielberg/" data-action="profile" data-username="yitzhakspielberg" data-role="username">Yitzhak Spielberg</a></span>

<span><a href="https://apaszke.github.io/lstm-explained.html#comment-2794847588" class="parent-link" data-role="parent-link"><i aria-hidden="true" class="icon-forward" title="in reply to"></i> Yitzhak Spielberg</a></span>
</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="https://apaszke.github.io/lstm-explained.html#comment-2794890520" data-role="relative-time" class="time-ago" title="Thursday, July 21, 2016 12:33 AM">9 months ago</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>solved. just found the multilayer example above.</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1a807bs" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2794890520">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"></ul>
</li></ul>
</li><li class="post" id="post-2783959255"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/mohammed_jabreel/" class="user" data-action="profile" data-username="mohammed_jabreel">
<img data-role="user-avatar" data-user="215127778" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/mohammed_jabreel/" data-action="profile" data-username="mohammed_jabreel" data-role="username">Mohammed Jabreel</a></span>

</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="https://apaszke.github.io/lstm-explained.html#comment-2783959255" data-role="relative-time" class="time-ago" title="Thursday, July 14, 2016 5:35 PM">9 months ago</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Hi, Thank you for this nice post about LSTM, I would like to explain me how we could implement the LSTM attention.</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1a1hwpj" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2783959255">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"></ul>
</li><li class="post" id="post-2752671300"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/disqus_69LPgvlRKI/" class="user" data-action="profile" data-username="disqus_69LPgvlRKI">
<img data-role="user-avatar" data-user="213022569" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_69LPgvlRKI/" data-action="profile" data-username="disqus_69LPgvlRKI" data-role="username">simon</a></span>

</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="https://apaszke.github.io/lstm-explained.html#comment-2752671300" data-role="relative-time" class="time-ago" title="Monday, June 27, 2016 1:48 AM">10 months ago</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Nice LSTM post, but I have a question,how the gate units can protect the gradient inside the cell from harmful changes during the training, if there existes some explanation in math?</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/19ivaro" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2752671300">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"></ul>
</li><li class="post" id="post-2725100813"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/lucanaterop/" class="user" data-action="profile" data-username="lucanaterop">
<img data-role="user-avatar" data-user="64200016" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/lucanaterop/" data-action="profile" data-username="lucanaterop" data-role="username">Luca Naterop</a></span>

</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="https://apaszke.github.io/lstm-explained.html#comment-2725100813" data-role="relative-time" class="time-ago" title="Saturday, June 11, 2016 8:50 AM">10 months ago</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Noob question: How can I compute the RNN output with this? layer:forward() only gives the updated hidden and cell state...but how do I get the networks predictions?</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/192gd8t" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2725100813">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"></ul>
</li><li class="post" id="post-2646947651"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/disqus_FE6W9KzWs8/" class="user" data-action="profile" data-username="disqus_FE6W9KzWs8">
<img data-role="user-avatar" data-user="102620122" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_FE6W9KzWs8/" data-action="profile" data-username="disqus_FE6W9KzWs8" data-role="username">Gaurav Pandey</a></span>

</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="https://apaszke.github.io/lstm-explained.html#comment-2646947651" data-role="relative-time" class="time-ago" title="Thursday, April 28, 2016 1:10 AM">a year ago</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Hi, nice article. The LSTM obtained above won't have tied weights. Hence, I had 2 questions.</p><p>1) Is it more common to have tied weights between different LSTM units.<br>2) Can this simply be achieved by getting the parameters pointer of the first unit, and setting the parameters of all successive units to point to that pointer (Similar for gradient)</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/17rx9vn" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2646947651">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"></ul>
</li><li class="post" id="post-2542259263"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/disqus_JKmCckR2Jw/" class="user" data-action="profile" data-username="disqus_JKmCckR2Jw">
<img data-role="user-avatar" data-user="198542359" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_JKmCckR2Jw/" data-action="profile" data-username="disqus_JKmCckR2Jw" data-role="username">Mahati</a></span>

</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="https://apaszke.github.io/lstm-explained.html#comment-2542259263" data-role="relative-time" class="time-ago" title="Sunday, February 28, 2016 3:20 PM">a year ago</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Hi. Thanks for this! It would be great if you could also update the training code. This has been very helpful for me in learning about LSTM.</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/161lfsv" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2542259263">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"><li class="post" id="post-2542262312"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/adampaszke/" class="user" data-action="profile" data-username="adampaszke">
<img data-role="user-avatar" data-user="172362162" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/adampaszke/" data-action="profile" data-username="adampaszke" data-role="username">Adam Paszke</a></span>
<span class="badge moderator">Mod</span>

<span><a href="https://apaszke.github.io/lstm-explained.html#comment-2542259263" class="parent-link" data-role="parent-link"><i aria-hidden="true" class="icon-forward" title="in reply to"></i> Mahati</a></span>
</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="https://apaszke.github.io/lstm-explained.html#comment-2542262312" data-role="relative-time" class="time-ago" title="Sunday, February 28, 2016 3:22 PM">a year ago</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Hi Mahati. Great to hear that it was helpful for you. I am planning to expand this post in the near future and there will be some training examples provided.</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/161li5k" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2542262312">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"></ul>
</li></ul>
</li><li class="post" id="post-2444132313"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/disqus_Pcs7K2lnNd/" class="user" data-action="profile" data-username="disqus_Pcs7K2lnNd">
<img data-role="user-avatar" data-user="190738230" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_Pcs7K2lnNd/" data-action="profile" data-username="disqus_Pcs7K2lnNd" data-role="username">Marco Damonte</a></span>

</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="https://apaszke.github.io/lstm-explained.html#comment-2444132313" data-role="relative-time" class="time-ago" title="Thursday, January 7, 2016 1:12 AM">a year ago</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Once you have your "layer" variable, can you use it as a traditional nn.Module and start the training?</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/14f68k9" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2444132313">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"><li class="post" id="post-2542261364"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/adampaszke/" class="user" data-action="profile" data-username="adampaszke">
<img data-role="user-avatar" data-user="172362162" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/adampaszke/" data-action="profile" data-username="adampaszke" data-role="username">Adam Paszke</a></span>
<span class="badge moderator">Mod</span>

<span><a href="https://apaszke.github.io/lstm-explained.html#comment-2444132313" class="parent-link" data-role="parent-link"><i aria-hidden="true" class="icon-forward" title="in reply to"></i> Marco Damonte</a></span>
</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="https://apaszke.github.io/lstm-explained.html#comment-2542261364" data-role="relative-time" class="time-ago" title="Sunday, February 28, 2016 3:21 PM">a year ago</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Yes! gModule has the same API as all nn modules.</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/161lhf8" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2542261364">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"></ul>
</li></ul>
</li><li class="post" id="post-2337287437"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/aiqunhuang/" class="user" data-action="profile" data-username="aiqunhuang">
<img data-role="user-avatar" data-user="114896406" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/aiqunhuang/" data-action="profile" data-username="aiqunhuang" data-role="username">Aiqun Huang</a></span>

</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="https://apaszke.github.io/lstm-explained.html#comment-2337287437" data-role="relative-time" class="time-ago" title="Saturday, October 31, 2015 9:22 PM">a year ago</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p><a data-dsq-mention="adampaszke:disqus" href="https://disqus.com/by/adampaszke/" rel="nofollow noopener" data-action="profile" data-username="adampaszke" class="mention">Adam Paszke</a>, what is the dimension of preactivations? I think it is just a 1D vector of size 4 * rnn_size,  but why the first argument of nn.Narrow(2, 1, 3 * rnn_size) is 2?</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/12nk6j1" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2337287437">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"><li class="post" id="post-2337760514"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/aiqunhuang/" class="user" data-action="profile" data-username="aiqunhuang">
<img data-role="user-avatar" data-user="114896406" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/aiqunhuang/" data-action="profile" data-username="aiqunhuang" data-role="username">Aiqun Huang</a></span>

<span><a href="https://apaszke.github.io/lstm-explained.html#comment-2337287437" class="parent-link" data-role="parent-link"><i aria-hidden="true" class="icon-forward" title="in reply to"></i> Aiqun Huang</a></span>
</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="https://apaszke.github.io/lstm-explained.html#comment-2337760514" data-role="relative-time" class="time-ago" title="Sunday, November 1, 2015 8:28 AM">a year ago</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p><a data-dsq-mention="adampaszke:disqus" href="https://disqus.com/by/adampaszke/" rel="nofollow noopener" data-action="profile" data-username="adampaszke" class="mention">Adam Paszke</a>, I think I got it. The 1st argument of nn.Narrow should be 2, which means along the column dimension choosing 3*rnn_size columns, and in the case of preactivations, each column has only 1 element.<br></p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/12nubk2" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2337760514">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"><li class="post" id="post-2337782274"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/adampaszke/" class="user" data-action="profile" data-username="adampaszke">
<img data-role="user-avatar" data-user="172362162" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/adampaszke/" data-action="profile" data-username="adampaszke" data-role="username">Adam Paszke</a></span>
<span class="badge moderator">Mod</span>

<span><a href="https://apaszke.github.io/lstm-explained.html#comment-2337760514" class="parent-link" data-role="parent-link"><i aria-hidden="true" class="icon-forward" title="in reply to"></i> Aiqun Huang</a></span>
</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="https://apaszke.github.io/lstm-explained.html#comment-2337782274" data-role="relative-time" class="time-ago" title="Sunday, November 1, 2015 8:46 AM">a year ago</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Yeah. This module runs in batch mode only, so even if you're only doing one step at a time, you should input a 1xN matrix. The activations for respective cells are in the columns :)</p><p>In this way you can train or predict with LSTMs on several inputs in parallel (if you add more rows).</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-1" data-action="upvote" title="">

<span class="updatable count" data-role="likes">1</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/12nusci" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2337782274">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"></ul>
</li></ul>
</li></ul>
</li><li class="post" id="post-2333428554"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/disqus_cBTeXGHYne/" class="user" data-action="profile" data-username="disqus_cBTeXGHYne">
<img data-role="user-avatar" data-user="180691959" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_cBTeXGHYne/" data-action="profile" data-username="disqus_cBTeXGHYne" data-role="username">Maxim  Ivanov</a></span>

</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="https://apaszke.github.io/lstm-explained.html#comment-2333428554" data-role="relative-time" class="time-ago" title="Thursday, October 29, 2015 10:49 AM">a year ago</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Thanks <a data-dsq-mention="adampaszke:disqus" href="https://disqus.com/by/adampaszke/" rel="nofollow noopener" data-action="profile" data-username="adampaszke" class="mention">Adam Paszke</a> for such detailed step-by-step LSTM explanation. I have a question. In original paper and other sources there is nothing like rnn_size (basically, rnn_size equals to 1 there). Having rnn_size &gt; 1 just sounds like having rnn_size number of all the gates (so, instead of 4 gates it will be 4*rnn_size). The question is how did you come up with that param? Did you have a chance to see the affect of different rnn_size in prediction quality? any link is helpful, thanks!</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/12l9gzu" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2333428554">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"><li class="post" id="post-2333501354"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/disqus_cBTeXGHYne/" class="user" data-action="profile" data-username="disqus_cBTeXGHYne">
<img data-role="user-avatar" data-user="180691959" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_cBTeXGHYne/" data-action="profile" data-username="disqus_cBTeXGHYne" data-role="username">Maxim  Ivanov</a></span>

<span><a href="https://apaszke.github.io/lstm-explained.html#comment-2333428554" class="parent-link" data-role="parent-link"><i aria-hidden="true" class="icon-forward" title="in reply to"></i> Maxim  Ivanov</a></span>
</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="https://apaszke.github.io/lstm-explained.html#comment-2333501354" data-role="relative-time" class="time-ago" title="Thursday, October 29, 2015 11:31 AM">a year ago</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>oh, I see. LSTM.create(3,2) can be considered as layer with 2 LSTM units. Each of them is original LSTM unit with 4 gates. Makes sense?</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/12lb162" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2333501354">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"><li class="post" id="post-2333848755"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/adampaszke/" class="user" data-action="profile" data-username="adampaszke">
<img data-role="user-avatar" data-user="172362162" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/adampaszke/" data-action="profile" data-username="adampaszke" data-role="username">Adam Paszke</a></span>
<span class="badge moderator">Mod</span>

<span><a href="https://apaszke.github.io/lstm-explained.html#comment-2333501354" class="parent-link" data-role="parent-link"><i aria-hidden="true" class="icon-forward" title="in reply to"></i> Maxim  Ivanov</a></span>
</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="https://apaszke.github.io/lstm-explained.html#comment-2333848755" data-role="relative-time" class="time-ago" title="Thursday, October 29, 2015 3:08 PM">a year ago</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Exactly! This would be the layer that accepts an input vector of length 3 and uses 2 LSTM units to generate output of length 2. Second parameter (let's call it x) determines how many units will be used (so there will be 4*x gates).</p><p>Regarding Your question about the prediction quality, I'd say it depends on a problem. Bigger sizes allow the layer to be more expressive and exhibit more complex behaviour, but can also lead to overfitting (just like with the regular Linear layers). In the 'Visualizing and Understanding Recurrent Networks' paper You can find a table that lists some benchmark results for LSTM networks with varying number of layers and sizes (on top of page 4).</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/12lih83" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2333848755">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"></ul>
</li></ul>
</li></ul>
</li><li class="post" id="post-2319806084"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/peteruherek/" class="user" data-action="profile" data-username="peteruherek">
<img data-role="user-avatar" data-user="89533556" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/peteruherek/" data-action="profile" data-username="peteruherek" data-role="username">Peter Uherek</a></span>

</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="https://apaszke.github.io/lstm-explained.html#comment-2319806084" data-role="relative-time" class="time-ago" title="Wednesday, October 21, 2015 2:08 PM">2 years ago</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Really good article. I am glad that someone explain the LSTM. It is hard to understand without good examples. I want to ask you, if you have plan to expand this article about training the LSTM?</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/12d5htw" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2319806084">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"><li class="post" id="post-2319812144"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/adampaszke/" class="user" data-action="profile" data-username="adampaszke">
<img data-role="user-avatar" data-user="172362162" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/adampaszke/" data-action="profile" data-username="adampaszke" data-role="username">Adam Paszke</a></span>
<span class="badge moderator">Mod</span>

<span><a href="https://apaszke.github.io/lstm-explained.html#comment-2319806084" class="parent-link" data-role="parent-link"><i aria-hidden="true" class="icon-forward" title="in reply to"></i> Peter Uherek</a></span>
</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="https://apaszke.github.io/lstm-explained.html#comment-2319812144" data-role="relative-time" class="time-ago" title="Wednesday, October 21, 2015 2:12 PM">2 years ago</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>I'll try to, if only I'll have some time :)</p><p>It's very similar to training regular NN modules. Do you know the API? You can read more in <a href="https://disq.us/url?url=https%3A%2F%2Fgithub.com%2Ftorch%2Fnn%2Fblob%2Fmaster%2Fdoc%2Fmodule.md%3A5TyRqHzYRhxbwBGgKDPRaL3d9Wg&amp;cuid=3762125" rel="nofollow noopener">here</a> and <a href="https://disq.us/url?url=https%3A%2F%2Fgithub.com%2Ftorch%2Fnn%2Fblob%2Fmaster%2Fdoc%2Ftraining.md%23example-of-manual-training-of-a-neural-network%3AaX038om_lNKiLrjsjwVnRC2pqjk&amp;cuid=3762125" rel="nofollow noopener">here (just the exmaple of manual training)</a>. I hope this helps at least a bit!</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-1" data-action="upvote" title="">

<span class="updatable count" data-role="likes">1</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/12d5mi8" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2319812144">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"></ul>
</li></ul>
</li><li class="post" id="post-2304665761"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/bibekanandakundu/" class="user" data-action="profile" data-username="bibekanandakundu">
<img data-role="user-avatar" data-user="177745908" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/bibekanandakundu/" data-action="profile" data-username="bibekanandakundu" data-role="username">Bibekananda Kundu</a></span>

</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="https://apaszke.github.io/lstm-explained.html#comment-2304665761" data-role="relative-time" class="time-ago" title="Tuesday, October 13, 2015 2:17 AM">2 years ago</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>How to use</p><p>layer:backward()</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1244zhd" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2304665761">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"></ul>
</li><li class="post" id="post-2304642397"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/bibekanandakundu/" class="user" data-action="profile" data-username="bibekanandakundu">
<img data-role="user-avatar" data-user="177745908" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/bibekanandakundu/" data-action="profile" data-username="bibekanandakundu" data-role="username">Bibekananda Kundu</a></span>

</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="https://apaszke.github.io/lstm-explained.html#comment-2304642397" data-role="relative-time" class="time-ago" title="Tuesday, October 13, 2015 2:01 AM">2 years ago</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Can you please provide the code for training the LSTM ?</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1244hgd" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2304642397">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"></ul>
</li><li class="post" id="post-2281740898"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/minkymorgan/" class="user" data-action="profile" data-username="minkymorgan">
<img data-role="user-avatar" data-user="176752555" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/minkymorgan/" data-action="profile" data-username="minkymorgan" data-role="username">Andrew Morgan</a></span>

</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="https://apaszke.github.io/lstm-explained.html#comment-2281740898" data-role="relative-time" class="time-ago" title="Wednesday, September 30, 2015 4:53 AM">2 years ago</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>I really liked your article, and it's encouraged me to have a go building LSTMs too. I forked your examples and have been testing it, to try and do learning with it on some data I have. But, I think I'm misunderstand how training fits into your example.</p><p>My code is on github along with test data. <a href="https://disq.us/url?url=https%3A%2F%2Fgithub.com%2Fbytesumo%2FLSTM-Experiments%2Fblob%2Fmaster%2Ftc_lstm.lua%3A2O47SxeiOJeIJtY9pK4kzH59FA8&amp;cuid=3762125" rel="nofollow noopener">https://github.com/bytesumo...</a></p><p>Maybe you could glance at it, offer a pointer to fixing the training process? <br>Many thanks, Andrew.</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/11qhmjm" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2281740898">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"><li class="post" id="post-2287686610"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/adampaszke/" class="user" data-action="profile" data-username="adampaszke">
<img data-role="user-avatar" data-user="172362162" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/adampaszke/" data-action="profile" data-username="adampaszke" data-role="username">Adam Paszke</a></span>
<span class="badge moderator">Mod</span>

<span><a href="https://apaszke.github.io/lstm-explained.html#comment-2281740898" class="parent-link" data-role="parent-link"><i aria-hidden="true" class="icon-forward" title="in reply to"></i> Andrew Morgan</a></span>
</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="https://apaszke.github.io/lstm-explained.html#comment-2287686610" data-role="relative-time" class="time-ago" title="Saturday, October 3, 2015 4:27 AM">2 years ago</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>The link you posted gives me a 404 :/<br>Did you solve the issue? I can't see LSTM implementation in your code.</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/11u12aa" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2287686610">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"><li class="post" id="post-2291128732"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/minkymorgan/" class="user" data-action="profile" data-username="minkymorgan">
<img data-role="user-avatar" data-user="176752555" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/minkymorgan/" data-action="profile" data-username="minkymorgan" data-role="username">Andrew Morgan</a></span>

<span><a href="https://apaszke.github.io/lstm-explained.html#comment-2287686610" class="parent-link" data-role="parent-link"><i aria-hidden="true" class="icon-forward" title="in reply to"></i> Adam Paszke</a></span>
</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="https://apaszke.github.io/lstm-explained.html#comment-2291128732" data-role="relative-time" class="time-ago" title="Monday, October 5, 2015 7:16 AM">2 years ago</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>yeah ... so my initial enthusiasm ebbed as I realised my attempt was rubbish! So ditched it and settled on trying some experiments with a working library rnn. My experimental code is here. <a href="https://disq.us/url?url=https%3A%2F%2Fgithub.com%2Fbytesumo%2FLSTM-Experiments%3AummHjBixQ494XwiRvfM494oKklk&amp;cuid=3762125" rel="nofollow noopener">https://github.com/bytesumo...</a><br>Still not sure it learns anything, but most bugs ironed out now.</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/11w2u8s" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2291128732">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"></ul>
</li></ul>
</li></ul>
</li><li class="post" id="post-2281366551"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/vikingender/" class="user" data-action="profile" data-username="vikingender">
<img data-role="user-avatar" data-user="81098224" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/vikingender/" data-action="profile" data-username="vikingender" data-role="username">Viking Ender</a></span>

</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="https://apaszke.github.io/lstm-explained.html#comment-2281366551" data-role="relative-time" class="time-ago" title="Tuesday, September 29, 2015 11:37 PM">2 years ago</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Hi, this model may better have a updateOutput() &amp; backward() since it behaves different from Containers such as Sequential &amp; Concat. While it's exactly what you need to define in training, but putting things together (combine all layers in a complete Module) permits you convenience to optimize parameters as a whole. Cheers.</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/11q9lp3" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2281366551">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"><li class="post" id="post-2287690054"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/adampaszke/" class="user" data-action="profile" data-username="adampaszke">
<img data-role="user-avatar" data-user="172362162" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/adampaszke/" data-action="profile" data-username="adampaszke" data-role="username">Adam Paszke</a></span>
<span class="badge moderator">Mod</span>

<span><a href="https://apaszke.github.io/lstm-explained.html#comment-2281366551" class="parent-link" data-role="parent-link"><i aria-hidden="true" class="icon-forward" title="in reply to"></i> Viking Ender</a></span>
</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="https://apaszke.github.io/lstm-explained.html#comment-2287690054" data-role="relative-time" class="time-ago" title="Saturday, October 3, 2015 4:32 AM">2 years ago</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Uh, you could combine the layers in some kind of container, but I haven't tried it yet. Anyway, it's a thing worth adding here! Thanks!</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/11u14xy" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2287690054">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"><li class="post" id="post-2288078625"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/vikingender/" class="user" data-action="profile" data-username="vikingender">
<img data-role="user-avatar" data-user="81098224" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/vikingender/" data-action="profile" data-username="vikingender" data-role="username">Viking Ender</a></span>

<span><a href="https://apaszke.github.io/lstm-explained.html#comment-2287690054" class="parent-link" data-role="parent-link"><i aria-hidden="true" class="icon-forward" title="in reply to"></i> Adam Paszke</a></span>
</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="https://apaszke.github.io/lstm-explained.html#comment-2288078625" data-role="relative-time" class="time-ago" title="Saturday, October 3, 2015 10:15 AM">2 years ago</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>I have an implementation here, the LSTM module mainly was copied from yours. So your code should work with mine as well. <a href="https://disq.us/url?url=https%3A%2F%2Fgithub.com%2FKHN190%2Ftorch-RNN%2Ftree%2Fmaster%2Fbone%3ArzO2MdzZlqcZoDytBcjMphRUq6w&amp;cuid=3762125" rel="nofollow noopener">https://github.com/KHN190/t...</a></p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/11u9grl" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2288078625">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"><li class="post" id="post-2298555431"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/adampaszke/" class="user" data-action="profile" data-username="adampaszke">
<img data-role="user-avatar" data-user="172362162" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/adampaszke/" data-action="profile" data-username="adampaszke" data-role="username">Adam Paszke</a></span>
<span class="badge moderator">Mod</span>

<span><a href="https://apaszke.github.io/lstm-explained.html#comment-2288078625" class="parent-link" data-role="parent-link"><i aria-hidden="true" class="icon-forward" title="in reply to"></i> Viking Ender</a></span>
</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="https://apaszke.github.io/lstm-explained.html#comment-2298555431" data-role="relative-time" class="time-ago" title="Friday, October 9, 2015 9:20 AM">2 years ago</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>I see. It might be convenient, but you code is too big to put it in here. And I'm not sure if it wouldn't be simpler to write another nngraph module wrapping individual layers, or your own function to construct and connect all the layers into a single network in advance.</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/120i0pz" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2298555431">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"><li class="post" id="post-2301312341"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/vikingender/" class="user" data-action="profile" data-username="vikingender">
<img data-role="user-avatar" data-user="81098224" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/vikingender/" data-action="profile" data-username="vikingender" data-role="username">Viking Ender</a></span>

<span><a href="https://apaszke.github.io/lstm-explained.html#comment-2298555431" class="parent-link" data-role="parent-link"><i aria-hidden="true" class="icon-forward" title="in reply to"></i> Adam Paszke</a></span>
</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="https://apaszke.github.io/lstm-explained.html#comment-2301312341" data-role="relative-time" class="time-ago" title="Sunday, October 11, 2015 6:14 AM">2 years ago</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>I don't see a way to escape from crafting the parameters updating. In my case, it's implemented in the partner functions of boneRecurrent. In your case, it must be somewhere during the training. For reusability it's better to create a Container. For one-go experiment, you need to modify training code a bit from side to side. But on one thing you are right, nn.gModule forces a lot of inconvenience in coding (e.x. I can't do resizeAs in a module, simply because the input is no more a tensor! It's nngraph.Node then). I think it's a fault of Torch.</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/12253yt" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2301312341">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"></ul>
</li></ul>
</li></ul>
</li></ul>
</li></ul>
</li><li class="post" id="post-2273097779"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/ayanaaltaqin/" class="user" data-action="profile" data-username="ayanaaltaqin">
<img data-role="user-avatar" data-user="176106852" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/ayanaaltaqin/" data-action="profile" data-username="ayanaaltaqin" data-role="username">Ayana Altaqin</a></span>

</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="https://apaszke.github.io/lstm-explained.html#comment-2273097779" data-role="relative-time" class="time-ago" title="Thursday, September 24, 2015 9:23 PM">2 years ago</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Well thanks for the sharing, I just started to learn these RNN,LSTM,Lua and Torch things... And they are really hard to understand.. Your work is very helpful and I do really appreciate it .. Yes , thank you ...</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/11lcdgz" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2273097779">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"></ul>
</li><li class="post" id="post-2244419488"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/disqus_YQTggpvnhi/" class="user" data-action="profile" data-username="disqus_YQTggpvnhi">
<img data-role="user-avatar" data-user="173802795" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_YQTggpvnhi/" data-action="profile" data-username="disqus_YQTggpvnhi" data-role="username">Ozan Çağlayan</a></span>

</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="https://apaszke.github.io/lstm-explained.html#comment-2244419488" data-role="relative-time" class="time-ago" title="Wednesday, September 9, 2015 7:54 AM">2 years ago</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>I think CMulTable() should be the product while the CAddTable() the sum in their descriptions.</p><p>Thanks :)</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1149p5s" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2244419488">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"><li class="post" id="post-2248245692"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/adampaszke/" class="user" data-action="profile" data-username="adampaszke">
<img data-role="user-avatar" data-user="172362162" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/adampaszke/" data-action="profile" data-username="adampaszke" data-role="username">Adam Paszke</a></span>
<span class="badge moderator">Mod</span>

<span><a href="https://apaszke.github.io/lstm-explained.html#comment-2244419488" class="parent-link" data-role="parent-link"><i aria-hidden="true" class="icon-forward" title="in reply to"></i> Ozan Çağlayan</a></span>
</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="https://apaszke.github.io/lstm-explained.html#comment-2248245692" data-role="relative-time" class="time-ago" title="Friday, September 11, 2015 8:47 AM">2 years ago</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>You've got me, thanks! ;)</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/116jph8" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2248245692">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"></ul>
</li></ul>
</li><li class="post" id="post-2242323613"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/disqus_3BWuyN6Mlh/" class="user" data-action="profile" data-username="disqus_3BWuyN6Mlh">
<img data-role="user-avatar" data-user="173655427" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_3BWuyN6Mlh/" data-action="profile" data-username="disqus_3BWuyN6Mlh" data-role="username">joe</a></span>

</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="https://apaszke.github.io/lstm-explained.html#comment-2242323613" data-role="relative-time" class="time-ago" title="Tuesday, September 8, 2015 5:54 AM">2 years ago</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>The figures is very clear and this page makes the LSTM very easy to understand, I certainly got lot of things from this article, it makes sense. What's more, I'm also curious about the bp procedure of LSTM, maybe there will be some supplyment posts later ^ ^</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1130rz1" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2242323613">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"><li class="post" id="post-2248250367"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/adampaszke/" class="user" data-action="profile" data-username="adampaszke">
<img data-role="user-avatar" data-user="172362162" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/adampaszke/" data-action="profile" data-username="adampaszke" data-role="username">Adam Paszke</a></span>
<span class="badge moderator">Mod</span>

<span><a href="https://apaszke.github.io/lstm-explained.html#comment-2242323613" class="parent-link" data-role="parent-link"><i aria-hidden="true" class="icon-forward" title="in reply to"></i> joe</a></span>
</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="https://apaszke.github.io/lstm-explained.html#comment-2248250367" data-role="relative-time" class="time-ago" title="Friday, September 11, 2015 8:50 AM">2 years ago</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Hey! Sorry for the late reply!</p><p>It's great to hear that you liked it! Saying 'bp procedure' do you mean the exact derivations or just the training code? It's really easy to train these models with a few calls like :backward(). There are some examples in torch docs e.g.: <a href="https://disq.us/url?url=https%3A%2F%2Fgithub.com%2Ftorch%2Fnn%2Fblob%2Fmaster%2Fdoc%2Ftraining.md%3AEIH9JOUWXiUZdlrn7UI-271vHgE&amp;cuid=3762125" rel="nofollow noopener">https://github.com/torch/nn...</a></p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/116jt33" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2248250367">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"></ul>
</li></ul>
</li></ul><div class="load-more" data-role="more" style="display: none;"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" data-action="more-posts" class="btn load-more__button">Load more comments</a></div></div></section><div id="placement-bottom" data-tracking-area="discovery-south"><div class="post-list" style="height: 0px; visibility: hidden;"><div style="display: block; width: 100%;"></div></div></div><div id="footer" data-tracking-area="footer" class="disqus-footer__wrapper"><ul class="disqus-footer"><li class="disqus-footer__logo"><a href="https://disqus.com/" rel="nofollow" title="Powered by Disqus" class="disqus-footer__link">Powered by Disqus</a></li><li id="thread-subscribe-button" class="email disqus-footer__item"><div class="default"><a href="https://disqus.com/embed/comments/?base=default&amp;f=apaszke&amp;t_i=lstm-explained&amp;t_u=https%3A%2F%2Fapaszke.github.io%2Flstm-explained.html&amp;t_e=LSTM%20implementation%20explained&amp;t_d=LSTM%20implementation%20explained&amp;t_t=LSTM%20implementation%20explained&amp;s_o=default#" rel="nofollow" data-action="subscribe" title="Subscribe and get email updates from this discussion" class="disqus-footer__link"><i aria-hidden="true" class="icon icon-mail"></i><span class="clip">Subscribe</span><i aria-hidden="true" class="icon icon-checkmark"></i></a></div><div class="form"><div class="input-wrapper"><input id="thread-subscribe-email" type="email" placeholder="yourname@email.com" class="disqus-footer__input input--text"></div></div></li><li class="install disqus-footer__item"><a href="https://publishers.disqus.com/engage?utm_source=apaszke&amp;utm_medium=Disqus-Footer" rel="nofollow" target="_blank" class="disqus-footer__link"><i aria-hidden="true" class="icon icon-disqus"></i><span class="clip hidden-sm">Add Disqus to your site</span><span class="clip visible-sm hidden-xs">Add Disqus</span><span class="clip visible-xs">Add</span></a></li><li class="privacy disqus-footer__item"><a href="https://help.disqus.com/customer/portal/articles/1657951?utm_source=disqus&amp;utm_medium=embed-footer&amp;utm_content=privacy-btn" rel="nofollow" target="_blank" class="disqus-footer__link"><i aria-hidden="true" class="icon icon-lock"></i><span class="clip">Privacy</span></a></li></ul></div></div><div id="fb-root" class=" fb_reset"><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div></div></div><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div><iframe name="fb_xdm_frame_https" frameborder="0" allowtransparency="true" allowfullscreen="true" scrolling="no" id="fb_xdm_frame_https" aria-hidden="true" title="Facebook Cross Domain Communication Frame" tabindex="-1" src="./96nq-xsaNcg.html" style="border: none;"></iframe></div></div></div><iframe style="position: absolute; width: 1px; height: 1px; left: -9999px; display: none;" aria-hidden="true" id="ssIFrame_google" sandbox="allow-scripts allow-same-origin" src="./iframe.html"></iframe><img src="./tpid=c5mnhdpvrsbn2d" style="display: none;"><img src="./23096" style="display: none;"><img src="./saved_resource" style="display: none;"><iframe src="./sync.html" style="display: none;"></iframe></body></html>