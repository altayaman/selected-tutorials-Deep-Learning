<!DOCTYPE html>
<!-- saved from url=(0038)http://www.foldl.me/2014/glove-python/ -->
<html class="no-js" lang="en" prefix="og: http://ogp.me/ns#"><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <meta name="generator" content="GitHub Pages">

  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

  <!-- identity stuff -->
	<meta http-equiv="X-XRDS-Location" content="http://hansengel.myopenid.com/xrds?username=hansengel.myopenid.com">
	<meta name="microid" content="mailto+http:sha1:2b2811bc3da814ad4210e829e422c443f4b9d1e0">
	<link rel="openid.server" href="http://www.myopenid.com/server">
	<link rel="openid.delegate" href="http://hansengel.myopenid.com/">
	<link rel="openid2.provider" href="http://www.myopenid.com/server">
	<link rel="openid2.local_id" href="http://hansengel.myopenid.com/">

  <title>A GloVe implementation in Python - foldl</title>

  
  <meta name="title" content="A GloVe implementation in Python">
  <meta property="og:title" content="A GloVe implementation in Python">
  <meta name="description" content="More adventures in the land of word embeddings">
  <meta property="og:description" content="More adventures in the land of word embeddings">
  <meta property="og:site_name" content="foldl">
  <meta property="og:image" content="">
  
  <meta name="author" content="Jon Gauthier">

  <meta name="viewport" content="width=device-width,initial-scale=1">

  <link rel="stylesheet" type="text/css" href="./A GloVe implementation in Python - foldl_files/jquery.qtip.min.css">

  <link rel="stylesheet" type="text/css" href="./A GloVe implementation in Python - foldl_files/style.css">
  <link rel="stylesheet" type="text/css" href="./A GloVe implementation in Python - foldl_files/syntax.css"><!-- syntax highlighting -->
  <!--[if IE]>
      <link rel="stylesheet" type="text/css" href="/css/ie.css" />
  <![endif]-->

  <script type="text/javascript" async="" src="./A GloVe implementation in Python - foldl_files/dc.js"></script><script src="./A GloVe implementation in Python - foldl_files/modernizr-2.5.3.min.js"></script>
<style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax_LineBox {display: table!important}
.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Blank; src: url('about:blank')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><link rel="preload" as="style" href="https://c.disquscdn.com/next/embed/styles/lounge.5f04e83cf97ee6a6cf16dc8e296ed78d.css"><link rel="preload" as="script" href="https://c.disquscdn.com/next/embed/common.bundle.08b03b11c747b79c4d4135b49e2f8725.js"><link rel="preload" as="script" href="https://c.disquscdn.com/next/embed/lounge.bundle.987c6346e2effb8e4f350d48ecf53d13.js"><link rel="preload" as="script" href="https://disqus.com/next/config.js"></head>

<body><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>

  <div id="container">
    <aside id="topbar">
      <div class="inner">
        <h1><a href="http://www.foldl.me/">foldl</a></h1>

        <ul id="quick-links">
          <li><a href="http://www.foldl.me/">home</a></li>
          <li><a href="http://www.foldl.me/posts">blog</a></li>
          <li><a href="http://feeds.feedburner.com/foldl/rss">feed</a></li>
        </ul>
      </div>
    </aside>

    <section id="main" role="main">
      

<article id="single" class="hentry">
  <header class="inner">
    <h1 class="entry-title">
      
        A GloVe implementation in Python
      
    </h1>
    <time datetime="2014-09-24T00:00:00+00:00">
      24 September 2014
    </time>
  </header>

  <div class="entry-content">
    <p><a href="http://www-nlp.stanford.edu/projects/glove/">GloVe (<strong>Glo</strong>bal <strong>Ve</strong>ctors for Word Representation)</a> is a tool recently
released by Stanford NLP Group researchers <a href="http://stanford.edu/~jpennin/">Jeffrey Pennington</a>,
<a href="http://www.socher.org/">Richard Socher</a>, and <a href="http://nlp.stanford.edu/manning/">Chris Manning</a> for learning continuous-space vector
representations of words.</p>

<p style="text-align:center;font-size:88%">(jump to: <a href="http://www.foldl.me/2014/glove-python/#theory">theory</a>, <a href="http://www.foldl.me/2014/glove-python/#implementation">implementation</a>)</p>

<h2 id="introduction">Introduction</h2>

<p>These real-valued word vectors have proven to be useful for all sorts of natural
language processing tasks, including parsing,<sup id="fnref:1"><a href="http://www.foldl.me/2014/glove-python/#fn:1" class="footnote" data-hasqtip="0">1</a></sup> named entity recognition,<sup id="fnref:2"><a href="http://www.foldl.me/2014/glove-python/#fn:2" class="footnote" data-hasqtip="1">2</a></sup>
and (very recently!) machine translation.<sup id="fnref:3"><a href="http://www.foldl.me/2014/glove-python/#fn:3" class="footnote" data-hasqtip="2">3</a></sup><sup id="fnref:4"><a href="http://www.foldl.me/2014/glove-python/#fn:4" class="footnote" data-hasqtip="3">4</a></sup></p>

<p>It’s been shown (and widely shared by this point) that these word
vectors exhibit interesting <strong>semantic and syntactic regularities</strong>. For
example, we find that claims like the following hold for the associated
word vectors:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mtext&gt;king&lt;/mtext&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mtext&gt;man&lt;/mtext&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mtext&gt;woman&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;&amp;#x2248;&lt;/mo&gt;&lt;mtext&gt;queen&lt;/mtext&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mtext&gt;brought&lt;/mtext&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mtext&gt;bring&lt;/mtext&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mtext&gt;seek&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;&amp;#x2248;&lt;/mo&gt;&lt;mtext&gt;sought&lt;/mtext&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 14.885em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.662em; height: 0px; font-size: 109%;"><span style="position: absolute; clip: rect(0.512em 1013.51em 3.163em -999.997em); top: -2.087em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mtable" id="MathJax-Span-3" style="padding-right: 0.155em; padding-left: 0.155em;"><span style="display: inline-block; position: relative; width: 13.356em; height: 0px;"><span style="position: absolute; clip: rect(2.5em 1009.38em 5.048em -999.997em); top: -3.973em; left: 0em;"><span style="display: inline-block; position: relative; width: 9.381em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1008.82em 4.335em -999.997em); top: -4.585em; right: 0em;"><span class="mtd" id="MathJax-Span-4"><span class="mrow" id="MathJax-Span-5"><span class="mtext" id="MathJax-Span-6" style="font-family: STIXGeneral-Regular;">king</span><span class="mo" id="MathJax-Span-7" style="font-family: STIXGeneral-Regular; padding-left: 0.257em;">−</span><span class="mtext" id="MathJax-Span-8" style="font-family: STIXGeneral-Regular; padding-left: 0.257em;">man</span><span class="mo" id="MathJax-Span-9" style="font-family: STIXGeneral-Regular; padding-left: 0.257em;">+</span><span class="mtext" id="MathJax-Span-10" style="font-family: STIXGeneral-Regular; padding-left: 0.257em;">woman</span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(3.163em 1009.38em 4.335em -999.997em); top: -3.259em; right: 0em;"><span class="mtd" id="MathJax-Span-16"><span class="mrow" id="MathJax-Span-17"><span class="mtext" id="MathJax-Span-18" style="font-family: STIXGeneral-Regular;">brought</span><span class="mo" id="MathJax-Span-19" style="font-family: STIXGeneral-Regular; padding-left: 0.257em;">−</span><span class="mtext" id="MathJax-Span-20" style="font-family: STIXGeneral-Regular; padding-left: 0.257em;">bring</span><span class="mo" id="MathJax-Span-21" style="font-family: STIXGeneral-Regular; padding-left: 0.257em;">+</span><span class="mtext" id="MathJax-Span-22" style="font-family: STIXGeneral-Regular; padding-left: 0.257em;">seek</span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(2.704em 1003.98em 5.048em -999.997em); top: -3.973em; left: 9.381em;"><span style="display: inline-block; position: relative; width: 3.978em; height: 0px;"><span style="position: absolute; clip: rect(3.366em 1003.67em 4.335em -999.997em); top: -4.585em; left: 0em;"><span class="mtd" id="MathJax-Span-11"><span class="mrow" id="MathJax-Span-12"><span class="mi" id="MathJax-Span-13"></span><span class="mo" id="MathJax-Span-14" style="font-family: STIXGeneral-Regular; padding-left: 0.308em;">≈</span><span class="mtext" id="MathJax-Span-15" style="font-family: STIXGeneral-Regular; padding-left: 0.308em;">queen</span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(3.163em 1003.98em 4.335em -999.997em); top: -3.259em; left: 0em;"><span class="mtd" id="MathJax-Span-23"><span class="mrow" id="MathJax-Span-24"><span class="mi" id="MathJax-Span-25"></span><span class="mo" id="MathJax-Span-26" style="font-family: STIXGeneral-Regular; padding-left: 0.308em;">≈</span><span class="mtext" id="MathJax-Span-27" style="font-family: STIXGeneral-Regular; padding-left: 0.308em;">sought</span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.092em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.053em; border-left: 0px solid; width: 0px; height: 2.725em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mtext>king</mtext><mo>−</mo><mtext>man</mtext><mo>+</mo><mtext>woman</mtext></mtd><mtd><mi></mi><mo>≈</mo><mtext>queen</mtext></mtd></mtr><mtr><mtd><mtext>brought</mtext><mo>−</mo><mtext>bring</mtext><mo>+</mo><mtext>seek</mtext></mtd><mtd><mi></mi><mo>≈</mo><mtext>sought</mtext></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-1">\begin{align*}\text{king} - \text{man} + \text{woman} &\approx \text{queen} \\ \text{brought} - \text{bring} + \text{seek} &\approx \text{sought}\end{align*}</script></p>

<p>There’s quite a bit of buzz around the tools which build these word
vectors at the moment, so I figured it would be worth it to provide a
down-to-earth coverage of GloVe, one of the newest methods.</p>

<p>The GloVe authors <a href="http://www-nlp.stanford.edu/projects/glove/glove.pdf">present some results</a> which suggest that their
tool is competitive with Google’s popular <a href="https://code.google.com/p/word2vec/"><code class="highlighter-rouge">word2vec</code></a> package. In
order to better understand how GloVe works and to make available a nice
learning resource, I decided to port the open-source (yay!) but somewhat
difficult-to-read (no!) <a href="http://www-nlp.stanford.edu/software/glove.tar.gz">GloVe source code</a> from C to Python.</p>

<p>In this post I’ll give an explanation by intuition of how the GloVe method
works<sup id="fnref:5"><a href="http://www.foldl.me/2014/glove-python/#fn:5" class="footnote" data-hasqtip="4">5</a></sup> and then provide a quick overview of the implementation in Python. You
can find the complete Python code (just 187 SLOC, including command-line
argument processing, IO, etc.) in <a href="http://github.com/hans/glove.py">the <code class="highlighter-rouge">glove.py</code> GitHub repo</a>.</p>

<p>A quick disclaimer before we begin: I wrote this code for tutorial purposes. It
is nowhere near production-ready in terms of efficiency. If you would like to
parallelize and optimize it as an exercise, be my guest — just be sure to
share the results!</p>

<h2 id="theory">Theory</h2>

<p>The GloVe model learns word vectors by examining <em>word co-occurrences</em> within a
text corpus. Before we train the actual model, we need to construct a
<em>co-occurrence matrix</em> <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-28" style="width: 0.716em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.665em; height: 0px; font-size: 109%;"><span style="position: absolute; clip: rect(1.735em 1000.66em 2.704em -999.997em); top: -2.546em; left: 0em;"><span class="mrow" id="MathJax-Span-29"><span class="mi" id="MathJax-Span-30" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.551em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.836em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-2">X</script>, where a cell <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-31" style="width: 1.175em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.073em; height: 0px; font-size: 109%;"><span style="position: absolute; clip: rect(1.277em 1001.07em 2.551em -999.997em); top: -2.087em; left: 0em;"><span class="mrow" id="MathJax-Span-32"><span class="msubsup" id="MathJax-Span-33"><span style="display: inline-block; position: relative; width: 1.073em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-34" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.614em;"><span class="texatom" id="MathJax-Span-35"><span class="mrow" id="MathJax-Span-36"><span class="mi" id="MathJax-Span-37" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-38" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.092em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.386em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-3">X_{ij}</script> is a “strength” which
represents how often the word <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-39" style="width: 0.308em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.257em; height: 0px; font-size: 109%;"><span style="position: absolute; clip: rect(1.735em 1000.26em 2.704em -999.997em); top: -2.546em; left: 0em;"><span class="mrow" id="MathJax-Span-40"><span class="mi" id="MathJax-Span-41" style="font-family: STIXGeneral-Italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.551em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.836em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-4">i</script> appears in the context of the word
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-42" style="width: 0.359em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.308em; height: 0px; font-size: 109%;"><span style="position: absolute; clip: rect(1.735em 1000.31em 2.908em -999.997em); top: -2.546em; left: 0em;"><span class="mrow" id="MathJax-Span-43"><span class="mi" id="MathJax-Span-44" style="font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.551em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.058em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-5">j</script>. We run through our corpus just once to build the matrix <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-45" style="width: 0.716em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.665em; height: 0px; font-size: 109%;"><span style="position: absolute; clip: rect(1.735em 1000.66em 2.704em -999.997em); top: -2.546em; left: 0em;"><span class="mrow" id="MathJax-Span-46"><span class="mi" id="MathJax-Span-47" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.551em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.836em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-6">X</script>, and
from then on use this co-occurrence data in place of the actual corpus. We will
construct our model based only on the values collected in <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-48" style="width: 0.716em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.665em; height: 0px; font-size: 109%;"><span style="position: absolute; clip: rect(1.735em 1000.66em 2.704em -999.997em); top: -2.546em; left: 0em;"><span class="mrow" id="MathJax-Span-49"><span class="mi" id="MathJax-Span-50" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.551em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.836em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-7">X</script>.</p>

<p>Once we’ve prepared <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-51" style="width: 0.716em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.665em; height: 0px; font-size: 109%;"><span style="position: absolute; clip: rect(1.735em 1000.66em 2.704em -999.997em); top: -2.546em; left: 0em;"><span class="mrow" id="MathJax-Span-52"><span class="mi" id="MathJax-Span-53" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.551em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.836em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-8">X</script>, our task is to decide vector values in continuous
space for each word we observe in the corpus. We will produce vectors with a
soft constraint that for each word pair of word <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-54" style="width: 0.308em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.257em; height: 0px; font-size: 109%;"><span style="position: absolute; clip: rect(1.735em 1000.26em 2.704em -999.997em); top: -2.546em; left: 0em;"><span class="mrow" id="MathJax-Span-55"><span class="mi" id="MathJax-Span-56" style="font-family: STIXGeneral-Italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.551em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.836em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-9">i</script> and word <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-57" style="width: 0.359em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.308em; height: 0px; font-size: 109%;"><span style="position: absolute; clip: rect(1.735em 1000.31em 2.908em -999.997em); top: -2.546em; left: 0em;"><span class="mrow" id="MathJax-Span-58"><span class="mi" id="MathJax-Span-59" style="font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.551em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.058em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-10">j</script>,<sup id="fnref:6"><a href="http://www.foldl.me/2014/glove-python/#fn:6" class="footnote" data-hasqtip="5">6</a></sup></p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-11-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable displaystyle=&quot;true&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-1&quot;&gt;&lt;mtext&gt;(1)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-60" style="width: 100%; display: inline-block; min-width: 14.325em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 109%; min-width: 14.325em;"><span style="position: absolute; clip: rect(2.959em 1010.09em 4.539em -999.997em); top: -3.973em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-61"><span class="mtable" id="MathJax-Span-62" style="min-width: 14.325em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 14.325em;"><span style="display: inline-block; position: absolute; width: 10.196em; height: 0px; clip: rect(-1.017em 1010.09em 0.563em -999.997em); top: 0em; left: 50%; margin-left: -5.094em;"><span style="position: absolute; clip: rect(2.959em 1010.09em 4.539em -999.997em); top: -3.973em; left: 0em;"><span style="display: inline-block; position: relative; width: 10.196em; height: 0px;"><span style="position: absolute; clip: rect(2.857em 1010.09em 4.437em -999.997em); top: -3.871em; left: 50%; margin-left: -5.094em;"><span class="mtd" id="MathJax-Span-66"><span class="mrow" id="MathJax-Span-67"><span class="msubsup" id="MathJax-Span-68"><span style="display: inline-block; position: relative; width: 1.175em; height: 0px;"><span style="position: absolute; clip: rect(3.061em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="texatom" id="MathJax-Span-69"><span class="mrow" id="MathJax-Span-70"><span class="munderover" id="MathJax-Span-71"><span style="display: inline-block; position: relative; width: 0.665em; height: 0px;"><span style="position: absolute; clip: rect(3.366em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-72" style="font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.973em; left: 0.104em;"><span style="height: 0em; vertical-align: 0em; width: 0.461em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-73" style="font-family: STIXGeneral-Regular;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.252em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(3.366em 1000.51em 4.131em -999.997em); top: -4.483em; left: 0.665em;"><span class="mi" id="MathJax-Span-74" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(3.366em 1000.26em 4.131em -999.997em); top: -3.718em; left: 0.665em;"><span class="mi" id="MathJax-Span-75" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-76"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(3.061em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="texatom" id="MathJax-Span-77"><span class="mrow" id="MathJax-Span-78"><span class="munderover" id="MathJax-Span-79"><span style="display: inline-block; position: relative; width: 0.665em; height: 0px;"><span style="position: absolute; clip: rect(3.366em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-80" style="font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.973em; left: 0.104em;"><span style="height: 0em; vertical-align: 0em; width: 0.461em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-81" style="font-family: STIXGeneral-Regular;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.252em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.665em;"><span class="mi" id="MathJax-Span-82" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="mo" id="MathJax-Span-83" style="font-family: STIXGeneral-Regular; padding-left: 0.257em;">+</span><span class="msubsup" id="MathJax-Span-84" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 0.767em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1000.46em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-85" style="font-family: STIXGeneral-Italic;">b</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.512em;"><span class="mi" id="MathJax-Span-86" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="mo" id="MathJax-Span-87" style="font-family: STIXGeneral-Regular; padding-left: 0.257em;">+</span><span class="msubsup" id="MathJax-Span-88" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 0.767em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1000.46em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-89" style="font-family: STIXGeneral-Italic;">b</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.512em;"><span class="mi" id="MathJax-Span-90" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="mo" id="MathJax-Span-91" style="font-family: STIXGeneral-Regular; padding-left: 0.308em;">=</span><span class="mi" id="MathJax-Span-92" style="font-family: STIXGeneral-Regular; padding-left: 0.308em;">log</span><span class="mo" id="MathJax-Span-93"></span><span class="msubsup" id="MathJax-Span-94" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 1.073em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-95" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.614em;"><span class="texatom" id="MathJax-Span-96"><span class="mrow" id="MathJax-Span-97"><span class="mi" id="MathJax-Span-98" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-99" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="mo" id="MathJax-Span-100" style="font-family: STIXGeneral-Regular;">.</span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.175em; height: 0px; clip: rect(-0.762em 1001.12em 0.41em -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.163em 1001.12em 4.284em -999.997em); top: -3.871em; right: 0em;"><span class="mtd" id="mjx-eqn-1"><span class="mrow" id="MathJax-Span-64"><span class="mtext" id="MathJax-Span-65" style="font-family: STIXGeneral-Regular;">(1)</span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.497em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true"><mlabeledtr><mtd id="mjx-eqn-1"><mtext>(1)</mtext></mtd><mtd><msubsup><mrow class="MJX-TeXAtom-ORD"><mover><mi>w</mi><mo stretchy="false">→</mo></mover></mrow><mi>i</mi><mi>T</mi></msubsup><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>w</mi><mo stretchy="false">→</mo></mover></mrow><mi>j</mi></msub><mo>+</mo><msub><mi>b</mi><mi>i</mi></msub><mo>+</mo><msub><mi>b</mi><mi>j</mi></msub><mo>=</mo><mi>log</mi><mo>⁡</mo><msub><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mo>.</mo></mtd></mlabeledtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-11">\begin{equation}\vec{w}_i^T \vec{w}_j + b_i + b_j = \log X_{ij}.\end{equation}</script></p>

<p>where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-101" style="width: 0.869em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.767em; height: 0px; font-size: 109%;"><span style="position: absolute; clip: rect(1.277em 1000.77em 2.398em -999.997em); top: -2.087em; left: 0em;"><span class="mrow" id="MathJax-Span-102"><span class="msubsup" id="MathJax-Span-103"><span style="display: inline-block; position: relative; width: 0.767em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1000.46em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-104" style="font-family: STIXGeneral-Italic;">b</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.512em;"><span class="mi" id="MathJax-Span-105" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.092em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.219em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>b</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-12">b_i</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-106" style="width: 0.869em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.767em; height: 0px; font-size: 109%;"><span style="position: absolute; clip: rect(1.277em 1000.77em 2.551em -999.997em); top: -2.087em; left: 0em;"><span class="mrow" id="MathJax-Span-107"><span class="msubsup" id="MathJax-Span-108"><span style="display: inline-block; position: relative; width: 0.767em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1000.46em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-109" style="font-family: STIXGeneral-Italic;">b</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.512em;"><span class="mi" id="MathJax-Span-110" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.092em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.386em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>b</mi><mi>j</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-13">b_j</script> are scalar bias terms associated with words
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-111" style="width: 0.308em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.257em; height: 0px; font-size: 109%;"><span style="position: absolute; clip: rect(1.735em 1000.26em 2.704em -999.997em); top: -2.546em; left: 0em;"><span class="mrow" id="MathJax-Span-112"><span class="mi" id="MathJax-Span-113" style="font-family: STIXGeneral-Italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.551em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.836em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-14">i</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-114" style="width: 0.359em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.308em; height: 0px; font-size: 109%;"><span style="position: absolute; clip: rect(1.735em 1000.31em 2.908em -999.997em); top: -2.546em; left: 0em;"><span class="mrow" id="MathJax-Span-115"><span class="mi" id="MathJax-Span-116" style="font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.551em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.058em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-15">j</script>, respectively. Intuitively speaking, we want to build word
vectors that retain some useful information about how every pair of words
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-117" style="width: 0.308em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.257em; height: 0px; font-size: 109%;"><span style="position: absolute; clip: rect(1.735em 1000.26em 2.704em -999.997em); top: -2.546em; left: 0em;"><span class="mrow" id="MathJax-Span-118"><span class="mi" id="MathJax-Span-119" style="font-family: STIXGeneral-Italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.551em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.836em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-16">i</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-120" style="width: 0.359em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.308em; height: 0px; font-size: 109%;"><span style="position: absolute; clip: rect(1.735em 1000.31em 2.908em -999.997em); top: -2.546em; left: 0em;"><span class="mrow" id="MathJax-Span-121"><span class="mi" id="MathJax-Span-122" style="font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.551em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.058em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-17">j</script> co-occur.</p>

<p>We’ll do this by minimizing an objective function <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-123" style="width: 0.563em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.512em; height: 0px; font-size: 109%;"><span style="position: absolute; clip: rect(1.735em 1000.51em 2.704em -999.997em); top: -2.546em; left: 0em;"><span class="mrow" id="MathJax-Span-124"><span class="mi" id="MathJax-Span-125" style="font-family: STIXGeneral-Italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.551em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.836em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>J</mi></math></span></span><script type="math/tex" id="MathJax-Element-18">J</script>, which evaluates the
sum of all squared errors based on the above equation, weighted with a function
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-126" style="width: 0.461em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.41em; height: 0px; font-size: 109%;"><span style="position: absolute; clip: rect(1.735em 1000.41em 2.908em -999.997em); top: -2.546em; left: 0em;"><span class="mrow" id="MathJax-Span-127"><span class="mi" id="MathJax-Span-128" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.155em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.551em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.058em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-19">f</script>:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-20-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable displaystyle=&quot;true&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-2&quot;&gt;&lt;mtext&gt;(2)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;/munderover&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;/munderover&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-129" style="width: 100%; display: inline-block; min-width: 23.397em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 109%; min-width: 23.397em;"><span style="position: absolute; clip: rect(2.194em 1019.27em 5.66em -999.997em); top: -4.177em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-130"><span class="mtable" id="MathJax-Span-131" style="min-width: 23.397em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 23.397em;"><span style="display: inline-block; position: absolute; width: 19.269em; height: 0px; clip: rect(-1.985em 1019.27em 1.481em -999.997em); top: 0em; left: 50%; margin-left: -9.63em;"><span style="position: absolute; clip: rect(2.194em 1019.27em 5.66em -999.997em); top: -4.177em; left: 0em;"><span style="display: inline-block; position: relative; width: 19.269em; height: 0px;"><span style="position: absolute; clip: rect(2.245em 1019.27em 5.711em -999.997em); top: -4.228em; left: 50%; margin-left: -9.63em;"><span class="mtd" id="MathJax-Span-135"><span class="mrow" id="MathJax-Span-136"><span class="mi" id="MathJax-Span-137" style="font-family: STIXGeneral-Italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span class="mo" id="MathJax-Span-138" style="font-family: STIXGeneral-Regular; padding-left: 0.308em;">=</span><span class="munderover" id="MathJax-Span-139" style="padding-left: 0.308em;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; clip: rect(2.857em 1001.23em 4.59em -999.997em); top: -3.973em; left: 0em;"><span class="mo" id="MathJax-Span-140" style="font-family: STIXSizeOneSym; vertical-align: -0.507em;">∑</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(3.366em 1000.97em 4.233em -999.997em); top: -2.801em; left: 0.155em;"><span class="texatom" id="MathJax-Span-141"><span class="mrow" id="MathJax-Span-142"><span class="mi" id="MathJax-Span-143" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-144" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-145" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(3.265em 1000.51em 4.131em -999.997em); top: -5.196em; left: 0.41em;"><span class="mi" id="MathJax-Span-146" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="munderover" id="MathJax-Span-147" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; clip: rect(2.857em 1001.23em 4.59em -999.997em); top: -3.973em; left: 0em;"><span class="mo" id="MathJax-Span-148" style="font-family: STIXSizeOneSym; vertical-align: -0.507em;">∑</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(3.366em 1000.97em 4.386em -999.997em); top: -2.801em; left: 0.155em;"><span class="texatom" id="MathJax-Span-149"><span class="mrow" id="MathJax-Span-150"><span class="mi" id="MathJax-Span-151" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-152" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-153" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(3.265em 1000.51em 4.131em -999.997em); top: -5.196em; left: 0.41em;"><span class="mi" id="MathJax-Span-154" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="mspace" id="MathJax-Span-155" style="height: 0em; vertical-align: 0em; width: 0.308em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-156" style="font-family: STIXGeneral-Italic; padding-left: 0.206em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.155em;"></span></span><span class="mrow" id="MathJax-Span-157" style="padding-left: 0.206em;"><span class="mo" id="MathJax-Span-158" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">(</span></span><span class="msubsup" id="MathJax-Span-159"><span style="display: inline-block; position: relative; width: 1.073em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-160" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.614em;"><span class="texatom" id="MathJax-Span-161"><span class="mrow" id="MathJax-Span-162"><span class="mi" id="MathJax-Span-163" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-164" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="mo" id="MathJax-Span-165" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">)</span></span></span><span class="msubsup" id="MathJax-Span-166" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 11.318em; height: 0px;"><span style="position: absolute; clip: rect(2.857em 1010.71em 4.539em -999.997em); top: -3.973em; left: 0em;"><span class="mrow" id="MathJax-Span-167"><span class="mo" id="MathJax-Span-168" style="vertical-align: -0.252em;"><span><span style="font-size: 110%; font-family: STIXSizeOneSym;">(</span></span></span><span class="mrow" id="MathJax-Span-169"><span class="msubsup" id="MathJax-Span-170"><span style="display: inline-block; position: relative; width: 1.175em; height: 0px;"><span style="position: absolute; clip: rect(3.061em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="texatom" id="MathJax-Span-171"><span class="mrow" id="MathJax-Span-172"><span class="munderover" id="MathJax-Span-173"><span style="display: inline-block; position: relative; width: 0.665em; height: 0px;"><span style="position: absolute; clip: rect(3.366em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-174" style="font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.973em; left: 0.104em;"><span style="height: 0em; vertical-align: 0em; width: 0.461em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-175" style="font-family: STIXGeneral-Regular;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.252em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(3.366em 1000.51em 4.131em -999.997em); top: -4.483em; left: 0.665em;"><span class="mi" id="MathJax-Span-176" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(3.366em 1000.26em 4.131em -999.997em); top: -3.718em; left: 0.665em;"><span class="mi" id="MathJax-Span-177" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-178"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(3.061em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="texatom" id="MathJax-Span-179"><span class="mrow" id="MathJax-Span-180"><span class="munderover" id="MathJax-Span-181"><span style="display: inline-block; position: relative; width: 0.665em; height: 0px;"><span style="position: absolute; clip: rect(3.366em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-182" style="font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.973em; left: 0.104em;"><span style="height: 0em; vertical-align: 0em; width: 0.461em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-183" style="font-family: STIXGeneral-Regular;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.252em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.665em;"><span class="mi" id="MathJax-Span-184" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="mo" id="MathJax-Span-185" style="font-family: STIXGeneral-Regular; padding-left: 0.257em;">+</span><span class="msubsup" id="MathJax-Span-186" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 0.767em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1000.46em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-187" style="font-family: STIXGeneral-Italic;">b</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.512em;"><span class="mi" id="MathJax-Span-188" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="mo" id="MathJax-Span-189" style="font-family: STIXGeneral-Regular; padding-left: 0.257em;">+</span><span class="msubsup" id="MathJax-Span-190" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 0.767em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1000.46em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-191" style="font-family: STIXGeneral-Italic;">b</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.512em;"><span class="mi" id="MathJax-Span-192" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="mo" id="MathJax-Span-193" style="font-family: STIXGeneral-Regular; padding-left: 0.257em;">−</span><span class="mi" id="MathJax-Span-194" style="font-family: STIXGeneral-Regular; padding-left: 0.257em;">log</span><span class="mo" id="MathJax-Span-195"></span><span class="msubsup" id="MathJax-Span-196" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 1.073em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-197" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.614em;"><span class="texatom" id="MathJax-Span-198"><span class="mrow" id="MathJax-Span-199"><span class="mi" id="MathJax-Span-200" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-201" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-202" style="vertical-align: -0.252em;"><span><span style="font-size: 110%; font-family: STIXSizeOneSym;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -4.687em; left: 10.859em;"><span class="mn" id="MathJax-Span-203" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.182em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.182em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.175em; height: 0px; clip: rect(-0.915em 1001.12em 0.257em -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.163em 1001.12em 4.284em -999.997em); top: -4.024em; right: 0em;"><span class="mtd" id="mjx-eqn-2"><span class="mrow" id="MathJax-Span-133"><span class="mtext" id="MathJax-Span-134" style="font-family: STIXGeneral-Regular;">(2)</span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.182em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.497em; border-left: 0px solid; width: 0px; height: 3.558em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true"><mlabeledtr><mtd id="mjx-eqn-2"><mtext>(2)</mtext></mtd><mtd><mi>J</mi><mo>=</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>V</mi></munderover><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>V</mi></munderover><mspace width="thickmathspace"></mspace><mi>f</mi><mrow><mo>(</mo><msub><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mo>)</mo></mrow><msup><mrow><mo>(</mo><mrow><msubsup><mrow class="MJX-TeXAtom-ORD"><mover><mi>w</mi><mo stretchy="false">→</mo></mover></mrow><mi>i</mi><mi>T</mi></msubsup><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>w</mi><mo stretchy="false">→</mo></mover></mrow><mi>j</mi></msub><mo>+</mo><msub><mi>b</mi><mi>i</mi></msub><mo>+</mo><msub><mi>b</mi><mi>j</mi></msub><mo>−</mo><mi>log</mi><mo>⁡</mo><msub><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub></mrow><mo>)</mo></mrow><mn>2</mn></msup></mtd></mlabeledtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-20">\begin{equation}J = \sum_{i=1}^V \sum_{j=1}^V \; f\left(X_{ij}\right) \left( \vec{w}_i^T \vec{w}_j + b_i + b_j - \log X_{ij} \right)^2 \end{equation}</script></p>

<p>We choose an <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-204" style="width: 0.461em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.41em; height: 0px; font-size: 109%;"><span style="position: absolute; clip: rect(1.735em 1000.41em 2.908em -999.997em); top: -2.546em; left: 0em;"><span class="mrow" id="MathJax-Span-205"><span class="mi" id="MathJax-Span-206" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.155em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.551em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.058em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-21">f</script> that helps prevents common word pairs (i.e., those with
large <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-207" style="width: 1.175em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.073em; height: 0px; font-size: 109%;"><span style="position: absolute; clip: rect(1.277em 1001.07em 2.551em -999.997em); top: -2.087em; left: 0em;"><span class="mrow" id="MathJax-Span-208"><span class="msubsup" id="MathJax-Span-209"><span style="display: inline-block; position: relative; width: 1.073em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-210" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.614em;"><span class="texatom" id="MathJax-Span-211"><span class="mrow" id="MathJax-Span-212"><span class="mi" id="MathJax-Span-213" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-214" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.092em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.386em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-22">X_{ij}</script> values) from skewing our objective too much:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-23-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable displaystyle=&quot;true&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-3&quot;&gt;&lt;mtext&gt;(3)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;{&lt;/mo&gt;&lt;mtable columnalign=&quot;center left&quot; rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;max&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mfrac&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;/msup&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mtext&gt;if&amp;#xA0;&lt;/mtext&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;max&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mtext&gt;otherwise.&lt;/mtext&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo fence=&quot;true&quot; stretchy=&quot;true&quot; symmetric=&quot;true&quot;&gt;&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-215" style="width: 100%; display: inline-block; min-width: 18.81em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 109%; min-width: 18.81em;"><span style="position: absolute; clip: rect(2.245em 1014.68em 5.915em -999.997em); top: -4.33em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-216"><span class="mtable" id="MathJax-Span-217" style="min-width: 18.81em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 18.81em;"><span style="display: inline-block; position: absolute; width: 14.681em; height: 0px; clip: rect(-2.087em 1014.68em 1.583em -999.997em); top: 0em; left: 50%; margin-left: -7.337em;"><span style="position: absolute; clip: rect(2.245em 1014.68em 5.915em -999.997em); top: -4.33em; left: 0em;"><span style="display: inline-block; position: relative; width: 14.681em; height: 0px;"><span style="position: absolute; clip: rect(2.245em 1014.68em 5.915em -999.997em); top: -4.33em; left: 50%; margin-left: -7.337em;"><span class="mtd" id="MathJax-Span-221"><span class="mrow" id="MathJax-Span-222"><span class="mi" id="MathJax-Span-223" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.155em;"></span></span><span class="mrow" id="MathJax-Span-224" style="padding-left: 0.206em;"><span class="mo" id="MathJax-Span-225" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">(</span></span><span class="msubsup" id="MathJax-Span-226"><span style="display: inline-block; position: relative; width: 1.073em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-227" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.614em;"><span class="texatom" id="MathJax-Span-228"><span class="mrow" id="MathJax-Span-229"><span class="mi" id="MathJax-Span-230" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-231" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="mo" id="MathJax-Span-232" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">)</span></span></span><span class="mo" id="MathJax-Span-233" style="font-family: STIXGeneral-Regular; padding-left: 0.308em;">=</span><span class="mrow" id="MathJax-Span-234" style="padding-left: 0.308em;"><span class="mo" id="MathJax-Span-235" style="vertical-align: -0.762em;"><span style="font-family: STIXSizeFourSym;">{</span></span><span class="mtable" id="MathJax-Span-236" style="padding-right: 0.155em; padding-left: 0.155em;"><span style="display: inline-block; position: relative; width: 9.381em; height: 0px;"><span style="position: absolute; clip: rect(2.041em 1003.26em 5.507em -999.997em); top: -4.126em; left: 0em;"><span style="display: inline-block; position: relative; width: 3.265em; height: 0px;"><span style="position: absolute; clip: rect(2.602em 1003.26em 4.794em -999.997em); top: -4.687em; left: 50%; margin-left: -1.628em;"><span class="mtd" id="MathJax-Span-237"><span class="mrow" id="MathJax-Span-238"><span class="msubsup" id="MathJax-Span-239"><span style="display: inline-block; position: relative; width: 3.265em; height: 0px;"><span style="position: absolute; clip: rect(2.653em 1002.65em 4.794em -999.997em); top: -3.973em; left: 0em;"><span class="mrow" id="MathJax-Span-240"><span class="mo" id="MathJax-Span-241" style="vertical-align: -0.405em;"><span style="font-family: STIXSizeTwoSym;">(</span></span><span class="mfrac" id="MathJax-Span-242"><span style="display: inline-block; position: relative; width: 1.328em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.366em 1000.77em 4.335em -999.997em); top: -4.585em; left: 50%; margin-left: -0.354em;"><span class="msubsup" id="MathJax-Span-243"><span style="display: inline-block; position: relative; width: 0.767em; height: 0px;"><span style="position: absolute; clip: rect(3.366em 1000.46em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-244" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.41em;"><span class="texatom" id="MathJax-Span-245"><span class="mrow" id="MathJax-Span-246"><span class="mi" id="MathJax-Span-247" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-248" style="font-size: 50%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(3.519em 1001.23em 4.233em -999.997em); top: -3.616em; left: 50%; margin-left: -0.609em;"><span class="msubsup" id="MathJax-Span-249"><span style="display: inline-block; position: relative; width: 1.226em; height: 0px;"><span style="position: absolute; clip: rect(3.519em 1000.31em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-250" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.308em;"><span class="texatom" id="MathJax-Span-251"><span class="mrow" id="MathJax-Span-252"><span class="mtext" id="MathJax-Span-253" style="font-size: 50%; font-family: STIXGeneral-Regular;">max</span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(0.869em 1001.33em 1.226em -999.997em); top: -1.272em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.328em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.073em;"></span></span></span></span><span class="mo" id="MathJax-Span-254" style="vertical-align: -0.405em;"><span style="font-family: STIXSizeTwoSym;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -4.89em; left: 2.806em;"><span class="mi" id="MathJax-Span-255" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">α</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(3.163em 1000.41em 4.131em -999.997em); top: -2.75em; left: 50%; margin-left: -0.252em;"><span class="mtd" id="MathJax-Span-271"><span class="mrow" id="MathJax-Span-272"><span class="mn" id="MathJax-Span-273" style="font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.131em;"></span></span><span style="position: absolute; clip: rect(2.449em 1005em 5.354em -999.997em); top: -3.973em; left: 4.386em;"><span style="display: inline-block; position: relative; width: 4.997em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1005em 4.437em -999.997em); top: -4.687em; left: 0em;"><span class="mtd" id="MathJax-Span-256"><span class="mrow" id="MathJax-Span-257"><span class="mtext" id="MathJax-Span-258" style="font-family: STIXGeneral-Regular;">if&nbsp;</span><span class="msubsup" id="MathJax-Span-259"><span style="display: inline-block; position: relative; width: 1.073em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-260" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.614em;"><span class="texatom" id="MathJax-Span-261"><span class="mrow" id="MathJax-Span-262"><span class="mi" id="MathJax-Span-263" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-264" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="mo" id="MathJax-Span-265" style="font-family: STIXGeneral-Regular; padding-left: 0.308em;">&lt;</span><span class="msubsup" id="MathJax-Span-266" style="padding-left: 0.308em;"><span style="display: inline-block; position: relative; width: 1.735em; height: 0px;"><span style="position: absolute; clip: rect(3.366em 1000.46em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-267" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.461em;"><span class="texatom" id="MathJax-Span-268"><span class="mrow" id="MathJax-Span-269"><span class="mtext" id="MathJax-Span-270" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">max</span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(3.163em 1004.08em 4.131em -999.997em); top: -2.75em; left: 0em;"><span class="mtd" id="MathJax-Span-274"><span class="mrow" id="MathJax-Span-275"><span class="mtext" id="MathJax-Span-276" style="font-family: STIXGeneral-Regular;">otherwise.</span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="mo" id="MathJax-Span-277"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.335em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.335em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.175em; height: 0px; clip: rect(-0.813em 1001.12em 0.308em -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.163em 1001.12em 4.284em -999.997em); top: -3.973em; right: 0em;"><span class="mtd" id="mjx-eqn-3"><span class="mrow" id="MathJax-Span-219"><span class="mtext" id="MathJax-Span-220" style="font-family: STIXGeneral-Regular;">(3)</span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.335em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.608em; border-left: 0px solid; width: 0px; height: 3.725em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true"><mlabeledtr><mtd id="mjx-eqn-3"><mtext>(3)</mtext></mtd><mtd><mi>f</mi><mrow><mo>(</mo><msub><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mo>)</mo></mrow><mo>=</mo><mrow><mo>{</mo><mtable columnalign="center left" rowspacing="4pt" columnspacing="1em"><mtr><mtd><msup><mrow><mo>(</mo><mfrac><msub><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mtext>max</mtext></mrow></msub></mfrac><mo>)</mo></mrow><mi>α</mi></msup></mtd><mtd><mtext>if&nbsp;</mtext><msub><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mo>&lt;</mo><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mtext>max</mtext></mrow></msub></mtd></mtr><mtr><mtd><mn>1</mn></mtd><mtd><mtext>otherwise.</mtext></mtd></mtr></mtable><mo fence="true" stretchy="true" symmetric="true"></mo></mrow></mtd></mlabeledtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-23">\begin{equation}f\left(X_{ij}\right) = \left\{ \begin{array}{cl}\left(\frac{X_{ij}}{x_{\text{max}}}\right)^\alpha & \text{if } X_{ij} < x_{\text{max}} \\ 1 & \text{otherwise.} \end{array}\right. \end{equation} </script></p>

<p>When we encounter extremely common word pairs (where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;max&lt;/mtext&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-278" style="width: 4.539em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.131em; height: 0px; font-size: 109%;"><span style="position: absolute; clip: rect(1.735em 1004.13em 3.01em -999.997em); top: -2.546em; left: 0em;"><span class="mrow" id="MathJax-Span-279"><span class="msubsup" id="MathJax-Span-280"><span style="display: inline-block; position: relative; width: 1.073em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-281" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.614em;"><span class="texatom" id="MathJax-Span-282"><span class="mrow" id="MathJax-Span-283"><span class="mi" id="MathJax-Span-284" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-285" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="mo" id="MathJax-Span-286" style="font-family: STIXGeneral-Regular; padding-left: 0.308em;">&gt;</span><span class="msubsup" id="MathJax-Span-287" style="padding-left: 0.308em;"><span style="display: inline-block; position: relative; width: 1.735em; height: 0px;"><span style="position: absolute; clip: rect(3.366em 1000.46em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-288" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.461em;"><span class="texatom" id="MathJax-Span-289"><span class="mrow" id="MathJax-Span-290"><span class="mtext" id="MathJax-Span-291" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">max</span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.551em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.386em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mo>&gt;</mo><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mtext>max</mtext></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-24">X_{ij} >
x_{\text{max}}</script>) this function will cut off its normal output and simply
return <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-292" style="width: 0.563em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.512em; height: 0px; font-size: 109%;"><span style="position: absolute; clip: rect(1.735em 1000.41em 2.704em -999.997em); top: -2.546em; left: 0em;"><span class="mrow" id="MathJax-Span-293"><span class="mn" id="MathJax-Span-294" style="font-family: STIXGeneral-Regular;">1</span></span><span style="display: inline-block; width: 0px; height: 2.551em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.836em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-25">1</script>. For all other word pairs, we return some weight in the range
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-295" style="width: 2.347em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.143em; height: 0px; font-size: 109%;"><span style="position: absolute; clip: rect(1.735em 1002.09em 2.857em -999.997em); top: -2.546em; left: 0em;"><span class="mrow" id="MathJax-Span-296"><span class="mo" id="MathJax-Span-297" style="font-family: STIXGeneral-Regular;">(</span><span class="mn" id="MathJax-Span-298" style="font-family: STIXGeneral-Regular;">0</span><span class="mo" id="MathJax-Span-299" style="font-family: STIXGeneral-Regular;">,</span><span class="mn" id="MathJax-Span-300" style="font-family: STIXGeneral-Regular; padding-left: 0.206em;">1</span><span class="mo" id="MathJax-Span-301" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.551em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.219em; border-left: 0px solid; width: 0px; height: 1.058em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-26">(0, 1)</script>, where the distribution of weights in this range is decided by
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03B1;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-302" style="width: 0.614em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.563em; height: 0px; font-size: 109%;"><span style="position: absolute; clip: rect(1.939em 1000.56em 2.704em -999.997em); top: -2.546em; left: 0em;"><span class="mrow" id="MathJax-Span-303"><span class="mi" id="MathJax-Span-304" style="font-family: STIXGeneral-Italic;">α</span></span><span style="display: inline-block; width: 0px; height: 2.551em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.614em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>α</mi></math></span></span><script type="math/tex" id="MathJax-Element-27">\alpha</script>.</p>

<h2 id="implementation">Implementation</h2>

<p>Now for the code! I’ll skip the boring parts which do things like model saving
and argument parsing, and focus on the three most meaty functions in the code:</p>

<ol>
  <li><code class="highlighter-rouge">build_cooccur</code> accepts a corpus and yields a list of
co-occurrence blobs (the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-305" style="width: 1.175em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.073em; height: 0px; font-size: 109%;"><span style="position: absolute; clip: rect(1.277em 1001.07em 2.551em -999.997em); top: -2.087em; left: 0em;"><span class="mrow" id="MathJax-Span-306"><span class="msubsup" id="MathJax-Span-307"><span style="display: inline-block; position: relative; width: 1.073em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-308" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.614em;"><span class="texatom" id="MathJax-Span-309"><span class="mrow" id="MathJax-Span-310"><span class="mi" id="MathJax-Span-311" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-312" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.092em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.386em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-28">X_{ij}</script> values). It calculates
co-occurrences by moving a <em>sliding n-gram window</em> over each
sentence in the corpus.</li>
  <li><code class="highlighter-rouge">train_glove</code>, which prepares the parameters of the model and manages
training at a high level, and</li>
  <li><code class="highlighter-rouge">run_iter</code>, which runs a single parameter update step.</li>
</ol>

<p>First, our <code class="highlighter-rouge">build_cooccur</code> function accepts a vocabulary (mapping words to
integer word IDs), a corpus (a simple iterator over sentences), and some
optional parameters: a context window size and a minimum count (used to
drop rare word co-occurrence pairs). We’ll start by building a sparse
matrix for collecting cooccurrences <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-313" style="width: 1.175em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.073em; height: 0px; font-size: 109%;"><span style="position: absolute; clip: rect(1.277em 1001.07em 2.551em -999.997em); top: -2.087em; left: 0em;"><span class="mrow" id="MathJax-Span-314"><span class="msubsup" id="MathJax-Span-315"><span style="display: inline-block; position: relative; width: 1.073em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-316" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.614em;"><span class="texatom" id="MathJax-Span-317"><span class="mrow" id="MathJax-Span-318"><span class="mi" id="MathJax-Span-319" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-320" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.092em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.386em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-29">X_{ij}</script> and some simple helper
data.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">build_cooccur</span><span class="p">(</span><span class="n">vocab</span><span class="p">,</span> <span class="n">corpus</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">min_count</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="n">vocab_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vocab</span><span class="p">)</span>
    <span class="n">id2word</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">word</span><span class="p">)</span> <span class="k">for</span> <span class="n">word</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="ow">in</span> <span class="n">vocab</span><span class="o">.</span><span class="n">iteritems</span><span class="p">())</span>

    <span class="c"># Collect cooccurrences internally as a sparse matrix for</span>
    <span class="c"># passable indexing speed; we'll convert into a list later</span>
    <span class="n">cooccurrences</span> <span class="o">=</span> <span class="n">sparse</span><span class="o">.</span><span class="n">lil_matrix</span><span class="p">((</span><span class="n">vocab_size</span><span class="p">,</span> <span class="n">vocab_size</span><span class="p">),</span>
                                      <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span></code></pre></figure>

<p>For each line in the corpus, we’ll conjure up a sequence of word IDs:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># -- continued --</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">corpus</span><span class="p">):</span>
        <span class="n">tokens</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="n">token_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">vocab</span><span class="p">[</span><span class="n">word</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">tokens</span><span class="p">]</span></code></pre></figure>

<p>Now for each word ID <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-321" style="width: 0.308em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.257em; height: 0px; font-size: 109%;"><span style="position: absolute; clip: rect(1.735em 1000.26em 2.704em -999.997em); top: -2.546em; left: 0em;"><span class="mrow" id="MathJax-Span-322"><span class="mi" id="MathJax-Span-323" style="font-family: STIXGeneral-Italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.551em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.836em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-30">i</script> in the sentence, we’ll extract a window of context
words to the left of the word.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># -- continued --</span>
        <span class="k">for</span> <span class="n">center_i</span><span class="p">,</span> <span class="n">center_id</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">token_ids</span><span class="p">):</span>
            <span class="c"># Collect all word IDs in left window of center word</span>
            <span class="n">context_ids</span> <span class="o">=</span> <span class="n">token_ids</span><span class="p">[</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">center_i</span> <span class="o">-</span> <span class="n">window_size</span><span class="p">)</span>
                                    <span class="p">:</span> <span class="n">center_i</span><span class="p">]</span>
            <span class="n">contexts_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">context_ids</span><span class="p">)</span></code></pre></figure>

<p>For each word ID <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-324" style="width: 0.359em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.308em; height: 0px; font-size: 109%;"><span style="position: absolute; clip: rect(1.735em 1000.31em 2.908em -999.997em); top: -2.546em; left: 0em;"><span class="mrow" id="MathJax-Span-325"><span class="mi" id="MathJax-Span-326" style="font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.551em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.275em; border-left: 0px solid; width: 0px; height: 1.058em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>j</mi></math></span></span><script type="math/tex" id="MathJax-Element-31">j</script> in the context, we’ll add on weight to the
cell <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-327" style="width: 1.175em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.073em; height: 0px; font-size: 109%;"><span style="position: absolute; clip: rect(1.277em 1001.07em 2.551em -999.997em); top: -2.087em; left: 0em;"><span class="mrow" id="MathJax-Span-328"><span class="msubsup" id="MathJax-Span-329"><span style="display: inline-block; position: relative; width: 1.073em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-330" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.614em;"><span class="texatom" id="MathJax-Span-331"><span class="mrow" id="MathJax-Span-332"><span class="mi" id="MathJax-Span-333" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-334" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.092em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.386em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-32">X_{ij}</script>. The increment for the word pair
is inversely related to the distance between the two words in
question. This means word instances which appear next to each other
see higher <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-335" style="width: 1.175em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.073em; height: 0px; font-size: 109%;"><span style="position: absolute; clip: rect(1.277em 1001.07em 2.551em -999.997em); top: -2.087em; left: 0em;"><span class="mrow" id="MathJax-Span-336"><span class="msubsup" id="MathJax-Span-337"><span style="display: inline-block; position: relative; width: 1.073em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-338" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.614em;"><span class="texatom" id="MathJax-Span-339"><span class="mrow" id="MathJax-Span-340"><span class="mi" id="MathJax-Span-341" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-342" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.092em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.386em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-33">X_{ij}</script> increments than word
instances which appear with many words in between.</p>

<p>One last technical point: we build this matrix <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-343" style="width: 1.175em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.073em; height: 0px; font-size: 109%;"><span style="position: absolute; clip: rect(1.277em 1001.07em 2.551em -999.997em); top: -2.087em; left: 0em;"><span class="mrow" id="MathJax-Span-344"><span class="msubsup" id="MathJax-Span-345"><span style="display: inline-block; position: relative; width: 1.073em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-346" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.614em;"><span class="texatom" id="MathJax-Span-347"><span class="mrow" id="MathJax-Span-348"><span class="mi" id="MathJax-Span-349" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-350" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.092em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.386em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-34">X_{ij}</script>
<em>symmetrically</em>. This means that we treat word co-occurrences where the
context word is to the left of the main word exactly the same as
co-occurrences where the context word is to the right of the main word.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># -- continued --</span>
            <span class="k">for</span> <span class="n">left_i</span><span class="p">,</span> <span class="n">left_id</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">context_ids</span><span class="p">):</span>
                <span class="c"># Distance from center word</span>
                <span class="n">distance</span> <span class="o">=</span> <span class="n">contexts_len</span> <span class="o">-</span> <span class="n">left_i</span>

                <span class="c"># Weight by inverse of distance between words</span>
                <span class="n">increment</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span>

                <span class="c"># Build co-occurrence matrix symmetrically (pretend</span>
                <span class="c"># we are calculating right contexts as well)</span>
                <span class="n">cooccurrences</span><span class="p">[</span><span class="n">center_id</span><span class="p">,</span> <span class="n">left_id</span><span class="p">]</span> <span class="o">+=</span> <span class="n">increment</span>
                <span class="n">cooccurrences</span><span class="p">[</span><span class="n">left_id</span><span class="p">,</span> <span class="n">center_id</span><span class="p">]</span> <span class="o">+=</span> <span class="n">increment</span></code></pre></figure>

<p>That’s about it — <code class="highlighter-rouge">build_cooccur</code> finishes with
<a href="https://github.com/hans/glove.py/blob/582549ddeeeb445cc676615f64e318aba1f46295/glove.py#L171-182">a bit more code to yield co-occurrence pairs from this sparse matrix</a>, but
I won’t bother to show it here.</p>

<p>Next, <code class="highlighter-rouge">train_glove</code> initializes the model parameters given the fully
constructed co-occurrence data. We expect the same <code class="highlighter-rouge">vocab</code> object as
before as a first parameter. The second parameter, <code class="highlighter-rouge">cooccurrences</code>,
is a co-occurrence iterator produced in <code class="highlighter-rouge">build_cooccur</code>, which
yields co-occurrence tuples of the form <code class="highlighter-rouge">(main_word_id,
context_word_id, x_ij)</code>, where <code class="highlighter-rouge">x_ij</code> is an <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-351" style="width: 1.175em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.073em; height: 0px; font-size: 109%;"><span style="position: absolute; clip: rect(1.277em 1001.07em 2.551em -999.997em); top: -2.087em; left: 0em;"><span class="mrow" id="MathJax-Span-352"><span class="msubsup" id="MathJax-Span-353"><span style="display: inline-block; position: relative; width: 1.073em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-354" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.614em;"><span class="texatom" id="MathJax-Span-355"><span class="mrow" id="MathJax-Span-356"><span class="mi" id="MathJax-Span-357" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-358" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.092em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.386em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-35">X_{ij}</script>
co-occurrence value as introduced above.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">train_glove</span><span class="p">(</span><span class="n">vocab</span><span class="p">,</span> <span class="n">cooccurrences</span><span class="p">,</span> <span class="n">vector_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                <span class="n">iterations</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span></code></pre></figure>

<p>We next prepare the primary model parameters: the word vector matrix <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-359" style="width: 0.971em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px; font-size: 109%;"><span style="position: absolute; clip: rect(1.735em 1000.87em 2.704em -999.997em); top: -2.546em; left: 0em;"><span class="mrow" id="MathJax-Span-360"><span class="mi" id="MathJax-Span-361" style="font-family: STIXGeneral-Italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.551em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.836em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>W</mi></math></span></span><script type="math/tex" id="MathJax-Element-36">W</script> and
a collection of bias scalars. Note that our word matrix has twice as many rows
as the number of words in the corpus. We will find out why later in describing
the <code class="highlighter-rouge">run_iter</code> function.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># -- continued --</span>
    <span class="n">vocab_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vocab</span><span class="p">)</span>

    <span class="c"># Word vector matrix. This matrix is (2V) * d, where N is the</span>
    <span class="c"># size of the corpus vocabulary and d is the dimensionality of</span>
    <span class="c"># the word vectors. All elements are initialized randomly in the</span>
    <span class="c"># range (-0.5, 0.5]. We build two word vectors for each word:</span>
    <span class="c"># one for the word as the main (center) word and one for the</span>
    <span class="c"># word as a context word.</span>
    <span class="c">#</span>
    <span class="c"># It is up to the client to decide what to do with the resulting</span>
    <span class="c"># two vectors. Pennington et al. (2014) suggest adding or</span>
    <span class="c"># averaging the two for each word, or discarding the context</span>
    <span class="c"># vectors.</span>
    <span class="n">W</span> <span class="o">=</span> <span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">vocab_size</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">vector_size</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span>
         <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">vector_size</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

    <span class="c"># Bias terms, each associated with a single vector. An array of</span>
    <span class="c"># size $2V$, initialized randomly in the range (-0.5, 0.5].</span>
    <span class="n">biases</span> <span class="o">=</span> <span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">vocab_size</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span>
              <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">vector_size</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span></code></pre></figure>

<p>We will be training using adaptive gradient descent (AdaGrad),<sup id="fnref:7"><a href="http://www.foldl.me/2014/glove-python/#fn:7" class="footnote" data-hasqtip="6">7</a></sup> and so we’ll
also need to initialize helper matrices for <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-362" style="width: 0.971em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.869em; height: 0px; font-size: 109%;"><span style="position: absolute; clip: rect(1.735em 1000.87em 2.704em -999.997em); top: -2.546em; left: 0em;"><span class="mrow" id="MathJax-Span-363"><span class="mi" id="MathJax-Span-364" style="font-family: STIXGeneral-Italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.551em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.836em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>W</mi></math></span></span><script type="math/tex" id="MathJax-Element-37">W</script> and the bias vector which
track gradient histories. Note that these all are initialized as blocks of ones.
By starting with every gradient history equal to one, our first training step in
AdaGrad will simply use the global learning rate for each example. (See footnote
7<sup id="fnref:7:1"><a href="http://www.foldl.me/2014/glove-python/#fn:7" class="footnote" data-hasqtip="7">7</a></sup> to work this out from the AdaGrad definition.)</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># -- continued --</span>
    <span class="c"># Training is done via adaptive gradient descent (AdaGrad). To</span>
    <span class="c"># make this work we need to store the sum of squares of all</span>
    <span class="c"># previous gradients.</span>
    <span class="c">#</span>
    <span class="c"># Like `W`, this matrix is (2V) * d.</span>
    <span class="c">#</span>
    <span class="c"># Initialize all squared gradient sums to 1 so that our initial</span>
    <span class="c"># adaptive learning rate is simply the global learning rate.</span>
    <span class="n">gradient_squared</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">vocab_size</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">vector_size</span><span class="p">),</span>
                               <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>

    <span class="c"># Sum of squared gradients for the bias terms.</span>
    <span class="n">gradient_squared_biases</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">vocab_size</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span>
                                      <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span></code></pre></figure>

<p>Next, we begin training by iteratively calling the <code class="highlighter-rouge">run_iter</code> function.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># -- continued --</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">iterations</span><span class="p">):</span>
        <span class="n">cost</span> <span class="o">=</span> <span class="n">run_iter</span><span class="p">(</span><span class="n">vocab</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code></pre></figure>

<p><code class="highlighter-rouge">run_iter</code> accepts this pre-fetched data and begins by shuffling it and
establishing a global cost for the iteration:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># -- continued --</span>
    <span class="n">global_cost</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c"># Iterate over data in random order</span>
    <span class="n">shuffle</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code></pre></figure>

<p>Now for every co-occurrence data tuple, we compute the weighted cost as
described in the above theory section. Each tuple has the following elements:</p>

<ol>
  <li><code class="highlighter-rouge">v_main</code>: the word vector for the main word in the co-occurrence</li>
  <li><code class="highlighter-rouge">v_context</code>: the word vector for the context word in the co-occurrence</li>
  <li><code class="highlighter-rouge">b_main</code>: bias scalar for main word</li>
  <li><code class="highlighter-rouge">b_context</code>: bias scalar for context word</li>
  <li><code class="highlighter-rouge">gradsq_W_main</code>: a vector storing the squared gradient history for the main
word vector (for use in the AdaGrad update)</li>
  <li><code class="highlighter-rouge">gradsq_W_context</code>: a vector gradient history for the context word vector</li>
  <li><code class="highlighter-rouge">gradsq_b_main</code>: a scalar gradient history for the main word bias</li>
  <li><code class="highlighter-rouge">gradsq_b_context</code>: a scalar gradient history for the context word bias</li>
  <li><code class="highlighter-rouge">cooccurrence</code>: the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-365" style="width: 1.175em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.073em; height: 0px; font-size: 109%;"><span style="position: absolute; clip: rect(1.277em 1001.07em 2.551em -999.997em); top: -2.087em; left: 0em;"><span class="mrow" id="MathJax-Span-366"><span class="msubsup" id="MathJax-Span-367"><span style="display: inline-block; position: relative; width: 1.073em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-368" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.614em;"><span class="texatom" id="MathJax-Span-369"><span class="mrow" id="MathJax-Span-370"><span class="mi" id="MathJax-Span-371" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-372" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.092em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.386em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-38">X_{ij}</script> value for the co-occurrence pair, described
at length above</li>
</ol>

<p>We retain an intermediate “inner” cost (not squared or weighted) for
use in calculating the gradient in the next section.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># -- continued --</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">v_main</span><span class="p">,</span> <span class="n">v_context</span><span class="p">,</span> <span class="n">b_main</span><span class="p">,</span> <span class="n">b_context</span><span class="p">,</span> <span class="n">gradsq_W_main</span><span class="p">,</span>
         <span class="n">gradsq_W_context</span><span class="p">,</span> <span class="n">gradsq_b_main</span><span class="p">,</span> <span class="n">gradsq_b_context</span><span class="p">,</span>
         <span class="n">cooccurrence</span><span class="p">)</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>

        <span class="c"># Calculate weight function $f(X_{ij})$</span>
        <span class="n">weight</span> <span class="o">=</span> <span class="p">((</span><span class="n">cooccurrence</span> <span class="o">/</span> <span class="n">x_max</span><span class="p">)</span> <span class="o">**</span> <span class="n">alpha</span>
                  <span class="k">if</span> <span class="n">cooccurrence</span> <span class="o">&lt;</span> <span class="n">x_max</span> <span class="k">else</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c"># Compute inner component of cost function, which is used in</span>
        <span class="c"># both overall cost calculation and in gradient calculation</span>
        <span class="c">#</span>
        <span class="c">#   $$ J' = w_i^Tw_j + b_i + b_j - log(X_{ij}) $$</span>
        <span class="n">cost_inner</span> <span class="o">=</span> <span class="p">(</span><span class="n">v_main</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v_context</span><span class="p">)</span>
                      <span class="o">+</span> <span class="n">b_main</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">b_context</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                      <span class="o">-</span> <span class="n">log</span><span class="p">(</span><span class="n">cooccurrence</span><span class="p">))</span>

        <span class="c"># Compute cost</span>
        <span class="c">#</span>
        <span class="c">#   $$ J = f(X_{ij}) (J')^2 $$</span>
        <span class="n">cost</span> <span class="o">=</span> <span class="n">weight</span> <span class="o">*</span> <span class="p">(</span><span class="n">cost_inner</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

        <span class="c"># Add weighted cost to the global cost tracker</span>
        <span class="n">global_cost</span> <span class="o">+=</span> <span class="n">cost</span></code></pre></figure>

<p>With the cost calculated, we now need to compute gradients. From our
original cost function <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-373" style="width: 0.563em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.512em; height: 0px; font-size: 109%;"><span style="position: absolute; clip: rect(1.735em 1000.51em 2.704em -999.997em); top: -2.546em; left: 0em;"><span class="mrow" id="MathJax-Span-374"><span class="mi" id="MathJax-Span-375" style="font-family: STIXGeneral-Italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.551em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.053em; border-left: 0px solid; width: 0px; height: 0.836em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>J</mi></math></span></span><script type="math/tex" id="MathJax-Element-39">J</script> we derive gradients with respect to the
relevant parameters <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-40-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-376" style="width: 1.022em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px; font-size: 109%;"><span style="position: absolute; clip: rect(1.175em 1000.92em 2.398em -999.997em); top: -2.087em; left: 0em;"><span class="mrow" id="MathJax-Span-377"><span class="msubsup" id="MathJax-Span-378"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(3.061em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="texatom" id="MathJax-Span-379"><span class="mrow" id="MathJax-Span-380"><span class="munderover" id="MathJax-Span-381"><span style="display: inline-block; position: relative; width: 0.665em; height: 0px;"><span style="position: absolute; clip: rect(3.366em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-382" style="font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.973em; left: 0.104em;"><span style="height: 0em; vertical-align: 0em; width: 0.461em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-383" style="font-family: STIXGeneral-Regular;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.252em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.665em;"><span class="mi" id="MathJax-Span-384" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.092em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.219em; border-left: 0px solid; width: 0px; height: 1.114em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>w</mi><mo stretchy="false">→</mo></mover></mrow><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-40">\vec w_i</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-41-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-385" style="width: 1.022em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px; font-size: 109%;"><span style="position: absolute; clip: rect(1.175em 1000.92em 2.551em -999.997em); top: -2.087em; left: 0em;"><span class="mrow" id="MathJax-Span-386"><span class="msubsup" id="MathJax-Span-387"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(3.061em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="texatom" id="MathJax-Span-388"><span class="mrow" id="MathJax-Span-389"><span class="munderover" id="MathJax-Span-390"><span style="display: inline-block; position: relative; width: 0.665em; height: 0px;"><span style="position: absolute; clip: rect(3.366em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-391" style="font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.973em; left: 0.104em;"><span style="height: 0em; vertical-align: 0em; width: 0.461em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-392" style="font-family: STIXGeneral-Regular;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.252em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.665em;"><span class="mi" id="MathJax-Span-393" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.092em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.386em; border-left: 0px solid; width: 0px; height: 1.281em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>w</mi><mo stretchy="false">→</mo></mover></mrow><mi>j</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-41">\vec w_j</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-42-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-394" style="width: 0.869em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.767em; height: 0px; font-size: 109%;"><span style="position: absolute; clip: rect(1.277em 1000.77em 2.398em -999.997em); top: -2.087em; left: 0em;"><span class="mrow" id="MathJax-Span-395"><span class="msubsup" id="MathJax-Span-396"><span style="display: inline-block; position: relative; width: 0.767em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1000.46em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-397" style="font-family: STIXGeneral-Italic;">b</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.512em;"><span class="mi" id="MathJax-Span-398" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.092em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.219em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>b</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-42">b_i</script>, and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-43-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-399" style="width: 0.869em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.767em; height: 0px; font-size: 109%;"><span style="position: absolute; clip: rect(1.277em 1000.77em 2.551em -999.997em); top: -2.087em; left: 0em;"><span class="mrow" id="MathJax-Span-400"><span class="msubsup" id="MathJax-Span-401"><span style="display: inline-block; position: relative; width: 0.767em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1000.46em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-402" style="font-family: STIXGeneral-Italic;">b</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.512em;"><span class="mi" id="MathJax-Span-403" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.092em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.386em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>b</mi><mi>j</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-43">b_j</script>.
(Note that since <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-44-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-404" style="width: 2.398em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.194em; height: 0px; font-size: 109%;"><span style="position: absolute; clip: rect(1.735em 1002.14em 3.01em -999.997em); top: -2.546em; left: 0em;"><span class="mrow" id="MathJax-Span-405"><span class="mi" id="MathJax-Span-406" style="font-family: STIXGeneral-Italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.155em;"></span></span><span class="mo" id="MathJax-Span-407" style="font-family: STIXGeneral-Regular;">(</span><span class="msubsup" id="MathJax-Span-408"><span style="display: inline-block; position: relative; width: 1.073em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-409" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.614em;"><span class="texatom" id="MathJax-Span-410"><span class="mrow" id="MathJax-Span-411"><span class="mi" id="MathJax-Span-412" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-413" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="mo" id="MathJax-Span-414" style="font-family: STIXGeneral-Regular;">)</span></span><span style="display: inline-block; width: 0px; height: 2.551em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.386em; border-left: 0px solid; width: 0px; height: 1.169em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><msub><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-44">f(X_{ij})</script> doesn’t depend on any of these
parameters, the derivations are quite simple.) Below we use the operator
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-45-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x2299;&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-415" style="width: 0.869em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.767em; height: 0px; font-size: 109%;"><span style="position: absolute; clip: rect(1.837em 1000.72em 2.806em -999.997em); top: -2.546em; left: 0em;"><span class="mrow" id="MathJax-Span-416"><span class="mo" id="MathJax-Span-417" style="font-family: STIXGeneral-Regular;">⊙</span></span><span style="display: inline-block; width: 0px; height: 2.551em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.164em; border-left: 0px solid; width: 0px; height: 0.836em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>⊙</mo></math></span></span><script type="math/tex" id="MathJax-Element-45">\odot</script> to denote elementwise vector multiplication.</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-46-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left right left right left right left right left right left&quot; rowspacing=&quot;3pt&quot; columnspacing=&quot;0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em&quot; displaystyle=&quot;true&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;/munderover&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;/munderover&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2299;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2207;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2299;&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;J&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mrow&gt;&lt;msubsup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;/msubsup&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mi&gt;log&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-418" style="width: 22.887em; display: inline-block;"><span style="display: inline-block; position: relative; width: 21.002em; height: 0px; font-size: 109%;"><span style="position: absolute; clip: rect(-4.228em 1020.85em 7.903em -999.997em); top: -2.087em; left: 0em;"><span class="mrow" id="MathJax-Span-419"><span class="mtable" id="MathJax-Span-420" style="padding-right: 0.155em; padding-left: 0.155em;"><span style="display: inline-block; position: relative; width: 20.696em; height: 0px;"><span style="position: absolute; clip: rect(6.527em 1001.94em 17.536em -999.997em); top: -11.72em; left: 0em;"><span style="display: inline-block; position: relative; width: 1.939em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1000.51em 4.131em -999.997em); top: -8.407em; right: 0em;"><span class="mtd" id="MathJax-Span-421"><span class="mrow" id="MathJax-Span-422"><span class="mi" id="MathJax-Span-423" style="font-family: STIXGeneral-Italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(3.163em 1001.94em 4.488em -999.997em); top: -5.655em; right: 0em;"><span class="mtd" id="MathJax-Span-493"><span class="mrow" id="MathJax-Span-494"><span class="msubsup" id="MathJax-Span-495"><span style="display: inline-block; position: relative; width: 1.481em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-496" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.718em; left: 0.716em;"><span class="texatom" id="MathJax-Span-497"><span class="mrow" id="MathJax-Span-498"><span class="msubsup" id="MathJax-Span-499"><span style="display: inline-block; position: relative; width: 0.665em; height: 0px;"><span style="position: absolute; clip: rect(3.214em 1000.46em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="texatom" id="MathJax-Span-500"><span class="mrow" id="MathJax-Span-501"><span class="munderover" id="MathJax-Span-502"><span style="display: inline-block; position: relative; width: 0.461em; height: 0px;"><span style="position: absolute; clip: rect(3.519em 1000.46em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-503" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -4.024em; left: 0.104em;"><span style="height: 0em; vertical-align: 0em; width: 0.308em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-504" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.15em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.461em;"><span class="mi" id="MathJax-Span-505" style="font-size: 50%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="mi" id="MathJax-Span-506" style="font-family: STIXGeneral-Italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(3.163em 1001.94em 4.59em -999.997em); top: -3.922em; right: 0em;"><span class="mtd" id="MathJax-Span-565"><span class="mrow" id="MathJax-Span-566"><span class="msubsup" id="MathJax-Span-567"><span style="display: inline-block; position: relative; width: 1.481em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-568" style="font-family: STIXGeneral-Regular;">∇</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.718em; left: 0.716em;"><span class="texatom" id="MathJax-Span-569"><span class="mrow" id="MathJax-Span-570"><span class="msubsup" id="MathJax-Span-571"><span style="display: inline-block; position: relative; width: 0.665em; height: 0px;"><span style="position: absolute; clip: rect(3.214em 1000.46em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="texatom" id="MathJax-Span-572"><span class="mrow" id="MathJax-Span-573"><span class="munderover" id="MathJax-Span-574"><span style="display: inline-block; position: relative; width: 0.461em; height: 0px;"><span style="position: absolute; clip: rect(3.519em 1000.46em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-575" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -4.024em; left: 0.104em;"><span style="height: 0em; vertical-align: 0em; width: 0.308em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-576" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.15em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.871em; left: 0.461em;"><span class="mi" id="MathJax-Span-577" style="font-size: 50%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="mi" id="MathJax-Span-578" style="font-family: STIXGeneral-Italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(2.5em 1001.58em 4.997em -999.997em); top: -1.832em; right: 0em;"><span class="mtd" id="MathJax-Span-637"><span class="mrow" id="MathJax-Span-638"><span class="mfrac" id="MathJax-Span-639"><span style="display: inline-block; position: relative; width: 1.379em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.163em 1000.97em 4.131em -999.997em); top: -4.636em; left: 50%; margin-left: -0.456em;"><span class="mrow" id="MathJax-Span-640"><span class="mi" id="MathJax-Span-641" style="font-family: STIXGeneral-Regular;">∂</span><span class="mi" id="MathJax-Span-642" style="font-family: STIXGeneral-Italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(3.163em 1001.23em 4.284em -999.997em); top: -3.31em; left: 50%; margin-left: -0.609em;"><span class="mrow" id="MathJax-Span-643"><span class="mi" id="MathJax-Span-644" style="font-family: STIXGeneral-Regular;">∂</span><span class="msubsup" id="MathJax-Span-645"><span style="display: inline-block; position: relative; width: 0.767em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1000.46em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-646" style="font-family: STIXGeneral-Italic;">b</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.512em;"><span class="mi" id="MathJax-Span-647" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(0.869em 1001.38em 1.226em -999.997em); top: -1.272em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.379em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.073em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(2.5em 1001.58em 5.099em -999.997em); top: 0.716em; right: 0em;"><span class="mtd" id="MathJax-Span-698"><span class="mrow" id="MathJax-Span-699"><span class="mfrac" id="MathJax-Span-700"><span style="display: inline-block; position: relative; width: 1.379em; height: 0px; margin-right: 0.104em; margin-left: 0.104em;"><span style="position: absolute; clip: rect(3.163em 1000.97em 4.131em -999.997em); top: -4.636em; left: 50%; margin-left: -0.456em;"><span class="mrow" id="MathJax-Span-701"><span class="mi" id="MathJax-Span-702" style="font-family: STIXGeneral-Regular;">∂</span><span class="mi" id="MathJax-Span-703" style="font-family: STIXGeneral-Italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(3.163em 1001.23em 4.437em -999.997em); top: -3.31em; left: 50%; margin-left: -0.609em;"><span class="mrow" id="MathJax-Span-704"><span class="mi" id="MathJax-Span-705" style="font-family: STIXGeneral-Regular;">∂</span><span class="msubsup" id="MathJax-Span-706"><span style="display: inline-block; position: relative; width: 0.767em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1000.46em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-707" style="font-family: STIXGeneral-Italic;">b</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.512em;"><span class="mi" id="MathJax-Span-708" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(0.869em 1001.38em 1.226em -999.997em); top: -1.272em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.379em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.073em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span><span style="display: inline-block; width: 0px; height: 11.725em;"></span></span><span style="position: absolute; clip: rect(5.966em 1018.76em 17.536em -999.997em); top: -12.281em; left: 1.939em;"><span style="display: inline-block; position: relative; width: 18.759em; height: 0px;"><span style="position: absolute; clip: rect(2.245em 1018.76em 5.711em -999.997em); top: -8.611em; left: 0em;"><span class="mtd" id="MathJax-Span-424"><span class="mrow" id="MathJax-Span-425"><span class="mi" id="MathJax-Span-426"></span><span class="mo" id="MathJax-Span-427" style="font-family: STIXGeneral-Regular; padding-left: 0.308em;">=</span><span class="munderover" id="MathJax-Span-428" style="padding-left: 0.308em;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; clip: rect(2.857em 1001.23em 4.59em -999.997em); top: -3.973em; left: 0em;"><span class="mo" id="MathJax-Span-429" style="font-family: STIXSizeOneSym; vertical-align: -0.507em;">∑</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(3.366em 1000.97em 4.233em -999.997em); top: -2.801em; left: 0.155em;"><span class="texatom" id="MathJax-Span-430"><span class="mrow" id="MathJax-Span-431"><span class="mi" id="MathJax-Span-432" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mo" id="MathJax-Span-433" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-434" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(3.265em 1000.51em 4.131em -999.997em); top: -5.196em; left: 0.41em;"><span class="mi" id="MathJax-Span-435" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="munderover" id="MathJax-Span-436" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 1.277em; height: 0px;"><span style="position: absolute; clip: rect(2.857em 1001.23em 4.59em -999.997em); top: -3.973em; left: 0em;"><span class="mo" id="MathJax-Span-437" style="font-family: STIXSizeOneSym; vertical-align: -0.507em;">∑</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(3.366em 1000.97em 4.386em -999.997em); top: -2.801em; left: 0.155em;"><span class="texatom" id="MathJax-Span-438"><span class="mrow" id="MathJax-Span-439"><span class="mi" id="MathJax-Span-440" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-441" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-442" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(3.265em 1000.51em 4.131em -999.997em); top: -5.196em; left: 0.41em;"><span class="mi" id="MathJax-Span-443" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="mspace" id="MathJax-Span-444" style="height: 0em; vertical-align: 0em; width: 0.308em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-445" style="font-family: STIXGeneral-Italic; padding-left: 0.206em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.155em;"></span></span><span class="mrow" id="MathJax-Span-446" style="padding-left: 0.206em;"><span class="mo" id="MathJax-Span-447" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">(</span></span><span class="msubsup" id="MathJax-Span-448"><span style="display: inline-block; position: relative; width: 1.073em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-449" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.614em;"><span class="texatom" id="MathJax-Span-450"><span class="mrow" id="MathJax-Span-451"><span class="mi" id="MathJax-Span-452" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-453" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="mo" id="MathJax-Span-454" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">)</span></span></span><span class="msubsup" id="MathJax-Span-455" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 11.318em; height: 0px;"><span style="position: absolute; clip: rect(2.857em 1010.71em 4.539em -999.997em); top: -3.973em; left: 0em;"><span class="mrow" id="MathJax-Span-456"><span class="mo" id="MathJax-Span-457" style="vertical-align: -0.252em;"><span><span style="font-size: 110%; font-family: STIXSizeOneSym;">(</span></span></span><span class="mrow" id="MathJax-Span-458"><span class="msubsup" id="MathJax-Span-459"><span style="display: inline-block; position: relative; width: 1.175em; height: 0px;"><span style="position: absolute; clip: rect(3.061em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="texatom" id="MathJax-Span-460"><span class="mrow" id="MathJax-Span-461"><span class="munderover" id="MathJax-Span-462"><span style="display: inline-block; position: relative; width: 0.665em; height: 0px;"><span style="position: absolute; clip: rect(3.366em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-463" style="font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.973em; left: 0.104em;"><span style="height: 0em; vertical-align: 0em; width: 0.461em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-464" style="font-family: STIXGeneral-Regular;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.252em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(3.366em 1000.51em 4.131em -999.997em); top: -4.483em; left: 0.665em;"><span class="mi" id="MathJax-Span-465" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(3.366em 1000.26em 4.131em -999.997em); top: -3.718em; left: 0.665em;"><span class="mi" id="MathJax-Span-466" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-467"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(3.061em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="texatom" id="MathJax-Span-468"><span class="mrow" id="MathJax-Span-469"><span class="munderover" id="MathJax-Span-470"><span style="display: inline-block; position: relative; width: 0.665em; height: 0px;"><span style="position: absolute; clip: rect(3.366em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-471" style="font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.973em; left: 0.104em;"><span style="height: 0em; vertical-align: 0em; width: 0.461em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-472" style="font-family: STIXGeneral-Regular;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.252em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.665em;"><span class="mi" id="MathJax-Span-473" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="mo" id="MathJax-Span-474" style="font-family: STIXGeneral-Regular; padding-left: 0.257em;">+</span><span class="msubsup" id="MathJax-Span-475" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 0.767em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1000.46em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-476" style="font-family: STIXGeneral-Italic;">b</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.512em;"><span class="mi" id="MathJax-Span-477" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="mo" id="MathJax-Span-478" style="font-family: STIXGeneral-Regular; padding-left: 0.257em;">+</span><span class="msubsup" id="MathJax-Span-479" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 0.767em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1000.46em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-480" style="font-family: STIXGeneral-Italic;">b</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.512em;"><span class="mi" id="MathJax-Span-481" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="mo" id="MathJax-Span-482" style="font-family: STIXGeneral-Regular; padding-left: 0.257em;">−</span><span class="mi" id="MathJax-Span-483" style="font-family: STIXGeneral-Regular; padding-left: 0.257em;">log</span><span class="mo" id="MathJax-Span-484"></span><span class="msubsup" id="MathJax-Span-485" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 1.073em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-486" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.614em;"><span class="texatom" id="MathJax-Span-487"><span class="mrow" id="MathJax-Span-488"><span class="mi" id="MathJax-Span-489" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-490" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-491" style="vertical-align: -0.252em;"><span><span style="font-size: 110%; font-family: STIXSizeOneSym;">)</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -4.687em; left: 10.859em;"><span class="mn" id="MathJax-Span-492" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.182em;"></span></span><span style="position: absolute; clip: rect(2.857em 1017.08em 4.539em -999.997em); top: -5.655em; left: 0em;"><span class="mtd" id="MathJax-Span-507"><span class="mrow" id="MathJax-Span-508"><span class="mi" id="MathJax-Span-509"></span><span class="mo" id="MathJax-Span-510" style="font-family: STIXGeneral-Regular; padding-left: 0.308em;">=</span><span class="mi" id="MathJax-Span-511" style="font-family: STIXGeneral-Italic; padding-left: 0.308em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.155em;"></span></span><span class="mrow" id="MathJax-Span-512" style="padding-left: 0.206em;"><span class="mo" id="MathJax-Span-513" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">(</span></span><span class="msubsup" id="MathJax-Span-514"><span style="display: inline-block; position: relative; width: 1.073em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-515" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.614em;"><span class="texatom" id="MathJax-Span-516"><span class="mrow" id="MathJax-Span-517"><span class="mi" id="MathJax-Span-518" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-519" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="mo" id="MathJax-Span-520" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">)</span></span></span><span class="msubsup" id="MathJax-Span-521" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(3.061em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="texatom" id="MathJax-Span-522"><span class="mrow" id="MathJax-Span-523"><span class="munderover" id="MathJax-Span-524"><span style="display: inline-block; position: relative; width: 0.665em; height: 0px;"><span style="position: absolute; clip: rect(3.366em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-525" style="font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.973em; left: 0.104em;"><span style="height: 0em; vertical-align: 0em; width: 0.461em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-526" style="font-family: STIXGeneral-Regular;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.252em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.665em;"><span class="mi" id="MathJax-Span-527" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="mo" id="MathJax-Span-528" style="font-family: STIXGeneral-Regular; padding-left: 0.257em;">⊙</span><span class="mrow" id="MathJax-Span-529" style="padding-left: 0.257em;"><span class="mo" id="MathJax-Span-530" style="vertical-align: -0.252em;"><span><span style="font-size: 110%; font-family: STIXSizeOneSym;">(</span></span></span><span class="mrow" id="MathJax-Span-531"><span class="msubsup" id="MathJax-Span-532"><span style="display: inline-block; position: relative; width: 1.175em; height: 0px;"><span style="position: absolute; clip: rect(3.061em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="texatom" id="MathJax-Span-533"><span class="mrow" id="MathJax-Span-534"><span class="munderover" id="MathJax-Span-535"><span style="display: inline-block; position: relative; width: 0.665em; height: 0px;"><span style="position: absolute; clip: rect(3.366em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-536" style="font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.973em; left: 0.104em;"><span style="height: 0em; vertical-align: 0em; width: 0.461em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-537" style="font-family: STIXGeneral-Regular;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.252em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(3.366em 1000.51em 4.131em -999.997em); top: -4.483em; left: 0.665em;"><span class="mi" id="MathJax-Span-538" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(3.366em 1000.26em 4.131em -999.997em); top: -3.718em; left: 0.665em;"><span class="mi" id="MathJax-Span-539" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-540"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(3.061em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="texatom" id="MathJax-Span-541"><span class="mrow" id="MathJax-Span-542"><span class="munderover" id="MathJax-Span-543"><span style="display: inline-block; position: relative; width: 0.665em; height: 0px;"><span style="position: absolute; clip: rect(3.366em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-544" style="font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.973em; left: 0.104em;"><span style="height: 0em; vertical-align: 0em; width: 0.461em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-545" style="font-family: STIXGeneral-Regular;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.252em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.665em;"><span class="mi" id="MathJax-Span-546" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="mo" id="MathJax-Span-547" style="font-family: STIXGeneral-Regular; padding-left: 0.257em;">+</span><span class="msubsup" id="MathJax-Span-548" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 0.767em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1000.46em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-549" style="font-family: STIXGeneral-Italic;">b</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.512em;"><span class="mi" id="MathJax-Span-550" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="mo" id="MathJax-Span-551" style="font-family: STIXGeneral-Regular; padding-left: 0.257em;">+</span><span class="msubsup" id="MathJax-Span-552" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 0.767em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1000.46em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-553" style="font-family: STIXGeneral-Italic;">b</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.512em;"><span class="mi" id="MathJax-Span-554" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="mo" id="MathJax-Span-555" style="font-family: STIXGeneral-Regular; padding-left: 0.257em;">−</span><span class="mi" id="MathJax-Span-556" style="font-family: STIXGeneral-Regular; padding-left: 0.257em;">log</span><span class="mo" id="MathJax-Span-557"></span><span class="msubsup" id="MathJax-Span-558" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 1.073em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-559" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.614em;"><span class="texatom" id="MathJax-Span-560"><span class="mrow" id="MathJax-Span-561"><span class="mi" id="MathJax-Span-562" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-563" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-564" style="vertical-align: -0.252em;"><span><span style="font-size: 110%; font-family: STIXSizeOneSym;">)</span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(2.857em 1017.08em 4.539em -999.997em); top: -3.922em; left: 0em;"><span class="mtd" id="MathJax-Span-579"><span class="mrow" id="MathJax-Span-580"><span class="mi" id="MathJax-Span-581"></span><span class="mo" id="MathJax-Span-582" style="font-family: STIXGeneral-Regular; padding-left: 0.308em;">=</span><span class="mi" id="MathJax-Span-583" style="font-family: STIXGeneral-Italic; padding-left: 0.308em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.155em;"></span></span><span class="mrow" id="MathJax-Span-584" style="padding-left: 0.206em;"><span class="mo" id="MathJax-Span-585" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">(</span></span><span class="msubsup" id="MathJax-Span-586"><span style="display: inline-block; position: relative; width: 1.073em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-587" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.614em;"><span class="texatom" id="MathJax-Span-588"><span class="mrow" id="MathJax-Span-589"><span class="mi" id="MathJax-Span-590" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-591" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="mo" id="MathJax-Span-592" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">)</span></span></span><span class="msubsup" id="MathJax-Span-593" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(3.061em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="texatom" id="MathJax-Span-594"><span class="mrow" id="MathJax-Span-595"><span class="munderover" id="MathJax-Span-596"><span style="display: inline-block; position: relative; width: 0.665em; height: 0px;"><span style="position: absolute; clip: rect(3.366em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-597" style="font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.973em; left: 0.104em;"><span style="height: 0em; vertical-align: 0em; width: 0.461em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-598" style="font-family: STIXGeneral-Regular;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.252em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.665em;"><span class="mi" id="MathJax-Span-599" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="mo" id="MathJax-Span-600" style="font-family: STIXGeneral-Regular; padding-left: 0.257em;">⊙</span><span class="mrow" id="MathJax-Span-601" style="padding-left: 0.257em;"><span class="mo" id="MathJax-Span-602" style="vertical-align: -0.252em;"><span><span style="font-size: 110%; font-family: STIXSizeOneSym;">(</span></span></span><span class="mrow" id="MathJax-Span-603"><span class="msubsup" id="MathJax-Span-604"><span style="display: inline-block; position: relative; width: 1.175em; height: 0px;"><span style="position: absolute; clip: rect(3.061em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="texatom" id="MathJax-Span-605"><span class="mrow" id="MathJax-Span-606"><span class="munderover" id="MathJax-Span-607"><span style="display: inline-block; position: relative; width: 0.665em; height: 0px;"><span style="position: absolute; clip: rect(3.366em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-608" style="font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.973em; left: 0.104em;"><span style="height: 0em; vertical-align: 0em; width: 0.461em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-609" style="font-family: STIXGeneral-Regular;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.252em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(3.366em 1000.51em 4.131em -999.997em); top: -4.483em; left: 0.665em;"><span class="mi" id="MathJax-Span-610" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(3.366em 1000.26em 4.131em -999.997em); top: -3.718em; left: 0.665em;"><span class="mi" id="MathJax-Span-611" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-612"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(3.061em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="texatom" id="MathJax-Span-613"><span class="mrow" id="MathJax-Span-614"><span class="munderover" id="MathJax-Span-615"><span style="display: inline-block; position: relative; width: 0.665em; height: 0px;"><span style="position: absolute; clip: rect(3.366em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-616" style="font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.973em; left: 0.104em;"><span style="height: 0em; vertical-align: 0em; width: 0.461em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-617" style="font-family: STIXGeneral-Regular;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.252em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.665em;"><span class="mi" id="MathJax-Span-618" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="mo" id="MathJax-Span-619" style="font-family: STIXGeneral-Regular; padding-left: 0.257em;">+</span><span class="msubsup" id="MathJax-Span-620" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 0.767em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1000.46em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-621" style="font-family: STIXGeneral-Italic;">b</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.512em;"><span class="mi" id="MathJax-Span-622" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="mo" id="MathJax-Span-623" style="font-family: STIXGeneral-Regular; padding-left: 0.257em;">+</span><span class="msubsup" id="MathJax-Span-624" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 0.767em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1000.46em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-625" style="font-family: STIXGeneral-Italic;">b</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.512em;"><span class="mi" id="MathJax-Span-626" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="mo" id="MathJax-Span-627" style="font-family: STIXGeneral-Regular; padding-left: 0.257em;">−</span><span class="mi" id="MathJax-Span-628" style="font-family: STIXGeneral-Regular; padding-left: 0.257em;">log</span><span class="mo" id="MathJax-Span-629"></span><span class="msubsup" id="MathJax-Span-630" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 1.073em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-631" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.614em;"><span class="texatom" id="MathJax-Span-632"><span class="mrow" id="MathJax-Span-633"><span class="mi" id="MathJax-Span-634" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-635" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-636" style="vertical-align: -0.252em;"><span><span style="font-size: 110%; font-family: STIXSizeOneSym;">)</span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(2.857em 1014.88em 4.539em -999.997em); top: -1.832em; left: 0em;"><span class="mtd" id="MathJax-Span-648"><span class="mrow" id="MathJax-Span-649"><span class="mi" id="MathJax-Span-650"></span><span class="mo" id="MathJax-Span-651" style="font-family: STIXGeneral-Regular; padding-left: 0.308em;">=</span><span class="mi" id="MathJax-Span-652" style="font-family: STIXGeneral-Italic; padding-left: 0.308em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.155em;"></span></span><span class="mrow" id="MathJax-Span-653" style="padding-left: 0.206em;"><span class="mo" id="MathJax-Span-654" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">(</span></span><span class="msubsup" id="MathJax-Span-655"><span style="display: inline-block; position: relative; width: 1.073em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-656" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.614em;"><span class="texatom" id="MathJax-Span-657"><span class="mrow" id="MathJax-Span-658"><span class="mi" id="MathJax-Span-659" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-660" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="mo" id="MathJax-Span-661" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">)</span></span></span><span class="mrow" id="MathJax-Span-662" style="padding-left: 0.206em;"><span class="mo" id="MathJax-Span-663" style="vertical-align: -0.252em;"><span><span style="font-size: 110%; font-family: STIXSizeOneSym;">(</span></span></span><span class="mrow" id="MathJax-Span-664"><span class="msubsup" id="MathJax-Span-665"><span style="display: inline-block; position: relative; width: 1.175em; height: 0px;"><span style="position: absolute; clip: rect(3.061em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="texatom" id="MathJax-Span-666"><span class="mrow" id="MathJax-Span-667"><span class="munderover" id="MathJax-Span-668"><span style="display: inline-block; position: relative; width: 0.665em; height: 0px;"><span style="position: absolute; clip: rect(3.366em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-669" style="font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.973em; left: 0.104em;"><span style="height: 0em; vertical-align: 0em; width: 0.461em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-670" style="font-family: STIXGeneral-Regular;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.252em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(3.366em 1000.51em 4.131em -999.997em); top: -4.483em; left: 0.665em;"><span class="mi" id="MathJax-Span-671" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(3.366em 1000.26em 4.131em -999.997em); top: -3.718em; left: 0.665em;"><span class="mi" id="MathJax-Span-672" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-673"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(3.061em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="texatom" id="MathJax-Span-674"><span class="mrow" id="MathJax-Span-675"><span class="munderover" id="MathJax-Span-676"><span style="display: inline-block; position: relative; width: 0.665em; height: 0px;"><span style="position: absolute; clip: rect(3.366em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-677" style="font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.973em; left: 0.104em;"><span style="height: 0em; vertical-align: 0em; width: 0.461em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-678" style="font-family: STIXGeneral-Regular;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.252em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.665em;"><span class="mi" id="MathJax-Span-679" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="mo" id="MathJax-Span-680" style="font-family: STIXGeneral-Regular; padding-left: 0.257em;">+</span><span class="msubsup" id="MathJax-Span-681" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 0.767em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1000.46em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-682" style="font-family: STIXGeneral-Italic;">b</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.512em;"><span class="mi" id="MathJax-Span-683" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="mo" id="MathJax-Span-684" style="font-family: STIXGeneral-Regular; padding-left: 0.257em;">+</span><span class="msubsup" id="MathJax-Span-685" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 0.767em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1000.46em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-686" style="font-family: STIXGeneral-Italic;">b</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.512em;"><span class="mi" id="MathJax-Span-687" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="mo" id="MathJax-Span-688" style="font-family: STIXGeneral-Regular; padding-left: 0.257em;">−</span><span class="mi" id="MathJax-Span-689" style="font-family: STIXGeneral-Regular; padding-left: 0.257em;">log</span><span class="mo" id="MathJax-Span-690"></span><span class="msubsup" id="MathJax-Span-691" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 1.073em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-692" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.614em;"><span class="texatom" id="MathJax-Span-693"><span class="mrow" id="MathJax-Span-694"><span class="mi" id="MathJax-Span-695" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-696" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-697" style="vertical-align: -0.252em;"><span><span style="font-size: 110%; font-family: STIXSizeOneSym;">)</span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(2.857em 1014.88em 4.539em -999.997em); top: 0.716em; left: 0em;"><span class="mtd" id="MathJax-Span-709"><span class="mrow" id="MathJax-Span-710"><span class="mi" id="MathJax-Span-711"></span><span class="mo" id="MathJax-Span-712" style="font-family: STIXGeneral-Regular; padding-left: 0.308em;">=</span><span class="mi" id="MathJax-Span-713" style="font-family: STIXGeneral-Italic; padding-left: 0.308em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.155em;"></span></span><span class="mrow" id="MathJax-Span-714" style="padding-left: 0.206em;"><span class="mo" id="MathJax-Span-715" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">(</span></span><span class="msubsup" id="MathJax-Span-716"><span style="display: inline-block; position: relative; width: 1.073em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-717" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.614em;"><span class="texatom" id="MathJax-Span-718"><span class="mrow" id="MathJax-Span-719"><span class="mi" id="MathJax-Span-720" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-721" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="mo" id="MathJax-Span-722" style="vertical-align: -0.201em;"><span style="font-family: STIXSizeOneSym;">)</span></span></span><span class="mrow" id="MathJax-Span-723" style="padding-left: 0.206em;"><span class="mo" id="MathJax-Span-724" style="vertical-align: -0.252em;"><span><span style="font-size: 110%; font-family: STIXSizeOneSym;">(</span></span></span><span class="mrow" id="MathJax-Span-725"><span class="msubsup" id="MathJax-Span-726"><span style="display: inline-block; position: relative; width: 1.175em; height: 0px;"><span style="position: absolute; clip: rect(3.061em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="texatom" id="MathJax-Span-727"><span class="mrow" id="MathJax-Span-728"><span class="munderover" id="MathJax-Span-729"><span style="display: inline-block; position: relative; width: 0.665em; height: 0px;"><span style="position: absolute; clip: rect(3.366em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-730" style="font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.973em; left: 0.104em;"><span style="height: 0em; vertical-align: 0em; width: 0.461em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-731" style="font-family: STIXGeneral-Regular;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.252em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(3.366em 1000.51em 4.131em -999.997em); top: -4.483em; left: 0.665em;"><span class="mi" id="MathJax-Span-732" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; clip: rect(3.366em 1000.26em 4.131em -999.997em); top: -3.718em; left: 0.665em;"><span class="mi" id="MathJax-Span-733" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-734"><span style="display: inline-block; position: relative; width: 0.92em; height: 0px;"><span style="position: absolute; clip: rect(3.061em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="texatom" id="MathJax-Span-735"><span class="mrow" id="MathJax-Span-736"><span class="munderover" id="MathJax-Span-737"><span style="display: inline-block; position: relative; width: 0.665em; height: 0px;"><span style="position: absolute; clip: rect(3.366em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-738" style="font-family: STIXGeneral-Italic;">w</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.973em; left: 0.104em;"><span style="height: 0em; vertical-align: 0em; width: 0.461em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-739" style="font-family: STIXGeneral-Regular;">⃗&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.252em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.665em;"><span class="mi" id="MathJax-Span-740" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="mo" id="MathJax-Span-741" style="font-family: STIXGeneral-Regular; padding-left: 0.257em;">+</span><span class="msubsup" id="MathJax-Span-742" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 0.767em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1000.46em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-743" style="font-family: STIXGeneral-Italic;">b</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.512em;"><span class="mi" id="MathJax-Span-744" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="mo" id="MathJax-Span-745" style="font-family: STIXGeneral-Regular; padding-left: 0.257em;">+</span><span class="msubsup" id="MathJax-Span-746" style="padding-left: 0.257em;"><span style="display: inline-block; position: relative; width: 0.767em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1000.46em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-747" style="font-family: STIXGeneral-Italic;">b</span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.512em;"><span class="mi" id="MathJax-Span-748" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span><span class="mo" id="MathJax-Span-749" style="font-family: STIXGeneral-Regular; padding-left: 0.257em;">−</span><span class="mi" id="MathJax-Span-750" style="font-family: STIXGeneral-Regular; padding-left: 0.257em;">log</span><span class="mo" id="MathJax-Span-751"></span><span class="msubsup" id="MathJax-Span-752" style="padding-left: 0.206em;"><span style="display: inline-block; position: relative; width: 1.073em; height: 0px;"><span style="position: absolute; clip: rect(3.163em 1000.66em 4.131em -999.997em); top: -3.973em; left: 0em;"><span class="mi" id="MathJax-Span-753" style="font-family: STIXGeneral-Italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.054em;"></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span><span style="position: absolute; top: -3.82em; left: 0.614em;"><span class="texatom" id="MathJax-Span-754"><span class="mrow" id="MathJax-Span-755"><span class="mi" id="MathJax-Span-756" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span><span class="mi" id="MathJax-Span-757" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">j<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-758" style="vertical-align: -0.252em;"><span><span style="font-size: 110%; font-family: STIXSizeOneSym;">)</span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.978em;"></span></span></span><span style="display: inline-block; width: 0px; height: 12.286em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.092em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -6.219em; border-left: 0px solid; width: 0px; height: 13.003em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left right left right left right left right left right left" rowspacing="3pt" columnspacing="0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em" displaystyle="true"><mtr><mtd><mi>J</mi></mtd><mtd><mi></mi><mo>=</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>V</mi></munderover><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>V</mi></munderover><mspace width="thickmathspace"></mspace><mi>f</mi><mrow><mo>(</mo><msub><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mo>)</mo></mrow><msup><mrow><mo>(</mo><mrow><msubsup><mrow class="MJX-TeXAtom-ORD"><mover><mi>w</mi><mo stretchy="false">→</mo></mover></mrow><mi>i</mi><mi>T</mi></msubsup><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>w</mi><mo stretchy="false">→</mo></mover></mrow><mi>j</mi></msub><mo>+</mo><msub><mi>b</mi><mi>i</mi></msub><mo>+</mo><msub><mi>b</mi><mi>j</mi></msub><mo>−</mo><mi>log</mi><mo>⁡</mo><msub><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub></mrow><mo>)</mo></mrow><mn>2</mn></msup></mtd></mtr><mtr><mtd><msub><mi mathvariant="normal">∇</mi><mrow class="MJX-TeXAtom-ORD"><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>w</mi><mo stretchy="false">→</mo></mover></mrow><mi>i</mi></msub></mrow></msub><mi>J</mi></mtd><mtd><mi></mi><mo>=</mo><mi>f</mi><mrow><mo>(</mo><msub><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mo>)</mo></mrow><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>w</mi><mo stretchy="false">→</mo></mover></mrow><mi>j</mi></msub><mo>⊙</mo><mrow><mo>(</mo><mrow><msubsup><mrow class="MJX-TeXAtom-ORD"><mover><mi>w</mi><mo stretchy="false">→</mo></mover></mrow><mi>i</mi><mi>T</mi></msubsup><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>w</mi><mo stretchy="false">→</mo></mover></mrow><mi>j</mi></msub><mo>+</mo><msub><mi>b</mi><mi>i</mi></msub><mo>+</mo><msub><mi>b</mi><mi>j</mi></msub><mo>−</mo><mi>log</mi><mo>⁡</mo><msub><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub></mrow><mo>)</mo></mrow></mtd></mtr><mtr><mtd><msub><mi mathvariant="normal">∇</mi><mrow class="MJX-TeXAtom-ORD"><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>w</mi><mo stretchy="false">→</mo></mover></mrow><mi>j</mi></msub></mrow></msub><mi>J</mi></mtd><mtd><mi></mi><mo>=</mo><mi>f</mi><mrow><mo>(</mo><msub><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mo>)</mo></mrow><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>w</mi><mo stretchy="false">→</mo></mover></mrow><mi>i</mi></msub><mo>⊙</mo><mrow><mo>(</mo><mrow><msubsup><mrow class="MJX-TeXAtom-ORD"><mover><mi>w</mi><mo stretchy="false">→</mo></mover></mrow><mi>i</mi><mi>T</mi></msubsup><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>w</mi><mo stretchy="false">→</mo></mover></mrow><mi>j</mi></msub><mo>+</mo><msub><mi>b</mi><mi>i</mi></msub><mo>+</mo><msub><mi>b</mi><mi>j</mi></msub><mo>−</mo><mi>log</mi><mo>⁡</mo><msub><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub></mrow><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>J</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>b</mi><mi>i</mi></msub></mrow></mfrac></mtd><mtd><mi></mi><mo>=</mo><mi>f</mi><mrow><mo>(</mo><msub><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mo>)</mo></mrow><mrow><mo>(</mo><mrow><msubsup><mrow class="MJX-TeXAtom-ORD"><mover><mi>w</mi><mo stretchy="false">→</mo></mover></mrow><mi>i</mi><mi>T</mi></msubsup><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>w</mi><mo stretchy="false">→</mo></mover></mrow><mi>j</mi></msub><mo>+</mo><msub><mi>b</mi><mi>i</mi></msub><mo>+</mo><msub><mi>b</mi><mi>j</mi></msub><mo>−</mo><mi>log</mi><mo>⁡</mo><msub><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub></mrow><mo>)</mo></mrow></mtd></mtr><mtr><mtd><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>J</mi></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>b</mi><mi>j</mi></msub></mrow></mfrac></mtd><mtd><mi></mi><mo>=</mo><mi>f</mi><mrow><mo>(</mo><msub><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mo>)</mo></mrow><mrow><mo>(</mo><mrow><msubsup><mrow class="MJX-TeXAtom-ORD"><mover><mi>w</mi><mo stretchy="false">→</mo></mover></mrow><mi>i</mi><mi>T</mi></msubsup><msub><mrow class="MJX-TeXAtom-ORD"><mover><mi>w</mi><mo stretchy="false">→</mo></mover></mrow><mi>j</mi></msub><mo>+</mo><msub><mi>b</mi><mi>i</mi></msub><mo>+</mo><msub><mi>b</mi><mi>j</mi></msub><mo>−</mo><mi>log</mi><mo>⁡</mo><msub><mi>X</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub></mrow><mo>)</mo></mrow></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-46">\begin{align*}J &= \sum_{i=1}^V \sum_{j=1}^V \; f\left(X_{ij}\right) \left( \vec{w}_i^T \vec{w}_j + b_i + b_j - \log X_{ij} \right)^2 \\ \nabla_{\vec{w}_i} J &= f\left(X_{ij}\right) \vec{w}_j \odot \left( \vec{w}_i^T \vec{w}_j + b_i + b_j - \log X_{ij}\right) \\ \nabla_{\vec{w}_j} J &= f\left(X_{ij}\right) \vec{w}_i \odot \left( \vec{w}_i^T \vec{w}_j + b_i + b_j - \log X_{ij}\right) \\ \frac{\partial J}{\partial b_i} &= f\left(X_{ij}\right) \left(\vec w_i^T \vec w_j + b_i + b_j - \log X_{ij}\right) \\ \frac{\partial J}{\partial b_j} &= f\left(X_{ij}\right) \left(\vec w_i^T \vec w_j + b_i + b_j - \log X_{ij}\right) \end{align*} </script></p>

<p>Now let’s put that in code! We use the earlier-calculated intermediate
value <code class="highlighter-rouge">cost_inner</code>, which stores the value being squared and weighted in
the full cost function.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># -- continued --</span>
        <span class="c"># Compute gradients for word vector terms.</span>
        <span class="c">#</span>
        <span class="c"># NB: `v_main` is only a view into `W` (not a copy), so our</span>
        <span class="c"># modifications here will affect the global weight matrix;</span>
        <span class="c"># likewise for v_context, biases, etc.</span>
        <span class="n">grad_main</span> <span class="o">=</span> <span class="n">weight</span> <span class="o">*</span> <span class="n">cost_inner</span> <span class="o">*</span> <span class="n">v_context</span>
        <span class="n">grad_context</span> <span class="o">=</span> <span class="n">weight</span> <span class="o">*</span> <span class="n">cost_inner</span> <span class="o">*</span> <span class="n">v_main</span>

        <span class="c"># Compute gradients for bias terms</span>
        <span class="n">grad_bias_main</span> <span class="o">=</span> <span class="n">weight</span> <span class="o">*</span> <span class="n">cost_inner</span>
        <span class="n">grad_bias_context</span> <span class="o">=</span> <span class="n">weight</span> <span class="o">*</span> <span class="n">cost_inner</span></code></pre></figure>

<p>Finally, we update weights with AdaGrad<sup id="fnref:7:2"><a href="http://www.foldl.me/2014/glove-python/#fn:7" class="footnote" data-hasqtip="8">7</a></sup> and add the calculated
gradients to the gradient history variables.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># -- continued --</span>
        <span class="c"># Now perform adaptive updates</span>
        <span class="n">v_main</span> <span class="o">-=</span> <span class="p">(</span><span class="n">learning_rate</span> <span class="o">*</span> <span class="n">grad_main</span>
                   <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">gradsq_W_main</span><span class="p">))</span>
        <span class="n">v_context</span> <span class="o">-=</span> <span class="p">(</span><span class="n">learning_rate</span> <span class="o">*</span> <span class="n">grad_context</span>
                      <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">gradsq_W_context</span><span class="p">))</span>

        <span class="n">b_main</span> <span class="o">-=</span> <span class="p">(</span><span class="n">learning_rate</span> <span class="o">*</span> <span class="n">grad_bias_main</span>
                   <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">gradsq_b_main</span><span class="p">))</span>
        <span class="n">b_context</span> <span class="o">-=</span> <span class="p">(</span><span class="n">learning_rate</span> <span class="o">*</span> <span class="n">grad_bias_context</span>
                      <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">gradsq_b_context</span><span class="p">))</span>

        <span class="c"># Update squared gradient sums</span>
        <span class="n">gradsq_W_main</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">grad_main</span><span class="p">)</span>
        <span class="n">gradsq_W_context</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">grad_context</span><span class="p">)</span>
        <span class="n">gradsq_b_main</span> <span class="o">+=</span> <span class="n">grad_bias_main</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="n">gradsq_b_context</span> <span class="o">+=</span> <span class="n">grad_bias_context</span> <span class="o">**</span> <span class="mi">2</span></code></pre></figure>

<p>After we’ve processed all data for the iteration, we return the global cost and relax for a while.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># -- continued --</span>
    <span class="k">return</span> <span class="n">global_cost</span></code></pre></figure>

<hr>

<p>That’s it for code! If you’d like to see word vectors produced by this Python
code in action, check out <a href="http://nbviewer.ipython.org/github/hans/glove.py/blob/master/demo/glove.py%20exploration.ipynb">this IPython notebook</a>.</p>

<p>If you found this all fascinating, I highly recommend digging into the
<a href="http://www-nlp.stanford.edu/projects/glove/">official GloVe documentation</a>, especially the <a href="http://www-nlp.stanford.edu/projects/glove/glove.pdf">original paper</a>, which is
due to be published at <a href="http://emnlp2014.org/">this year’s EMNLP conference</a>. A quality general
coverage of word representations and their uses is Peter Turney and Patrick
Pantel’s paper,
<a href="http://www.aaai.org/Papers/JAIR/Vol37/JAIR-3705.pdf">“From frequency to meaning: Vector space models of semantics.”</a></p>

<p>Distributed word representations such as those which GloVe produces are really
revolutionizing natural language processing. I’m excited to see what happens as
more and more tools of this sort are disseminated outside of academia and put to
real-world use.</p>

<p>If you’re making use of GloVe or similar tools in your own projects, let me
know. Until next time, happy coding!</p>

<script type="text/javascript" src="./A GloVe implementation in Python - foldl_files/MathJax.js"></script>

<script type="text/javascript">
MathJax.Hub.Config({TeX: { equationNumbers: { autoNumber: "AMS" } } });
</script>

<div class="footnotes">
  <ol>
    <li id="fn:1">
      <p>Richard Socher et al., <a href="http://www.aclweb.org/anthology/P13-1045">“Parsing with Compositional Vector Grammars,”</a> in <em>Proceedings of the 51st Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers)</em> (Sofia, Bulgaria: Association for Computational Linguistics, 2013), 455–65.&nbsp;<a href="http://www.foldl.me/2014/glove-python/#fnref:1" class="reversefootnote">↩</a></p>
    </li>
    <li id="fn:2">
      <p>Joseph Turian, Lev Ratinov, and Yoshua Bengio, <a href="http://www.aclweb.org/anthology/P10-1040">“Word Representations: A Simple and General Method for Semi-Supervised Learning,”</a> in <em>Proceedings of the 48th Annual Meeting of the Association for Computational Linguistics</em> (Association for Computational Linguistics, 2010), 384–94.&nbsp;<a href="http://www.foldl.me/2014/glove-python/#fnref:2" class="reversefootnote">↩</a></p>
    </li>
    <li id="fn:3">
      <p>Dzmitry Bahdanau, Kyunghyun Cho, and Yoshua Bengio, <a href="http://arxiv.org/abs/1409.0473.">“Neural Machine Translation by Jointly Learning to Align and Translate,”</a> <em>arXiv:1409.0473 [cs, Stat]</em>, September 1, 2014.<br><br>This is what I’m working on right now—if this sounds interesting to you, get in touch!&nbsp;<a href="http://www.foldl.me/2014/glove-python/#fnref:3" class="reversefootnote">↩</a></p>
    </li>
    <li id="fn:4">
      <p>There is still quite a bit of debate, however, over the best way to construct these vectors. The popular tool <a href="https://code.google.com/p/word2vec/"><code class="highlighter-rouge">word2vec</code></a>, which has seen wide use and wide success in the past year, builds so-called <em>neural</em> word embeddings, whereas GloVe and others construct word vectors based on <em>counts</em>. I won’t get into the controversy in this post, but feel free to read up and pick a side.<br><br>See e.g. Marco Baroni, Georgiana Dinu, and Germán Kruszewski, <a href="http://www.aclweb.org/anthology/P14-1023">“Don’t Count, Predict! A Systematic Comparison of Context-Counting vs. Context-Predicting Semantic Vectors,”</a> in <em>Proceedings of the 52nd Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers)</em> (Baltimore, Maryland: Association for Computational Linguistics, 2014), 238–47; Omer Levy and Yoav Goldberg, <a href="http://www.aclweb.org/anthology/W14-1618">“Linguistic Regularities in Sparse and Explicit Word Representations,”</a> in <em>Proceedings of the Eighteenth Conference on Computational Natural Language Learning</em> (Ann Arbor, Michigan: Association for Computational Linguistics, 2014), 171–80.&nbsp;<a href="http://www.foldl.me/2014/glove-python/#fnref:4" class="reversefootnote">↩</a></p>
    </li>
    <li id="fn:5">
      <p>I hope this post is a useful supplement to the <a href="http://www-nlp.stanford.edu/projects/glove/glove.pdf">original paper</a>. If you have the time, read the original too — it has a lot of useful and well-stated insights about the task of word representations in general.&nbsp;<a href="http://www.foldl.me/2014/glove-python/#fnref:5" class="reversefootnote">↩</a></p>
    </li>
    <li id="fn:6">
      <p>I am skipping over a lot of interesting / beautiful details here — please read the paper if you are interested in more than the implementation!&nbsp;<a href="http://www.foldl.me/2014/glove-python/#fnref:6" class="reversefootnote">↩</a></p>
    </li>
    <li id="fn:7">
      <p>AdaGrad is a modified form of stochastic gradient descent which attempts to guide learning in the proper direction by weighting rarely occurring features more often than those that always fire. Briefly, for a gradient component <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-47-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-759" style="width: 1.264em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.15em; height: 0px; font-size: 109%;"><span style="position: absolute; clip: rect(1.436em 1001.15em 2.468em -999.997em); top: -2.061em; left: 0em;"><span class="mrow" id="MathJax-Span-760"><span class="msubsup" id="MathJax-Span-761"><span style="display: inline-block; position: relative; width: 1.15em; height: 0px;"><span style="position: absolute; clip: rect(3.386em 1000.46em 4.418em -999.997em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-762" style="font-family: STIXGeneral-Italic;">g</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.519em;"><span class="texatom" id="MathJax-Span-763"><span class="mrow" id="MathJax-Span-764"><span class="mi" id="MathJax-Span-765" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-766" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-767" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.067em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>,</mo><mi>i</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-47">g_{t,i}</script> at training step <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-48-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-768" style="width: 0.347em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.29em; height: 0px; font-size: 109%;"><span style="position: absolute; clip: rect(1.723em 1000.29em 2.64em -999.997em); top: -2.463em; left: 0em;"><span class="mrow" id="MathJax-Span-769"><span class="mi" id="MathJax-Span-770" style="font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.468em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.753em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-48">t</script>, AdaGrad defines the gradient descent update to be <span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-49-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;mi&gt;&amp;#x03B7;&lt;/mi&gt;&lt;msqrt&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msubsup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msubsup&gt;&lt;/msqrt&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;msub&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-771" style="width: 13.248em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.159em; height: 0px; font-size: 109%;"><span style="position: absolute; clip: rect(1.15em 1012.1em 4.475em -999.997em); top: -2.463em; left: 0em;"><span class="mrow" id="MathJax-Span-772"><span class="msubsup" id="MathJax-Span-773"><span style="display: inline-block; position: relative; width: 1.952em; height: 0px;"><span style="position: absolute; clip: rect(3.386em 1000.46em 4.189em -999.997em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-774" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.462em;"><span class="texatom" id="MathJax-Span-775"><span class="mrow" id="MathJax-Span-776"><span class="mi" id="MathJax-Span-777" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-778" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">+</span><span class="mn" id="MathJax-Span-779" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span><span class="mo" id="MathJax-Span-780" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-781" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-782" style="font-family: STIXGeneral-Regular; padding-left: 0.29em;">=</span><span class="msubsup" id="MathJax-Span-783" style="padding-left: 0.29em;"><span style="display: inline-block; position: relative; width: 1.092em; height: 0px;"><span style="position: absolute; clip: rect(3.386em 1000.46em 4.189em -999.997em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-784" style="font-family: STIXGeneral-Italic;">x<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.462em;"><span class="texatom" id="MathJax-Span-785"><span class="mrow" id="MathJax-Span-786"><span class="mi" id="MathJax-Span-787" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-788" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-789" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-790" style="font-family: STIXGeneral-Regular; padding-left: 0.232em;">−</span><span class="mstyle" id="MathJax-Span-791" style="padding-left: 0.232em;"><span class="mrow" id="MathJax-Span-792"><span class="mfrac" id="MathJax-Span-793"><span style="display: inline-block; position: relative; width: 5.106em; height: 0px; margin-right: 0.118em; margin-left: 0.118em;"><span style="position: absolute; clip: rect(3.386em 1000.46em 4.418em -999.997em); top: -4.699em; left: 50%; margin-left: -0.226em;"><span class="mi" id="MathJax-Span-794" style="font-family: STIXGeneral-Italic;">η</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(2.64em 1004.99em 4.819em -999.997em); top: -2.807em; left: 50%; margin-left: -2.52em;"><span class="msqrt" id="MathJax-Span-795"><span style="display: inline-block; position: relative; width: 4.991em; height: 0px;"><span style="position: absolute; clip: rect(2.87em 1003.9em 4.59em -999.997em); top: -4.011em; left: 1.035em;"><span class="mrow" id="MathJax-Span-796"><span class="munderover" id="MathJax-Span-797"><span style="display: inline-block; position: relative; width: 2.296em; height: 0px;"><span style="position: absolute; clip: rect(3.099em 1000.86em 4.475em -999.997em); top: -4.011em; left: 0em;"><span class="mo" id="MathJax-Span-798" style="font-family: STIXGeneral-Regular; vertical-align: 0.003em;">∑</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.386em 1001.15em 4.303em -999.997em); top: -4.527em; left: 0.92em;"><span class="texatom" id="MathJax-Span-799"><span class="mrow" id="MathJax-Span-800"><span class="mi" id="MathJax-Span-801" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-802" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">−</span><span class="mn" id="MathJax-Span-803" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.386em 1001.38em 4.189em -999.997em); top: -3.724em; left: 0.92em;"><span class="texatom" id="MathJax-Span-804"><span class="mrow" id="MathJax-Span-805"><span class="msup" id="MathJax-Span-806"><span style="display: inline-block; position: relative; width: 0.462em; height: 0px;"><span style="position: absolute; clip: rect(3.443em 1000.23em 4.189em -999.997em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-807" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.24em; left: 0.29em;"><span class="mo" id="MathJax-Span-808" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-809" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">=</span><span class="mn" id="MathJax-Span-810" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-811" style="padding-left: 0.175em;"><span style="display: inline-block; position: relative; width: 1.436em; height: 0px;"><span style="position: absolute; clip: rect(3.386em 1000.46em 4.418em -999.997em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-812" style="font-family: STIXGeneral-Italic;">g</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.386em 1000.4em 4.189em -999.997em); top: -4.355em; left: 0.519em;"><span class="mn" id="MathJax-Span-813" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">2</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.386em 1000.92em 4.303em -999.997em); top: -3.667em; left: 0.519em;"><span class="texatom" id="MathJax-Span-814"><span class="mrow" id="MathJax-Span-815"><span class="msup" id="MathJax-Span-816"><span style="display: inline-block; position: relative; width: 0.462em; height: 0px;"><span style="position: absolute; clip: rect(3.443em 1000.23em 4.189em -999.997em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-817" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -4.24em; left: 0.29em;"><span class="mo" id="MathJax-Span-818" style="font-size: 50%; font-family: STIXVariants;">′</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-819" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-820" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(3.042em 1003.96em 3.443em -999.997em); top: -4.355em; left: 1.035em;"><span style="display: inline-block; position: relative; width: 3.959em; height: 0px;"><span style="position: absolute; font-family: STIXGeneral-Regular; top: -4.011em; left: 0em;">‾<span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; font-family: STIXGeneral-Regular; top: -4.011em; left: 3.443em;">‾<span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -4.011em; left: 0.404em;">‾<span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -4.011em; left: 0.863em;">‾<span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -4.011em; left: 1.264em;">‾<span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -4.011em; left: 1.723em;">‾<span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -4.011em; left: 2.124em;">‾<span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -4.011em; left: 2.583em;">‾<span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="font-family: STIXGeneral-Regular; position: absolute; top: -4.011em; left: 3.042em;">‾<span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(2.296em 1001.09em 4.475em -999.997em); top: -3.667em; left: 0em;"><span style="font-family: STIXSizeOneSym;">√</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; clip: rect(0.863em 1005.11em 1.264em -999.997em); top: -1.316em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 5.106em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.092em;"></span></span></span></span></span></span><span class="msubsup" id="MathJax-Span-821"><span style="display: inline-block; position: relative; width: 1.15em; height: 0px;"><span style="position: absolute; clip: rect(3.386em 1000.46em 4.418em -999.997em); top: -4.011em; left: 0em;"><span class="mi" id="MathJax-Span-822" style="font-family: STIXGeneral-Italic;">g</span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span><span style="position: absolute; top: -3.839em; left: 0.519em;"><span class="texatom" id="MathJax-Span-823"><span class="mrow" id="MathJax-Span-824"><span class="mi" id="MathJax-Span-825" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-826" style="font-size: 70.7%; font-family: STIXGeneral-Regular;">,</span><span class="mi" id="MathJax-Span-827" style="font-size: 70.7%; font-family: STIXGeneral-Italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 4.017em;"></span></span></span></span><span class="mo" id="MathJax-Span-828" style="font-family: STIXGeneral-Regular;">.</span></span><span style="display: inline-block; width: 0px; height: 2.468em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.059em; border-left: 0px solid; width: 0px; height: 3.378em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>i</mi></mrow></msub><mo>=</mo><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>,</mo><mi>i</mi></mrow></msub><mo>−</mo><mstyle displaystyle="true" scriptlevel="0"><mfrac><mi>η</mi><msqrt><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>−</mo><mn>1</mn></mrow></munderover><msubsup><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><msup><mi>t</mi><mo>′</mo></msup><mo>,</mo><mi>i</mi></mrow><mn>2</mn></msubsup></msqrt></mfrac></mstyle><msub><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>,</mo><mi>i</mi></mrow></msub><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-49">x_{t+1, i} = x_{t, i} - \dfrac{\eta}{\sqrt{\sum_{t'=1}^{t-1} g_{t', i}^2}} g_{t, i}.</script> For a more thorough coverage see <a href="http://www.ark.cs.cmu.edu/cdyer/adagrad.pdf">this AdaGrad tutorial</a>.&nbsp;<a href="http://www.foldl.me/2014/glove-python/#fnref:7" class="reversefootnote">↩</a>&nbsp;<a href="http://www.foldl.me/2014/glove-python/#fnref:7:1" class="reversefootnote">↩<sup>2</sup></a>&nbsp;<a href="http://www.foldl.me/2014/glove-python/#fnref:7:2" class="reversefootnote">↩<sup>3</sup></a></p>
    </li>
  </ol>
</div>

  </div>
</article>


<div id="related">
  <h2>Related Posts</h2>
  <ul class="posts">
    
    
    
    
    <li><span>23 Feb 2017</span> » <a href="http://www.foldl.me/2017/bridging-principles/">Bridging principles</a></li>
    
    
    
    
  </ul>
</div>


<div id="disqus_thread"><iframe id="dsq-app1" name="dsq-app1" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" width="100%" src="./A GloVe implementation in Python - foldl_files/saved_resource.html" style="width: 1px !important; min-width: 100% !important; border: none !important; overflow: hidden !important; height: 2581px !important;" horizontalscrolling="no" verticalscrolling="no"></iframe></div>
<script type="text/javascript">
  var disqusLoaded = false;
  window.onscroll = function() {
    if ( disqusLoaded ) return;

    disqusLoaded = true;
    window.onscroll = null;

    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = 'http://foldl.disqus.com/embed.js';
    document.body.appendChild(dsq);
  };
</script>
<noscript>Please enable JavaScript to view the &lt;a href="http://disqus.com/?ref_noscript"&gt;comments powered by Disqus.&lt;/a&gt;</noscript>


      <footer>
          <div id="hcard-Jon-Gauthier" class="vcard">
          <a class="email fn n" href="mailto:jon@gauthiers.net">
              <span class="given-name">Jon</span>
              <span class="family-name">Gauthier</span>
          </a> — <span class="adr">
              <span class="locality">Stanford</span>, <span class="region">California</span>
          </span>
          </div>
      </footer>
    </section>
  </div>

  <script type="text/javascript" src="./A GloVe implementation in Python - foldl_files/jquery-1.8.3.min.js"></script>
  <script type="text/javascript" src="./A GloVe implementation in Python - foldl_files/jquery.qtip.min.js"></script>
  <script type="text/javascript" src="./A GloVe implementation in Python - foldl_files/script.js"></script>
  <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-33380670-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
  </script>


<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: STIXSizeOneSym, sans-serif;"></div></div><script type="text/javascript" async="" src="./A GloVe implementation in Python - foldl_files/embed.js"></script><iframe style="display: none;" src="./A GloVe implementation in Python - foldl_files/saved_resource(1).html"></iframe></body></html>