<!DOCTYPE html>
<!-- saved from url=(0368)https://disqus.com/embed/comments/?base=default&f=philipperemy-github-io-1&t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&s_o=default#version=d952d33e35a1c499438fbdfafc2ef715 -->
<html lang="en" dir="ltr" class="js no-touch localstorage sessionstorage contenteditable use-opacity-transitions"><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Disqus Comments</title>

    
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <style>
        .alert--warning {
            border-radius: 3px;
            padding: 10px 15px;
            margin-bottom: 10px;
            background-color: #FFE070;
            color: #A47703;
        }

        .alert--warning a,
        .alert--warning a:hover,
        .alert--warning strong {
            color: #A47703;
            font-weight: bold;
        }

        .alert--error p,
        .alert--warning p {
            margin-top: 5px;
            margin-bottom: 5px;
        }
        
        </style>
    
    <style>
        html {
            overflow: hidden;
        }

        #error {
            display: none;
        }

        .clearfix:after {
            content: "";
            display: block;
            height: 0;
            clear: both;
            visibility: hidden;
        }

        
    </style>

<script src="./cb=gapi.loaded_0" async=""></script><script crossorigin="anonymous" id="bootstrap-script" data-app="lounge" src="./lounge.load.d952d33e35a1c499438fbdfafc2ef715.js"></script><meta http-equiv="Content-Security-Policy" content="script-src https:;"><link rel="stylesheet" href="./lounge.5f04e83cf97ee6a6cf16dc8e296ed78d.css"><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="lounge/main" src="./lounge.bundle.987c6346e2effb8e4f350d48ecf53d13.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="remote/config" src="./config.js"></script><style id="css_1493010964005"></style><!--<base target="_parent">--><base href="." target="_parent"><link rel="stylesheet" href="./discovery.ec9371c4ef39ecee074c2acf24d5e0e2.css"><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="ga" src="./ga.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="discovery/main" src="./discovery.bundle.6aa8d068ba5176f85f980f898293fefa.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="fb" src="./sdk.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="gapi" src="./api.js" gapi_processed="true"></script><style type="text/css">.fb_hidden{position:absolute;top:-10000px;z-index:10001}.fb_reposition{overflow:hidden;position:relative}.fb_invisible{display:none}.fb_reset{background:none;border:0;border-spacing:0;color:#000;cursor:auto;direction:ltr;font-family:"lucida grande", tahoma, verdana, arial, sans-serif;font-size:11px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:1;margin:0;overflow:visible;padding:0;text-align:left;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;visibility:visible;white-space:normal;word-spacing:normal}.fb_reset>div{overflow:hidden}.fb_link img{border:none}@keyframes fb_transform{from{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}.fb_animate{animation:fb_transform .3s forwards}
.fb_dialog{background:rgba(82, 82, 82, .7);position:absolute;top:-10000px;z-index:10001}.fb_reset .fb_dialog_legacy{overflow:visible}.fb_dialog_advanced{padding:10px;-moz-border-radius:8px;-webkit-border-radius:8px;border-radius:8px}.fb_dialog_content{background:#fff;color:#333}.fb_dialog_close_icon{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 0 transparent;cursor:pointer;display:block;height:15px;position:absolute;right:18px;top:17px;width:15px}.fb_dialog_mobile .fb_dialog_close_icon{top:5px;left:5px;right:auto}.fb_dialog_padding{background-color:transparent;position:absolute;width:1px;z-index:-1}.fb_dialog_close_icon:hover{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -15px transparent}.fb_dialog_close_icon:active{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -30px transparent}.fb_dialog_loader{background-color:#f6f7f9;border:1px solid #606060;font-size:24px;padding:20px}.fb_dialog_top_left,.fb_dialog_top_right,.fb_dialog_bottom_left,.fb_dialog_bottom_right{height:10px;width:10px;overflow:hidden;position:absolute}.fb_dialog_top_left{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 0;left:-10px;top:-10px}.fb_dialog_top_right{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -10px;right:-10px;top:-10px}.fb_dialog_bottom_left{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -20px;bottom:-10px;left:-10px}.fb_dialog_bottom_right{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -30px;right:-10px;bottom:-10px}.fb_dialog_vert_left,.fb_dialog_vert_right,.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{position:absolute;background:#525252;filter:alpha(opacity=70);opacity:.7}.fb_dialog_vert_left,.fb_dialog_vert_right{width:10px;height:100%}.fb_dialog_vert_left{margin-left:-10px}.fb_dialog_vert_right{right:0;margin-right:-10px}.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{width:100%;height:10px}.fb_dialog_horiz_top{margin-top:-10px}.fb_dialog_horiz_bottom{bottom:0;margin-bottom:-10px}.fb_dialog_iframe{line-height:0}.fb_dialog_content .dialog_title{background:#6d84b4;border:1px solid #365899;color:#fff;font-size:14px;font-weight:bold;margin:0}.fb_dialog_content .dialog_title>span{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yd/r/Cou7n-nqK52.gif) no-repeat 5px 50%;float:left;padding:5px 0 7px 26px}body.fb_hidden{-webkit-transform:none;height:100%;margin:0;overflow:visible;position:absolute;top:-10000px;left:0;width:100%}.fb_dialog.fb_dialog_mobile.loading{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ya/r/3rhSv5V8j3o.gif) white no-repeat 50% 50%;min-height:100%;min-width:100%;overflow:hidden;position:absolute;top:0;z-index:10001}.fb_dialog.fb_dialog_mobile.loading.centered{width:auto;height:auto;min-height:initial;min-width:initial;background:none}.fb_dialog.fb_dialog_mobile.loading.centered #fb_dialog_loader_spinner{width:100%}.fb_dialog.fb_dialog_mobile.loading.centered .fb_dialog_content{background:none}.loading.centered #fb_dialog_loader_close{color:#fff;display:block;padding-top:20px;clear:both;font-size:18px}#fb-root #fb_dialog_ipad_overlay{background:rgba(0, 0, 0, .45);position:absolute;bottom:0;left:0;right:0;top:0;width:100%;min-height:100%;z-index:10000}#fb-root #fb_dialog_ipad_overlay.hidden{display:none}.fb_dialog.fb_dialog_mobile.loading iframe{visibility:hidden}.fb_dialog_content .dialog_header{-webkit-box-shadow:white 0 1px 1px -1px inset;background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#738ABA), to(#2C4987));border-bottom:1px solid;border-color:#1d4088;color:#fff;font:14px Helvetica, sans-serif;font-weight:bold;text-overflow:ellipsis;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0;vertical-align:middle;white-space:nowrap}.fb_dialog_content .dialog_header table{-webkit-font-smoothing:subpixel-antialiased;height:43px;width:100%}.fb_dialog_content .dialog_header td.header_left{font-size:12px;padding-left:5px;vertical-align:middle;width:60px}.fb_dialog_content .dialog_header td.header_right{font-size:12px;padding-right:5px;vertical-align:middle;width:60px}.fb_dialog_content .touchable_button{background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#4966A6), color-stop(.5, #355492), to(#2A4887));border:1px solid #29487d;-webkit-background-clip:padding-box;-webkit-border-radius:3px;-webkit-box-shadow:rgba(0, 0, 0, .117188) 0 1px 1px inset, rgba(255, 255, 255, .167969) 0 1px 0;display:inline-block;margin-top:3px;max-width:85px;line-height:18px;padding:4px 12px;position:relative}.fb_dialog_content .dialog_header .touchable_button input{border:none;background:none;color:#fff;font:12px Helvetica, sans-serif;font-weight:bold;margin:2px -12px;padding:2px 6px 3px 6px;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog_content .dialog_header .header_center{color:#fff;font-size:16px;font-weight:bold;line-height:18px;text-align:center;vertical-align:middle}.fb_dialog_content .dialog_content{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/y9/r/jKEcVPZFk-2.gif) no-repeat 50% 50%;border:1px solid #555;border-bottom:0;border-top:0;height:150px}.fb_dialog_content .dialog_footer{background:#f6f7f9;border:1px solid #555;border-top-color:#ccc;height:40px}#fb_dialog_loader_close{float:left}.fb_dialog.fb_dialog_mobile .fb_dialog_close_button{text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog.fb_dialog_mobile .fb_dialog_close_icon{visibility:hidden}#fb_dialog_loader_spinner{animation:rotateSpinner 1.2s linear infinite;background-color:transparent;background-image:url(https://static.xx.fbcdn.net/rsrc.php/v3/yD/r/t-wz8gw1xG1.png);background-repeat:no-repeat;background-position:50% 50%;height:24px;width:24px}@keyframes rotateSpinner{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
.fb_iframe_widget{display:inline-block;position:relative}.fb_iframe_widget span{display:inline-block;position:relative;text-align:justify}.fb_iframe_widget iframe{position:absolute}.fb_iframe_widget_fluid_desktop,.fb_iframe_widget_fluid_desktop span,.fb_iframe_widget_fluid_desktop iframe{max-width:100%}.fb_iframe_widget_fluid_desktop iframe{min-width:220px;position:relative}.fb_iframe_widget_lift{z-index:1}.fb_hide_iframes iframe{position:relative;left:-10000px}.fb_iframe_widget_loader{position:relative;display:inline-block}.fb_iframe_widget_fluid{display:inline}.fb_iframe_widget_fluid span{width:100%}.fb_iframe_widget_loader iframe{min-height:32px;z-index:2;zoom:1}.fb_iframe_widget_loader .FB_Loader{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/y9/r/jKEcVPZFk-2.gif) no-repeat;height:32px;width:32px;margin-left:-16px;position:absolute;left:50%;z-index:4}</style></head>
<body>
    

    
    <div id="error" class="alert--error">
        <p>We were unable to load Disqus. If you are a moderator please see our <a href="https://docs.disqus.com/help/83/"> troubleshooting guide</a>. </p>
    </div>

    
    <script type="text/json" id="disqus-forumData">{"session":{"canModerate":false,"audienceSyncVerified":false,"mustVerify":false,"canReply":true,"mustVerifyEmail":false},"features":{},"forum":{"raw_guidelines":null,"twitterName":null,"guidelines":null,"favicon":{"permalink":"https://disqus.com/api/forums/favicons/philipperemy-github-io-1.jpg","cache":"//a.disquscdn.com/1492794604/images/favicon-default.png"},"disableDisqusBranding":false,"id":"philipperemy-github-io-1","createdAt":"2016-07-29T23:44:51.300997","category":null,"founder":"216811848","daysAlive":0,"installCompleted":true,"pk":"4457424","channel":null,"description":null,"raw_description":null,"permissions":{},"name":"philipperemy.github.io","language":"en","settings":{"supportLevel":0,"adsDRNativeEnabled":false,"colorScheme":"auto","adsVideoEnabled":false,"adsProductVideoEnabled":false,"adsPositionTopEnabled":false,"ssoRequired":false,"unapproveLinks":false,"adsEnabled":false,"adsProductLinksThumbnailsEnabled":false,"adsProductStoriesEnabled":false,"organicDiscoveryEnabled":true,"allowMedia":true,"disable3rdPartyTrackers":false,"adsProductDisplayEnabled":false,"discoveryMax":false,"discoveryLocked":false,"moderatorText":"","linkAffiliationEnabled":true,"allowAnonPost":false,"hasCustomAvatar":false,"adultContent":false,"promotedDiscoveryEnabled":false,"allowAnonVotes":false,"mustVerify":true,"adsSettingsLocked":false,"mustVerifyEmail":true,"audienceSyncEnabled":false,"typeface":"auto","adsPositionBottomEnabled":false,"mediaembedEnabled":true,"adsProductLinksEnabled":false,"validateAllPosts":false,"discoveryThumbnailsEnabled":false,"isVIP":false,"adsPositionInthreadEnabled":false},"organizationId":3321630,"url":null,"daysThreadAlive":0,"avatar":{"small":{"permalink":"https://disqus.com/api/forums/avatars/philipperemy-github-io-1.jpg?size=32","cache":"//a.disquscdn.com/1492794604/images/noavatar32.png"},"large":{"permalink":"https://disqus.com/api/forums/avatars/philipperemy-github-io-1.jpg?size=92","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png"}},"signedUrl":null}}</script>

    
    <script type="text/json" id="disqus-threadData">{"cursor":{"hasPrev":false,"prev":null,"total":44,"hasNext":false,"next":"1:0:0"},"code":0,"response":{"lastModified":1491769531,"posts":[{"dislikes":0,"numReports":0,"likes":1,"message":"\u003cp>Hi and thanks for your code.\u003cbr>I was checking the code that you have posted on github , on this same post, and I noticed that in your code, after compiling the model , you are using the \u003ca href=\"http://disq.us/url?url=http%3A%2F%2Fmodel.fit%3ArJseB4AYXEcVEh6fgSVDQvbOdyI&amp;cuid=4457424\" rel=\"nofollow noopener\">model.fit\u003c/a>() [line 95] and after that comes the model.train_on_batch\u003c/p>\u003cp>why have you used the fit method before training on batch loops ?\u003c/p>","id":"3169631450","isHighlighted":false,"author":{"username":"arashmoaddel","about":"","name":"Arash Moaddel","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.233698,"profileUrl":"https://disqus.com/by/arashmoaddel/","url":"","reputation":1.233698,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2017-01-24T12:20:32","id":"239868829","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/arashmoaddel.jpg","cache":"https://c.disquscdn.com/uploads/users/23986/8829/avatar32.jpg?1492336292"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/arashmoaddel.jpg","cache":"https://c.disquscdn.com/uploads/users/23986/8829/avatar92.jpg?1492336292","large":{"permalink":"https://disqus.com/api/users/avatars/arashmoaddel.jpg","cache":"https://c.disquscdn.com/uploads/users/23986/8829/avatar92.jpg?1492336292"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-02-22T19:29:19","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Hi and thanks for your code.\nI was checking the code that you have posted on github , on this same post, and I noticed that in your code, after compiling the model , you are using the model.fit() [line 95] and after that comes the model.train_on_batch \n\nwhy have you used the fit method before training on batch loops ?","canVote":false,"thread":"5028095624","forum":"philipperemy-github-io-1","depth":0,"points":1,"moderationLabels":["links"],"isEdited":true},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Those are in two different IF blocks. They will never get executed at the same time. Either fit() or train_on_batch() depending on the condition.\u003c/p>\u003cp>UPDATE: My mistake. I call fit() one time but it does not change anything!\u003c/p>\u003cp>Thanks!\u003c/p>","id":"3204627037","isHighlighted":false,"author":{"username":"philippe_r_my","about":"","name":"Philippe R\u00e9my","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.215689,"profileUrl":"https://disqus.com/by/philippe_r_my/","url":"","reputation":1.215689,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2016-01-21T04:58:41","id":"192968483","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar32.jpg?1490436954"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar92.jpg?1490436954","large":{"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar92.jpg?1490436954"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-03-15T01:12:36","parent":3169631450,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Those are in two different IF blocks. They will never get executed at the same time. Either fit() or train_on_batch() depending on the condition.\n\nUPDATE: My mistake. I call fit() one time but it does not change anything!\n\nThanks!","canVote":false,"thread":"5028095624","forum":"philipperemy-github-io-1","depth":1,"points":0,"moderationLabels":[],"isEdited":true},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>I was wondering the same thing. There are two calls to fit made which are in both the if and else block.  On line 82 we enter the else block. On line 95 fit is called. In lines 102 through 112, which are in the same else block, train_on_batch is called. Possibly just some test code that was forgotten to delete?\u003c/p>","id":"3213370086","isHighlighted":false,"author":{"username":"disqus_06pu6MQ5jY","about":"","name":"Lucas Thompson","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.232591,"profileUrl":"https://disqus.com/by/disqus_06pu6MQ5jY/","url":"","reputation":1.232591,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2017-03-20T15:03:09","id":"246143979","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_06pu6MQ5jY.jpg","cache":"https://c.disquscdn.com/uploads/users/24614/3979/avatar32.jpg?1490022313"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/disqus_06pu6MQ5jY.jpg","cache":"https://c.disquscdn.com/uploads/users/24614/3979/avatar92.jpg?1490022313","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_06pu6MQ5jY.jpg","cache":"https://c.disquscdn.com/uploads/users/24614/3979/avatar92.jpg?1490022313"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-03-20T15:05:11","parent":3204627037,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"I was wondering the same thing. There are two calls to fit made which are in both the if and else block.  On line 82 we enter the else block. On line 95 fit is called. In lines 102 through 112, which are in the same else block, train_on_batch is called. Possibly just some test code that was forgotten to delete?","canVote":false,"thread":"5028095624","forum":"philipperemy-github-io-1","depth":2,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Yes \u003ca data-dsq-mention=\"disqus_06pu6mq5jy:disqus\" href=\"https://disqus.com/by/disqus_06pu6MQ5jY/\" rel=\"nofollow noopener\">Lucas Thompson\u003c/a>  , It doesn't seem to have any effects on train_on_bacth part. So I guess it can be deleted, although they are not in two different 'if' blocks \u003ca data-dsq-mention=\"philippe_r_my:disqus\" href=\"https://disqus.com/by/philippe_r_my/\" rel=\"nofollow noopener\">Philippe R\u00e9my\u003c/a>\u003c/p>","id":"3214782564","isHighlighted":false,"author":{"username":"arashmoaddel","about":"","name":"Arash Moaddel","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.233698,"profileUrl":"https://disqus.com/by/arashmoaddel/","url":"","reputation":1.233698,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2017-01-24T12:20:32","id":"239868829","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/arashmoaddel.jpg","cache":"https://c.disquscdn.com/uploads/users/23986/8829/avatar32.jpg?1492336292"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/arashmoaddel.jpg","cache":"https://c.disquscdn.com/uploads/users/23986/8829/avatar92.jpg?1492336292","large":{"permalink":"https://disqus.com/api/users/avatars/arashmoaddel.jpg","cache":"https://c.disquscdn.com/uploads/users/23986/8829/avatar92.jpg?1492336292"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-03-21T10:45:59","parent":3213370086,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Yes @disqus_06pu6MQ5jY:disqus  , It doesn't seem to have any effects on train_on_bacth part. So I guess it can be deleted, although they are not in two different 'if' blocks @philippe_r_my:disqus","canVote":false,"thread":"5028095624","forum":"philipperemy-github-io-1","depth":3,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Yes actually you guys are right. I made a mistake by calling the fit() function everywhere (bad copy paste!). However, it does not change anything!\u003c/p>","id":"3222692239","isHighlighted":false,"author":{"username":"philippe_r_my","about":"","name":"Philippe R\u00e9my","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.215689,"profileUrl":"https://disqus.com/by/philippe_r_my/","url":"","reputation":1.215689,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2016-01-21T04:58:41","id":"192968483","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar32.jpg?1490436954"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar92.jpg?1490436954","large":{"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar92.jpg?1490436954"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-03-25T09:45:52","parent":3214782564,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Yes actually you guys are right. I made a mistake by calling the fit() function everywhere (bad copy paste!). However, it does not change anything!","canVote":false,"thread":"5028095624","forum":"philipperemy-github-io-1","depth":4,"points":0,"moderationLabels":[],"isEdited":true},{"dislikes":0,"numReports":0,"likes":1,"message":"\u003cp>Really interesting! Thank you for sharing all that. I was really expecting the sub-sampling method with a stateful model to work better than that. However I think I still do not grasp totally the reason of that. How different is the input data from the LSTM's perspective when you sub sample or not? Is it related to the way the gradient is computed (after each sequence? after each batch?). If you don't mind giving your opinion on that, I'd highly appreciate!\u003c/p>","id":"2813184029","isHighlighted":false,"author":{"username":"disqus_frKmsVnJGG","about":"","name":"RS","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.232222,"profileUrl":"https://disqus.com/by/disqus_frKmsVnJGG/","url":"","reputation":1.232222,"location":"","isPrivate":true,"signedUrl":"","isPrimary":true,"joinedAt":"2016-07-31T11:32:08","id":"216931341","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_frKmsVnJGG.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/disqus_frKmsVnJGG.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_frKmsVnJGG.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-07-31T11:34:12","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Really interesting! Thank you for sharing all that. I was really expecting the sub-sampling method with a stateful model to work better than that. However I think I still do not grasp totally the reason of that. How different is the input data from the LSTM's perspective when you sub sample or not? Is it related to the way the gradient is computed (after each sequence? after each batch?). If you don't mind giving your opinion on that, I'd highly appreciate!","canVote":false,"thread":"5028095624","forum":"philipperemy-github-io-1","depth":0,"points":1,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Keep in mind that it's just a toy example. I think the sub-sampling can work good if you enforce that the full sequence is preserved through the batches, meaning that if X is my batch, I can concatenate X[i] and X[i+1] and it makes sense. I think the advantage of subsampling is that you can associate different targets to your sequence (like a many-to-many would do but at specific intervals e.g. every period of length 10, I generate an output). Let's consider a case where you have a sequence of length 1000 and you want to apply a stateful LSTM but with smaller sequences of length 10 (to have more data points). You can sub-sample by using the function prepare_sequences() from above. Instead of having a big sequence X of length 999 and trying to predict the 1000th value, you will have lots of smaller sequences of length 9 where you want to predict the 10th value. To make it work nicely, you have to enforce the ordering of your sequences (i.e. ban any shuffling when you call \u003ca href=\"http://disq.us/url?url=http%3A%2F%2Fkeras.model.fit%3AWGfWaoR3pw8sTMxg6NrMqRQAevo&amp;cuid=4457424\" rel=\"nofollow noopener\">keras.model.fit\u003c/a>()) because otherwise you will lose the long term memory of your big sequence It's like sub-sampling from your big sequence and shuffle all your generated smaller sequences. It's important that X[0:9] comes before X[10:19] to keep the time axis value.\u003cbr>The gradient is always computed at the end of each batch. If your batch_size = 1, a batch becomes a single sequence and the gradient is computed at the end of this sequence.\u003c/p>","id":"2826091256","isHighlighted":false,"author":{"username":"philippe_r_my","about":"","name":"Philippe R\u00e9my","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.215689,"profileUrl":"https://disqus.com/by/philippe_r_my/","url":"","reputation":1.215689,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2016-01-21T04:58:41","id":"192968483","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar32.jpg?1490436954"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar92.jpg?1490436954","large":{"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar92.jpg?1490436954"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-08-08T02:16:19","parent":2813184029,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Keep in mind that it's just a toy example. I think the sub-sampling can work good if you enforce that the full sequence is preserved through the batches, meaning that if X is my batch, I can concatenate X[i] and X[i+1] and it makes sense. I think the advantage of subsampling is that you can associate different targets to your sequence (like a many-to-many would do but at specific intervals e.g. every period of length 10, I generate an output). Let's consider a case where you have a sequence of length 1000 and you want to apply a stateful LSTM but with smaller sequences of length 10 (to have more data points). You can sub-sample by using the function prepare_sequences() from above. Instead of having a big sequence X of length 999 and trying to predict the 1000th value, you will have lots of smaller sequences of length 9 where you want to predict the 10th value. To make it work nicely, you have to enforce the ordering of your sequences (i.e. ban any shuffling when you call keras.model.fit()) because otherwise you will lose the long term memory of your big sequence It's like sub-sampling from your big sequence and shuffle all your generated smaller sequences. It's important that X[0:9] comes before X[10:19] to keep the time axis value.\nThe gradient is always computed at the end of each batch. If your batch_size = 1, a batch becomes a single sequence and the gradient is computed at the end of this sequence.","canVote":false,"thread":"5028095624","forum":"philipperemy-github-io-1","depth":1,"points":0,"moderationLabels":["links"],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Hi, Can I just think it as: If we are in stateful=True mode, and I get a sequence X of 1000 feature, now I split the X into 10 subsequence with length = 100, for example as x1, x2,..,x10. Now I put x1 in the i-th place in batch #1(no matter how long the batch size is), x2 the same place in batch #2, and so on... When all the epoch ends, the lstm will get a long memory pattern of the whole sequence X.?\u003c/p>","id":"2837044309","isHighlighted":false,"author":{"username":"disqus_NCbQCPFV88","about":"","name":"Phx","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.235932,"profileUrl":"https://disqus.com/by/disqus_NCbQCPFV88/","url":"","reputation":1.235932,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2016-08-14T13:59:00","id":"218511918","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_NCbQCPFV88.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/disqus_NCbQCPFV88.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_NCbQCPFV88.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-08-14T14:06:14","parent":2826091256,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Hi, Can I just think it as: If we are in stateful=True mode, and I get a sequence X of 1000 feature, now I split the X into 10 subsequence with length = 100, for example as x1, x2,..,x10. Now I put x1 in the i-th place in batch #1(no matter how long the batch size is), x2 the same place in batch #2, and so on... When all the epoch ends, the lstm will get a long memory pattern of the whole sequence X.?","canVote":false,"thread":"5028095624","forum":"philipperemy-github-io-1","depth":2,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Let's consider stateful=True throughout this explanation.\u003c/p>\u003cp>If batch_size=1, yes to your question.\u003c/p>\u003cp>If batch_size is greater than 1 (2, 16, 32...), and if you want to keep your long memory, you must be careful. For this to work, you must ensure that x1 is indexed by i in batch_#1, x2 indexed by i in batch_#2, x3 indexed by i in batch_#3, where i MUST be the same across your batches (in your example it does not make sense to have a batch size different than 1. In your case, i=0). \u003cbr>When I say x3 indexed by i in batch#k, I mean if X_k is your k-th batch, X_k[i] = x3.\u003c/p>\u003cp>x1, ..., x10 = split(X)\u003cbr>batch_size = 1\u003c/p>\u003cp>LSTM_train(x1)\u003cbr>LSTM_train(x2)\u003cbr>LSTM_train(x3)\u003cbr>...\u003cbr>LSTM_train(x10)\u003c/p>\u003cp>will keep the long term memory because the cells are not reinitalized (stateful=True property).\u003c/p>","id":"2848139090","isHighlighted":false,"author":{"username":"philippe_r_my","about":"","name":"Philippe R\u00e9my","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.215689,"profileUrl":"https://disqus.com/by/philippe_r_my/","url":"","reputation":1.215689,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2016-01-21T04:58:41","id":"192968483","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar32.jpg?1490436954"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar92.jpg?1490436954","large":{"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar92.jpg?1490436954"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-08-20T12:08:24","parent":2837044309,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Let's consider stateful=True throughout this explanation.\n\nIf batch_size=1, yes to your question. \n\nIf batch_size is greater than 1 (2, 16, 32...), and if you want to keep your long memory, you must be careful. For this to work, you must ensure that x1 is indexed by i in batch_#1, x2 indexed by i in batch_#2, x3 indexed by i in batch_#3, where i MUST be the same across your batches (in your example it does not make sense to have a batch size different than 1. In your case, i=0). \nWhen I say x3 indexed by i in batch#k, I mean if X_k is your k-th batch, X_k[i] = x3.\n\nx1, ..., x10 = split(X)\nbatch_size = 1\n\nLSTM_train(x1)\nLSTM_train(x2)\nLSTM_train(x3)\n...\nLSTM_train(x10)\n\nwill keep the long term memory because the cells are not reinitalized (stateful=True property).","canVote":false,"thread":"5028095624","forum":"philipperemy-github-io-1","depth":3,"points":0,"moderationLabels":[],"isEdited":true},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Why do people use sequences at all? Wouldn't it be better to always keep the long term memory?\u003c/p>\u003cp>Also, if a train a LSTM network in the stateless mode, and define the timestep = 1. Then what I am doing is simply train a kind of feedforward network right?\u003c/p>","id":"2970565116","isHighlighted":false,"author":{"username":"disqus_gzpbp64ONX","about":"","name":"Rodrigo Pinto","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.1823979999999998,"profileUrl":"https://disqus.com/by/disqus_gzpbp64ONX/","url":"","reputation":1.1823979999999998,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2016-10-26T20:37:19","id":"227891547","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_gzpbp64ONX.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/disqus_gzpbp64ONX.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_gzpbp64ONX.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-10-26T22:19:24","parent":2848139090,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Why do people use sequences at all? Wouldn't it be better to always keep the long term memory? \n\nAlso, if a train a LSTM network in the stateless mode, and define the timestep = 1. Then what I am doing is simply train a kind of feedforward network right?","canVote":false,"thread":"5028095624","forum":"philipperemy-github-io-1","depth":4,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Probably because sometimes you don't want to carry over all the information from the whole sequence. Let's say you want to build a language model to model the english language. You will be interested to understand P( word1 | word2, word3 ...) and so on. But you may not want this sequence to be too big. For example you may not want to read the entire book to predict just the next word. Also I think it helps the network to gain stability when the inputs are more or less of the same length (to be confirmed). But, I agree that it would make sense for modelling Time Series where you may have very long term memory and when you don't know exactly when to cut.\u003c/p>\u003cp>LSTM Network in stateless and timestep = 1 will be a simple feedforward network. You will obviously still have all the architecture of the LSTM layers, including the gates and the states. But you will not ever the states[i-1] because you will never unroll across the time dimensions, because of timestep=1. Stateless will reset all your states every time so you lose the ability of having the states propagated across the training set.\u003c/p>","id":"2970733733","isHighlighted":false,"author":{"username":"philippe_r_my","about":"","name":"Philippe R\u00e9my","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.215689,"profileUrl":"https://disqus.com/by/philippe_r_my/","url":"","reputation":1.215689,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2016-01-21T04:58:41","id":"192968483","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar32.jpg?1490436954"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar92.jpg?1490436954","large":{"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar92.jpg?1490436954"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-10-27T00:41:04","parent":2970565116,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Probably because sometimes you don't want to carry over all the information from the whole sequence. Let's say you want to build a language model to model the english language. You will be interested to understand P( word1 | word2, word3 ...) and so on. But you may not want this sequence to be too big. For example you may not want to read the entire book to predict just the next word. Also I think it helps the network to gain stability when the inputs are more or less of the same length (to be confirmed). But, I agree that it would make sense for modelling Time Series where you may have very long term memory and when you don't know exactly when to cut.\n\nLSTM Network in stateless and timestep = 1 will be a simple feedforward network. You will obviously still have all the architecture of the LSTM layers, including the gates and the states. But you will not ever the states[i-1] because you will never unroll across the time dimensions, because of timestep=1. Stateless will reset all your states every time so you lose the ability of having the states propagated across the training set.","canVote":false,"thread":"5028095624","forum":"philipperemy-github-io-1","depth":5,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Hi,\u003cbr>I'm a student and I'm new in (LSTM) keras. I'll work on a project in which I have multivariate data (Bank Transactions).\u003cbr>Could you please tell me how to reshape data for input to LSTM, I have seen many examples for uni-variate data but couldn't find the example for multivariate data.\u003c/p>","id":"3241942441","isHighlighted":false,"author":{"username":"rahul_chandnani","about":"","name":"Rahul Chandnani","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.232124,"profileUrl":"https://disqus.com/by/rahul_chandnani/","url":"","reputation":1.232124,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2017-04-05T23:01:56","id":"247942784","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/rahul_chandnani.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/rahul_chandnani.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/rahul_chandnani.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-04-05T23:07:55","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Hi,\nI'm a student and I'm new in (LSTM) keras. I'll work on a project in which I have multivariate data (Bank Transactions).\nCould you please tell me how to reshape data for input to LSTM, I have seen many examples for uni-variate data but couldn't find the example for multivariate data.","canVote":false,"thread":"5028095624","forum":"philipperemy-github-io-1","depth":0,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>In stateless mode, Is the cell state reset after each sequence or each batch ?\u003cbr>In the 3rd question in the post u mention: At each sequence processing, this state array is reset.\u003c/p>","id":"3214816607","isHighlighted":false,"author":{"username":"arashmoaddel","about":"","name":"Arash Moaddel","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.233698,"profileUrl":"https://disqus.com/by/arashmoaddel/","url":"","reputation":1.233698,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2017-01-24T12:20:32","id":"239868829","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/arashmoaddel.jpg","cache":"https://c.disquscdn.com/uploads/users/23986/8829/avatar32.jpg?1492336292"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/arashmoaddel.jpg","cache":"https://c.disquscdn.com/uploads/users/23986/8829/avatar92.jpg?1492336292","large":{"permalink":"https://disqus.com/api/users/avatars/arashmoaddel.jpg","cache":"https://c.disquscdn.com/uploads/users/23986/8829/avatar92.jpg?1492336292"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-03-21T11:25:25","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"In stateless mode, Is the cell state reset after each sequence or each batch ?\nIn the 3rd question in the post u mention: At each sequence processing, this state array is reset.","canVote":false,"thread":"5028095624","forum":"philipperemy-github-io-1","depth":0,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Let's say we have batch_size = 1, and samples (X_1, X_2, X_3, X_4, X_5) , the initial parameter for NN is alpha_0 \u003cbr>My question is in STATEFUL LSTM, the state of X_1 is computed by the initial parameter alpha_0, or is it computed by the updated parameter (say alpha_1) AFTER learning X_1; the state of X_2 is computed by the parameter alpha_1, or is it computed by the updated parameter (say alpha_2) AFTER learning X_2, etc.?\u003c/p>","id":"3212799792","isHighlighted":false,"author":{"username":"disqus_HmGHBd5Vda","about":"","name":"Bill Gao","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.232124,"profileUrl":"https://disqus.com/by/disqus_HmGHBd5Vda/","url":"","reputation":1.232124,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2017-03-20T05:23:41","id":"246100557","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_HmGHBd5Vda.jpg","cache":"https://c.disquscdn.com/uploads/users/24610/557/avatar32.jpg?1489987488"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/disqus_HmGHBd5Vda.jpg","cache":"https://c.disquscdn.com/uploads/users/24610/557/avatar92.jpg?1489987488","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_HmGHBd5Vda.jpg","cache":"https://c.disquscdn.com/uploads/users/24610/557/avatar92.jpg?1489987488"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-03-20T05:24:45","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Let's say we have batch_size = 1, and samples (X_1, X_2, X_3, X_4, X_5) , the initial parameter for NN is alpha_0 \nMy question is in STATEFUL LSTM, the state of X_1 is computed by the initial parameter alpha_0, or is it computed by the updated parameter (say alpha_1) AFTER learning X_1; the state of X_2 is computed by the parameter alpha_1, or is it computed by the updated parameter (say alpha_2) AFTER learning X_2, etc.?","canVote":false,"thread":"5028095624","forum":"philipperemy-github-io-1","depth":0,"points":0,"moderationLabels":[],"isEdited":true},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Notation: whenever I mention states, I mean (h,c).\u003cbr>The weights are called W (they do not comprise the states).\u003c/p>\u003cp>Let's consider bs=1, with stateful=True and your sequence (X_1, X_2, X_3, X_4, X_5), fed one at a time.\u003c/p>\u003cp>Your parameters and states are initialized to alpha_0 and W_0.\u003cbr>You feed X_1 to the model and the states are updated to alpha_1 and W_1 after X_1 is processed.\u003cbr>You feed X_2 to the model. At this moment, alpha_1 will be used and not alpha_0. Also W_1 will be used.\u003cbr>If you specified stateful=False, alpha_0 and W_1 would be used, instead of (alpha_1, W_1).\u003c/p>","id":"3222701790","isHighlighted":false,"author":{"username":"philippe_r_my","about":"","name":"Philippe R\u00e9my","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.215689,"profileUrl":"https://disqus.com/by/philippe_r_my/","url":"","reputation":1.215689,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2016-01-21T04:58:41","id":"192968483","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar32.jpg?1490436954"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar92.jpg?1490436954","large":{"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar92.jpg?1490436954"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-03-25T10:02:28","parent":3212799792,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Notation: whenever I mention states, I mean (h,c).\nThe weights are called W (they do not comprise the states).\n\nLet's consider bs=1, with stateful=True and your sequence (X_1, X_2, X_3, X_4, X_5), fed one at a time.\n\nYour parameters and states are initialized to alpha_0 and W_0.\nYou feed X_1 to the model and the states are updated to alpha_1 and W_1 after X_1 is processed.\nYou feed X_2 to the model. At this moment, alpha_1 will be used and not alpha_0. Also W_1 will be used.\nIf you specified stateful=False, alpha_0 and W_1 would be used, instead of (alpha_1, W_1).","canVote":false,"thread":"5028095624","forum":"philipperemy-github-io-1","depth":1,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>May I ask two questions ?\u003c/p>\u003cp>1. Why the model is trained in \u003ca href=\"https://disq.us/url?url=https%3A%2F%2Fgist.github.com%2Fphilipperemy%2F7104d9072d7f9fde55abe1c76f8a33ed%23file-lstm-py-L108%3A57WFEHwNAZKABuxu2W5FyjWTgMg&amp;cuid=4457424\" rel=\"nofollow noopener\">https://gist.github.com/phi...\u003c/a> after `fit` in \u003ca href=\"https://disq.us/url?url=https%3A%2F%2Fgist.github.com%2Fphilipperemy%2F7104d9072d7f9fde55abe1c76f8a33ed%23file-lstm-py-L95%3AA6IbM5fPejOOfschz0auZ7_jRSs&amp;cuid=4457424\" rel=\"nofollow noopener\">https://gist.github.com/phi...\u003c/a> ?\u003c/p>\u003cp>2. With a trainable `max_len` in practice, can we always use `USE_SEQUENCES = False` and `USE_STATELESS_MODEL = False` and forget about `statefulness`?\u003c/p>","id":"3212727689","isHighlighted":false,"author":{"username":"jiajianhuang","about":"","name":"Jiajian","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.21163,"profileUrl":"https://disqus.com/by/jiajianhuang/","url":"","reputation":1.21163,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2012-11-27T14:56:21","id":"37425831","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/jiajianhuang.jpg","cache":"https://c.disquscdn.com/uploads/users/3742/5831/avatar32.jpg?1425292167"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/jiajianhuang.jpg","cache":"https://c.disquscdn.com/uploads/users/3742/5831/avatar92.jpg?1425292167","large":{"permalink":"https://disqus.com/api/users/avatars/jiajianhuang.jpg","cache":"https://c.disquscdn.com/uploads/users/3742/5831/avatar92.jpg?1425292167"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-03-20T03:40:58","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"May I ask two questions ?\n\n1. Why the model is trained in https://gist.github.com/philipperemy/7104d9072d7f9fde55abe1c76f8a33ed#file-lstm-py-L108 after `fit` in https://gist.github.com/philipperemy/7104d9072d7f9fde55abe1c76f8a33ed#file-lstm-py-L95 ?\n\n2. With a trainable `max_len` in practice, can we always use `USE_SEQUENCES = False` and `USE_STATELESS_MODEL = False` and forget about `statefulness`?","canVote":false,"thread":"5028095624","forum":"philipperemy-github-io-1","depth":0,"points":0,"moderationLabels":["links"],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Sure! Here are two answers.\u003c/p>\u003cp>1. That's a mistake. It does not have any effects though. Wrong copy/paste! Just remove the fit() function.\u003cbr>2. When you know exactly the size of your sequences (offline setup), you don't need to be stateful. The stateful mode is when you have online training. For example, you use stateful=True, when you receive one element every x seconds and you want to consider the whole as a sequence. Let's say you apply it to the stock market. You receive prices updates randomly. Between two values you don't want your states to be reset, right? You want to keep all the information. That's why you need statefulness. You need to have a control over your states.\u003c/p>","id":"3222704188","isHighlighted":false,"author":{"username":"philippe_r_my","about":"","name":"Philippe R\u00e9my","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.215689,"profileUrl":"https://disqus.com/by/philippe_r_my/","url":"","reputation":1.215689,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2016-01-21T04:58:41","id":"192968483","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar32.jpg?1490436954"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar92.jpg?1490436954","large":{"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar92.jpg?1490436954"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-03-25T10:06:38","parent":3212727689,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Sure! Here are two answers.\n\n1. That's a mistake. It does not have any effects though. Wrong copy/paste! Just remove the fit() function.\n2. When you know exactly the size of your sequences (offline setup), you don't need to be stateful. The stateful mode is when you have online training. For example, you use stateful=True, when you receive one element every x seconds and you want to consider the whole as a sequence. Let's say you apply it to the stock market. You receive prices updates randomly. Between two values you don't want your states to be reset, right? You want to keep all the information. That's why you need statefulness. You need to have a control over your states.","canVote":false,"thread":"5028095624","forum":"philipperemy-github-io-1","depth":1,"points":0,"moderationLabels":[],"isEdited":true},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>However we knew the size of time sequence X in our example (shown by you in the post) and still switching from stateless to stateful proved advantageous as accuracy improved manifold. So is being stateful always good because we will be backpropagating more times with the states preserved as against stateless sub-sequencing based training?\u003c/p>","id":"3248097610","isHighlighted":false,"author":{"username":"siddharth_muthukumar","about":"","name":"Siddharth Muthukumar","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.2363009999999999,"profileUrl":"https://disqus.com/by/siddharth_muthukumar/","url":"","reputation":1.2363009999999999,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2016-05-20T17:52:46","id":"208763861","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/siddharth_muthukumar.jpg","cache":"https://c.disquscdn.com/uploads/users/20876/3861/avatar32.jpg?1491769532"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/siddharth_muthukumar.jpg","cache":"https://c.disquscdn.com/uploads/users/20876/3861/avatar92.jpg?1491769532","large":{"permalink":"https://disqus.com/api/users/avatars/siddharth_muthukumar.jpg","cache":"https://c.disquscdn.com/uploads/users/20876/3861/avatar92.jpg?1491769532"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-04-09T20:25:31","parent":3222704188,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"However we knew the size of time sequence X in our example (shown by you in the post) and still switching from stateless to stateful proved advantageous as accuracy improved manifold. So is being stateful always good because we will be backpropagating more times with the states preserved as against stateless sub-sequencing based training?","canVote":false,"thread":"5028095624","forum":"philipperemy-github-io-1","depth":2,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Hi Philippe, Thanks for writing this wonderful post. It has helped me understand stateful lstm clearly. \u003cbr>However , i have hit a roadblock somewhere. Please take a look at my problem.   \u003ca href=\"https://disq.us/url?url=https%3A%2F%2Fgithub.com%2Ffchollet%2Fkeras%2Fissues%2F5857%3A-qrIsTFCvpMT-fzM3MFXely0JLo&amp;cuid=4457424\" rel=\"nofollow noopener\">https://github.com/fchollet...\u003c/a>\u003c/p>\u003cp>I am using Stateful LSTM for time series prediction.  I input 5 features to the network. I am feeding the data for 50 days as input to predict the output for 51st day.  Could you please help me out?\u003c/p>\u003cp>Thanks!\u003c/p>","id":"3211446266","isHighlighted":false,"author":{"username":"syedmoinudeen","about":"","name":"Syed Moinudeen","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.232124,"profileUrl":"https://disqus.com/by/syedmoinudeen/","url":"","reputation":1.232124,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2017-03-19T06:34:58","id":"246001985","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/syedmoinudeen.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/syedmoinudeen.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/syedmoinudeen.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-03-19T06:35:13","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Hi Philippe, Thanks for writing this wonderful post. It has helped me understand stateful lstm clearly. \nHowever , i have hit a roadblock somewhere. Please take a look at my problem.   https://github.com/fchollet/keras/issues/5857 \n\nI am using Stateful LSTM for time series prediction.  I input 5 features to the network. I am feeding the data for 50 days as input to predict the output for 51st day.  Could you please help me out? \n\nThanks!","canVote":false,"thread":"5028095624","forum":"philipperemy-github-io-1","depth":0,"points":0,"moderationLabels":["links"],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Hi, thanks for the great post! I'm trying to train an LSTM to predict sequences of values. The input data has variable length and the output data has the same length as the current input (so one output for each element in the input sequence). My task is actually more complex but you could think of it as a denoising task where given a noisy sequence you want to get the original signal.\u003cbr>I tried to implement it using a stateful lstm with batch_size=1 as in your example, training it by feeding just one sample at a time and restoring the memory after each sequence.\u003c/p>\u003cp>At prediction time, I often get the same output for each element in the sequence (which of course is bad). Eventually I realized that what I have trained is more similar to a sequence classification task since at each step it is trying to fit just one value. Is there a way to get N values at each timestep, where N is the number of samples already fed to the lstm? Is this the right way to proceed in you opinion? Thanks!\u003c/p>","id":"3195403864","isHighlighted":false,"author":{"username":"FedericoBecattini","about":"","name":"Federico Becattini","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.245506,"profileUrl":"https://disqus.com/by/FedericoBecattini/","url":"http://www.allafinedelpalo.it/","reputation":1.245506,"location":"","isPrivate":false,"signedUrl":"http://disq.us/?url=http%3A%2F%2Fwww.allafinedelpalo.it%2F&key=_lMhGvA_SlQHDnYhFzxi_w","isPrimary":true,"joinedAt":"2013-10-01T15:35:21","id":"75592058","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/FedericoBecattini.jpg","cache":"https://c.disquscdn.com/uploads/users/7559/2058/avatar32.jpg?1452590246"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/FedericoBecattini.jpg","cache":"https://c.disquscdn.com/uploads/users/7559/2058/avatar92.jpg?1452590246","large":{"permalink":"https://disqus.com/api/users/avatars/FedericoBecattini.jpg","cache":"https://c.disquscdn.com/uploads/users/7559/2058/avatar92.jpg?1452590246"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-03-09T22:47:09","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Hi, thanks for the great post! I'm trying to train an LSTM to predict sequences of values. The input data has variable length and the output data has the same length as the current input (so one output for each element in the input sequence). My task is actually more complex but you could think of it as a denoising task where given a noisy sequence you want to get the original signal.\nI tried to implement it using a stateful lstm with batch_size=1 as in your example, training it by feeding just one sample at a time and restoring the memory after each sequence.\n\nAt prediction time, I often get the same output for each element in the sequence (which of course is bad). Eventually I realized that what I have trained is more similar to a sequence classification task since at each step it is trying to fit just one value. Is there a way to get N values at each timestep, where N is the number of samples already fed to the lstm? Is this the right way to proceed in you opinion? Thanks!","canVote":false,"thread":"5028095624","forum":"philipperemy-github-io-1","depth":0,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Hi,\u003c/p>\u003cp>I am interested in sequence classification of multi-variate time sequences. Although I failed to implement this with LSTM. \u003cbr>I fed data in batch=1 and stateful=True with sliding (lagged) window of 7 days (my data is split by days). My network had accuracy 1 and loss 10^-6, which I believe is completely wrong.\u003c/p>\u003cp>Are there any chances you can put your findings into gist with some toy/random dataset? I am really interested to see what shapes of your X and Y and what is the shape of the sequence fed to neural network.\u003c/p>\u003cp>Thanks!\u003c/p>","id":"3205995468","isHighlighted":false,"author":{"username":"disqus_Tdo8ImgQFV","about":"","name":"Nick","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.232124,"profileUrl":"https://disqus.com/by/disqus_Tdo8ImgQFV/","url":"","reputation":1.232124,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2017-03-15T20:29:47","id":"245630190","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_Tdo8ImgQFV.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/disqus_Tdo8ImgQFV.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_Tdo8ImgQFV.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-03-15T20:30:40","parent":3195403864,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Hi, \n\nI am interested in sequence classification of multi-variate time sequences. Although I failed to implement this with LSTM. \nI fed data in batch=1 and stateful=True with sliding (lagged) window of 7 days (my data is split by days). My network had accuracy 1 and loss 10^-6, which I believe is completely wrong.\n\nAre there any chances you can put your findings into gist with some toy/random dataset? I am really interested to see what shapes of your X and Y and what is the shape of the sequence fed to neural network.\n\nThanks!","canVote":false,"thread":"5028095624","forum":"philipperemy-github-io-1","depth":1,"points":0,"moderationLabels":[],"isEdited":true},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>\u003ca data-dsq-mention=\"federicobecattini:disqus\" href=\"https://disqus.com/by/FedericoBecattini/\" rel=\"nofollow noopener\">Federico Becattini\u003c/a> in your case you may use Masking. Have a look at this thread: \u003ca href=\"https://disq.us/url?url=https%3A%2F%2Fgithub.com%2Ffchollet%2Fkeras%2Fissues%2F4624%3AUNTs3Ha5OfNSpbd9q9bjTNrVBi8&amp;cuid=4457424\" rel=\"nofollow noopener\">https://github.com/fchollet...\u003c/a>. Keras supports it.\u003c/p>\u003cp>Also I've uploaded an implementation of variable length LSTM with stateful mode here (But it's also with batch_size=1). \u003ca href=\"https://disq.us/url?url=https%3A%2F%2Fgist.github.com%2Fphilipperemy%2F9dee137e504c863084fafae4d7b705e0%3AHjjPVyTQyuQA5I6wNJfOO06--Kc&amp;cuid=4457424\" rel=\"nofollow noopener\">https://gist.github.com/phi...\u003c/a>\u003c/p>\u003cp>. What you can do is to batch all the sequences of the same length together if you don't want to use masking. For example all sequences of length 5 in a batch of 256. All sequences of length 10 in batch of 256. And so forth. In your case if you input the sequences at once into the LSTM you don't need to have stateful=True. This mode is when you want to feed your sequence over time and you don't want the states and cells to reset every time you resume your sequence.\u003c/p>\u003cp>Just as a summary: 2 main possibilities I'm thinking of: Masking and Same-length Batching.\u003c/p>\u003cp>To answer your last question, yes, feeding N values at each timestep is definitely a good way to proceed. Your gradients will be averaged over the N values and the training should be much smoother. Also do not forget to fine tune your network architecture and your learning rate. If you have more data, a complex network is preferable. According to one important deep learning theorem, the local minima are very close to the global minimum for very deep neural networks.\u003c/p>","id":"3204642493","isHighlighted":false,"author":{"username":"philippe_r_my","about":"","name":"Philippe R\u00e9my","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.215689,"profileUrl":"https://disqus.com/by/philippe_r_my/","url":"","reputation":1.215689,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2016-01-21T04:58:41","id":"192968483","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar32.jpg?1490436954"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar92.jpg?1490436954","large":{"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar92.jpg?1490436954"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-03-15T01:23:47","parent":3195403864,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"@FedericoBecattini:disqus in your case you may use Masking. Have a look at this thread: https://github.com/fchollet/keras/issues/4624. Keras supports it.\n\nAlso I've uploaded an implementation of variable length LSTM with stateful mode here (But it's also with batch_size=1). https://gist.github.com/philipperemy/9dee137e504c863084fafae4d7b705e0\n\n. What you can do is to batch all the sequences of the same length together if you don't want to use masking. For example all sequences of length 5 in a batch of 256. All sequences of length 10 in batch of 256. And so forth. In your case if you input the sequences at once into the LSTM you don't need to have stateful=True. This mode is when you want to feed your sequence over time and you don't want the states and cells to reset every time you resume your sequence.\n\nJust as a summary: 2 main possibilities I'm thinking of: Masking and Same-length Batching.\n\nTo answer your last question, yes, feeding N values at each timestep is definitely a good way to proceed. Your gradients will be averaged over the N values and the training should be much smoother. Also do not forget to fine tune your network architecture and your learning rate. If you have more data, a complex network is preferable. According to one important deep learning theorem, the local minima are very close to the global minimum for very deep neural networks.","canVote":false,"thread":"5028095624","forum":"philipperemy-github-io-1","depth":1,"points":0,"moderationLabels":["links"],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Hi Thank you for such instructive note. Here is the code to evaluate on predict dataset if I want to use the callback() to reset the states of the LSTM layer. Hope this helps anyone trying convince that the two implementations (resetting by callback and manually reset) are the same.\u003c/p>\u003cp>testx = np.expand_dims(np.expand_dims(X_test.flatten(), axis=1), axis=1)\u003cbr>    testy = np.expand_dims(np.array([[v] * max_len for v in y_test.flatten()]).flatten(), axis=1)\u003cbr>    mean_te_acc = []\u003cbr>    mean_te_loss = []\u003cbr>    for i in xrange(0, testx.shape[0], 1):\u003cbr>  if (i % max_len == 0):\u003cbr>  model.reset_states()\u003cbr>  te_loss, te_acc = model.test_on_batch(np.expand_dims(testx[i], axis = 1), [testy[i]])\u003cbr>  mean_te_acc.append(te_acc)\u003cbr>  mean_te_loss.append(te_loss)\u003cbr>    print('accuracy testing = {}'.format(np.mean(mean_te_acc)))\u003cbr>    print('loss testing = {}'.format(np.mean(mean_te_loss)))\u003c/p>","id":"3152028260","isHighlighted":false,"author":{"username":"disqus_VNYd6bVME9","about":"","name":"Thai Le","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.232124,"profileUrl":"https://disqus.com/by/disqus_VNYd6bVME9/","url":"","reputation":1.232124,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2016-10-05T02:52:18","id":"225400184","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_VNYd6bVME9.jpg","cache":"https://c.disquscdn.com/uploads/users/22540/184/avatar32.jpg?1486977999"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/disqus_VNYd6bVME9.jpg","cache":"https://c.disquscdn.com/uploads/users/22540/184/avatar92.jpg?1486977999","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_VNYd6bVME9.jpg","cache":"https://c.disquscdn.com/uploads/users/22540/184/avatar92.jpg?1486977999"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-02-13T09:26:38","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Hi Thank you for such instructive note. Here is the code to evaluate on predict dataset if I want to use the callback() to reset the states of the LSTM layer. Hope this helps anyone trying convince that the two implementations (resetting by callback and manually reset) are the same.\n\ntestx = np.expand_dims(np.expand_dims(X_test.flatten(), axis=1), axis=1)\n    testy = np.expand_dims(np.array([[v] * max_len for v in y_test.flatten()]).flatten(), axis=1)\n    mean_te_acc = []\n    mean_te_loss = []\n    for i in xrange(0, testx.shape[0], 1):\n  if (i % max_len == 0):\n  model.reset_states()\n  te_loss, te_acc = model.test_on_batch(np.expand_dims(testx[i], axis = 1), [testy[i]])\n  mean_te_acc.append(te_acc)\n  mean_te_loss.append(te_loss)\n    print('accuracy testing = {}'.format(np.mean(mean_te_acc)))\n    print('loss testing = {}'.format(np.mean(mean_te_loss)))","canVote":false,"thread":"5028095624","forum":"philipperemy-github-io-1","depth":0,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Thanks \u003ca data-dsq-mention=\"disqus_vnyd6bvme9:disqus\" href=\"https://disqus.com/by/disqus_VNYd6bVME9/\" rel=\"nofollow noopener\">Thai Le\u003c/a> !\u003c/p>","id":"3204624876","isHighlighted":false,"author":{"username":"philippe_r_my","about":"","name":"Philippe R\u00e9my","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.215689,"profileUrl":"https://disqus.com/by/philippe_r_my/","url":"","reputation":1.215689,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2016-01-21T04:58:41","id":"192968483","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar32.jpg?1490436954"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar92.jpg?1490436954","large":{"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar92.jpg?1490436954"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-03-15T01:11:00","parent":3152028260,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Thanks @disqus_VNYd6bVME9:disqus !","canVote":false,"thread":"5028095624","forum":"philipperemy-github-io-1","depth":1,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>(wrong comment)\u003c/p>","id":"3050344438","isHighlighted":false,"author":{"username":"disqus_E360aD52Hb","about":"","name":"Goulou","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.232124,"profileUrl":"https://disqus.com/by/disqus_E360aD52Hb/","url":"","reputation":1.232124,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2016-12-13T17:32:38","id":"234813818","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_E360aD52Hb.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/disqus_E360aD52Hb.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_E360aD52Hb.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-12-13T17:41:48","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"(wrong comment)","canVote":false,"thread":"5028095624","forum":"philipperemy-github-io-1","depth":0,"points":0,"moderationLabels":[],"isEdited":true},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Hey, great explanation! I have, however, some questions:\u003cbr>1) If my GPU has enough memory, is there any advantage (e.g., training time and so on) in using larger batches?\u003cbr>2) Assuming I have a batch size &gt; 1 and:\u003cbr>  a) the total number of samples is not dividable by the batch size. Is this gonna be a problem? I ask this because we set the batch size for network and by having a sample size not multiple of the batch size will mean that my last batch will be smaller than the specified batch size...\u003cbr>  b) do my prediction/evaluation batches need to be the same size as the one we set for the network, or is that just important for training?\u003c/p>","id":"3029867928","isHighlighted":false,"author":{"username":"disqus_8gon2cRIuO","about":"","name":"Francisco Raposo","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.234067,"profileUrl":"https://disqus.com/by/disqus_8gon2cRIuO/","url":"","reputation":1.234067,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2015-10-07T10:23:42","id":"177619180","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_8gon2cRIuO.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/disqus_8gon2cRIuO.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_8gon2cRIuO.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-12-01T18:20:27","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Hey, great explanation! I have, however, some questions:\n1) If my GPU has enough memory, is there any advantage (e.g., training time and so on) in using larger batches?\n2) Assuming I have a batch size > 1 and:\n  a) the total number of samples is not dividable by the batch size. Is this gonna be a problem? I ask this because we set the batch size for network and by having a sample size not multiple of the batch size will mean that my last batch will be smaller than the specified batch size...\n  b) do my prediction/evaluation batches need to be the same size as the one we set for the network, or is that just important for training?","canVote":false,"thread":"5028095624","forum":"philipperemy-github-io-1","depth":0,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Thanks! Let me answer your questions.\u003c/p>\u003cp>1/ A larger batch is always better. The rule of thumbs is to have the largest possible batch your GPU can handle. The bigger your gradients are, the more accurate and smooth they will be. If you have batch_size=1, you can still converge to an optimal value, but it will be way more chaotic (much higher variance but still unbiased). And it will be way slower!\u003c/p>\u003cp>2/a/ It depends on the framework, I think Keras can handle it when the number of samples is not dividable for the batch size. \u003cbr>Correct, your last batch will be smaller than the specified batch size. But if you have 60,000 samples and a batch size of 128, having the last batch with 96 elements is not a big deal. It will have no visible effects.\u003cbr>2/b/ again it depends on the framework. In Keras, I don't think so! You should be able to give anything to the network.\u003c/p>","id":"3222709482","isHighlighted":false,"author":{"username":"philippe_r_my","about":"","name":"Philippe R\u00e9my","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.215689,"profileUrl":"https://disqus.com/by/philippe_r_my/","url":"","reputation":1.215689,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2016-01-21T04:58:41","id":"192968483","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar32.jpg?1490436954"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar92.jpg?1490436954","large":{"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar92.jpg?1490436954"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2017-03-25T10:15:51","parent":3029867928,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Thanks! Let me answer your questions.\n\n1/ A larger batch is always better. The rule of thumbs is to have the largest possible batch your GPU can handle. The bigger your gradients are, the more accurate and smooth they will be. If you have batch_size=1, you can still converge to an optimal value, but it will be way more chaotic (much higher variance but still unbiased). And it will be way slower!\n\n2/a/ It depends on the framework, I think Keras can handle it when the number of samples is not dividable for the batch size. \nCorrect, your last batch will be smaller than the specified batch size. But if you have 60,000 samples and a batch size of 128, having the last batch with 96 elements is not a big deal. It will have no visible effects.\n2/b/ again it depends on the framework. In Keras, I don't think so! You should be able to give anything to the network.","canVote":false,"thread":"5028095624","forum":"philipperemy-github-io-1","depth":1,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>thanks for this elaborate post.\u003cbr>1)  could you elaborate on: \"it seems that the callbacks are not properly called when using the parameter validation_data\"? is there an issue for that?\u003cbr>2) i understand that the model needs to know the batch size but why does it need to know the number of timesteps? why could we not pass something like batch_input_size=(batch_size, None, nb_features) ?\u003c/p>","id":"2966113419","isHighlighted":false,"author":{"username":"eyalgruss","about":"","name":"Eyal Gruss","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.237777,"profileUrl":"https://disqus.com/by/eyalgruss/","url":"","reputation":1.237777,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2015-11-02T16:24:38","id":"181167657","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/eyalgruss.jpg","cache":"https://c.disquscdn.com/uploads/users/18116/7657/avatar32.jpg?1477528620"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/eyalgruss.jpg","cache":"https://c.disquscdn.com/uploads/users/18116/7657/avatar92.jpg?1477528620","large":{"permalink":"https://disqus.com/api/users/avatars/eyalgruss.jpg","cache":"https://c.disquscdn.com/uploads/users/18116/7657/avatar92.jpg?1477528620"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-10-24T11:06:40","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"thanks for this elaborate post.\n1)  could you elaborate on: \"it seems that the callbacks are not properly called when using the parameter validation_data\"? is there an issue for that?\n2) i understand that the model needs to know the batch size but why does it need to know the number of timesteps? why could we not pass something like batch_input_size=(batch_size, None, nb_features) ?","canVote":false,"thread":"5028095624","forum":"philipperemy-github-io-1","depth":0,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Hey,\u003cbr>1. From the code, you can see that the callbacks are only applied during training. I don't think they will be called during validation. To be confirmed. \u003ca href=\"https://disq.us/url?url=https%3A%2F%2Fgithub.com%2Ffchollet%2Fkeras%2Fblob%2Fmaster%2Fkeras%2Fmodels.py%23L571%3AJlQdskxxJrbn1AKC_vvL0J3_aNc&amp;cuid=4457424\" rel=\"nofollow noopener\">https://github.com/fchollet...\u003c/a>. The issue is that your model would perform good on training data but badly on validation data. Again to be confirmed.\u003cbr>2. Probably because of Tensorflow and Theano at the same time. Theano compiles the code first so it may have to know this dimension for the RNN (C++/CUDA). Conceptually, this should not be a problem if time_steps is unknown at the model declaration. This is why I think it's more a technical issue related to the backend frameworks.\u003c/p>","id":"2966259590","isHighlighted":false,"author":{"username":"philippe_r_my","about":"","name":"Philippe R\u00e9my","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.215689,"profileUrl":"https://disqus.com/by/philippe_r_my/","url":"","reputation":1.215689,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2016-01-21T04:58:41","id":"192968483","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar32.jpg?1490436954"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar92.jpg?1490436954","large":{"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar92.jpg?1490436954"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-10-24T13:23:42","parent":2966113419,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Hey,\n1. From the code, you can see that the callbacks are only applied during training. I don't think they will be called during validation. To be confirmed. https://github.com/fchollet/keras/blob/master/keras/models.py#L571. The issue is that your model would perform good on training data but badly on validation data. Again to be confirmed.\n2. Probably because of Tensorflow and Theano at the same time. Theano compiles the code first so it may have to know this dimension for the RNN (C++/CUDA). Conceptually, this should not be a problem if time_steps is unknown at the model declaration. This is why I think it's more a technical issue related to the backend frameworks.","canVote":false,"thread":"5028095624","forum":"philipperemy-github-io-1","depth":1,"points":0,"moderationLabels":["links"],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>\u003ca href=\"https://disq.us/url?url=https%3A%2F%2Fgithub.com%2Ffchollet%2Fkeras%2Fissues%2F4185%3AuVV36i3yGsY9Tq1Jwfna5us8SeM&amp;cuid=4457424\" rel=\"nofollow noopener\">https://github.com/fchollet...\u003c/a>\u003c/p>","id":"2968340621","isHighlighted":false,"author":{"username":"eyalgruss","about":"","name":"Eyal Gruss","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.237777,"profileUrl":"https://disqus.com/by/eyalgruss/","url":"","reputation":1.237777,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2015-11-02T16:24:38","id":"181167657","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/eyalgruss.jpg","cache":"https://c.disquscdn.com/uploads/users/18116/7657/avatar32.jpg?1477528620"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/eyalgruss.jpg","cache":"https://c.disquscdn.com/uploads/users/18116/7657/avatar92.jpg?1477528620","large":{"permalink":"https://disqus.com/api/users/avatars/eyalgruss.jpg","cache":"https://c.disquscdn.com/uploads/users/18116/7657/avatar92.jpg?1477528620"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-10-25T17:30:34","parent":2966259590,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"https://github.com/fchollet/keras/issues/4185","canVote":false,"thread":"5028095624","forum":"philipperemy-github-io-1","depth":2,"points":0,"moderationLabels":["links"],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Thanks for opening this issue!\u003c/p>","id":"2970724267","isHighlighted":false,"author":{"username":"philippe_r_my","about":"","name":"Philippe R\u00e9my","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.215689,"profileUrl":"https://disqus.com/by/philippe_r_my/","url":"","reputation":1.215689,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2016-01-21T04:58:41","id":"192968483","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar32.jpg?1490436954"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar92.jpg?1490436954","large":{"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar92.jpg?1490436954"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-10-27T00:32:24","parent":2968340621,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Thanks for opening this issue!","canVote":false,"thread":"5028095624","forum":"philipperemy-github-io-1","depth":3,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>in theano for the stateless case you can pass input_size=(None, nb_features)\u003c/p>","id":"2966267521","isHighlighted":false,"author":{"username":"eyalgruss","about":"","name":"Eyal Gruss","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.237777,"profileUrl":"https://disqus.com/by/eyalgruss/","url":"","reputation":1.237777,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2015-11-02T16:24:38","id":"181167657","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/eyalgruss.jpg","cache":"https://c.disquscdn.com/uploads/users/18116/7657/avatar32.jpg?1477528620"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/eyalgruss.jpg","cache":"https://c.disquscdn.com/uploads/users/18116/7657/avatar92.jpg?1477528620","large":{"permalink":"https://disqus.com/api/users/avatars/eyalgruss.jpg","cache":"https://c.disquscdn.com/uploads/users/18116/7657/avatar92.jpg?1477528620"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-10-24T13:29:49","parent":2966259590,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"in theano for the stateless case you can pass input_size=(None, nb_features)","canVote":false,"thread":"5028095624","forum":"philipperemy-github-io-1","depth":2,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>I have clearly no ideas here! Probably related to TF then!\u003c/p>","id":"2970724741","isHighlighted":false,"author":{"username":"philippe_r_my","about":"","name":"Philippe R\u00e9my","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.215689,"profileUrl":"https://disqus.com/by/philippe_r_my/","url":"","reputation":1.215689,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2016-01-21T04:58:41","id":"192968483","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar32.jpg?1490436954"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar92.jpg?1490436954","large":{"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar92.jpg?1490436954"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-10-27T00:32:52","parent":2966267521,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"I have clearly no ideas here! Probably related to TF then!","canVote":false,"thread":"5028095624","forum":"philipperemy-github-io-1","depth":3,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Turns out you can pass none for the timestip also for stateful rnns\u003cbr>\u003c/p>","id":"2970729297","isHighlighted":false,"author":{"username":"eyalgruss","about":"","name":"Eyal Gruss","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.237777,"profileUrl":"https://disqus.com/by/eyalgruss/","url":"","reputation":1.237777,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2015-11-02T16:24:38","id":"181167657","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/eyalgruss.jpg","cache":"https://c.disquscdn.com/uploads/users/18116/7657/avatar32.jpg?1477528620"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/eyalgruss.jpg","cache":"https://c.disquscdn.com/uploads/users/18116/7657/avatar92.jpg?1477528620","large":{"permalink":"https://disqus.com/api/users/avatars/eyalgruss.jpg","cache":"https://c.disquscdn.com/uploads/users/18116/7657/avatar92.jpg?1477528620"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-10-27T00:36:59","parent":2970724741,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Turns out you can pass none for the timestip also for stateful rnns\n","canVote":false,"thread":"5028095624","forum":"philipperemy-github-io-1","depth":4,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Hi, thanks for the post.\u003c/p>\u003cp>May I ask something, I'm fighting with stateful LSTMs for couple of day.\u003c/p>\u003cp>I'm trying to use the stateful LSTM layer, but kinda without success. My model is quite simple, at the beginning I have few TimeDistributed Convolutional layers followed with ReLu and TimeDistributed MaxPooling:\u003c/p>\u003cp>model.add(TimeDistributed(Convolution2D(32, 3, 3, border_mode='same'), batch_input_shape = (batch_size, 1, img_channels, img_rows, img_cols)))\u003cbr>model.add(Activation('relu'))\u003cbr>model.add(TimeDistributed(MaxPooling2D(pool_size = (2,2))))\u003cbr>...\u003cbr>model.add(TimeDistributed(Flatten()))\u003cbr>model.add(LSTM(32, stateful = True, return_sequences = False))\u003cbr>...\u003c/p>\u003cp>However during adding the first layer I'm getting error \"No initial states provided.\", which is obviously connected with the fact, I'm specifying \"batch_size\", if I replace \"batch_size\" with None or if I define just \"input_shape\" the layer is successfully added to the model, but then I get the error during adding the LSTM layer, because I didn't define \"batch_size\".\u003c/p>\u003cp>This problem is certainly caused by TensorFlow backend, so I've tried to change it to Theano, however that make things even weirder. I was able to compile the model, but the model isn't able to learn, at least on GPU. When I try to learn the model, the loss becomes \"nan\" and accuracy becomes 0 after few epochs of training. I also set the theano flag \"mode\" to NanGuard, which gives me an output I'm not really sure how to properly interpret.\u003c/p>\u003cp>Anyway Theano is really slow comparing to TensorFlow, so I would prefer to solve the TensorFlow problem first.\u003c/p>\u003cp>Do you or anyone have some experience with similar problems? I would appreciate any help, thanks!\u003c/p>\u003cp>Vojta\u003c/p>","id":"2906446690","isHighlighted":false,"author":{"username":"Higgcz","about":"","name":"Vojt\u011bch Micka","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.233058,"profileUrl":"https://disqus.com/by/Higgcz/","url":"","reputation":1.233058,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2010-01-19T18:13:38","id":"1650207","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/Higgcz.jpg","cache":"https://c.disquscdn.com/uploads/users/165/207/avatar32.jpg?1474376682"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/Higgcz.jpg","cache":"https://c.disquscdn.com/uploads/users/165/207/avatar92.jpg?1474376682","large":{"permalink":"https://disqus.com/api/users/avatars/Higgcz.jpg","cache":"https://c.disquscdn.com/uploads/users/165/207/avatar92.jpg?1474376682"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-09-20T13:04:41","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Hi, thanks for the post.\n\nMay I ask something, I'm fighting with stateful LSTMs for couple of day.\n\nI'm trying to use the stateful LSTM layer, but kinda without success. My model is quite simple, at the beginning I have few TimeDistributed Convolutional layers followed with ReLu and TimeDistributed MaxPooling:\n\nmodel.add(TimeDistributed(Convolution2D(32, 3, 3, border_mode='same'), batch_input_shape = (batch_size, 1, img_channels, img_rows, img_cols)))\nmodel.add(Activation('relu'))\nmodel.add(TimeDistributed(MaxPooling2D(pool_size = (2,2))))\n...\nmodel.add(TimeDistributed(Flatten()))\nmodel.add(LSTM(32, stateful = True, return_sequences = False))\n...\n\nHowever during adding the first layer I'm getting error \"No initial states provided.\", which is obviously connected with the fact, I'm specifying \"batch_size\", if I replace \"batch_size\" with None or if I define just \"input_shape\" the layer is successfully added to the model, but then I get the error during adding the LSTM layer, because I didn't define \"batch_size\".\n\nThis problem is certainly caused by TensorFlow backend, so I've tried to change it to Theano, however that make things even weirder. I was able to compile the model, but the model isn't able to learn, at least on GPU. When I try to learn the model, the loss becomes \"nan\" and accuracy becomes 0 after few epochs of training. I also set the theano flag \"mode\" to NanGuard, which gives me an output I'm not really sure how to properly interpret.\n\nAnyway Theano is really slow comparing to TensorFlow, so I would prefer to solve the TensorFlow problem first.\n\nDo you or anyone have some experience with similar problems? I would appreciate any help, thanks!\n\nVojta","canVote":false,"thread":"5028095624","forum":"philipperemy-github-io-1","depth":0,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Probably it's a problem of backend/bug in Keras/Tensorflow as you mentioned. What I can tell is that you have to define explicitly your batch size when you use the stateful model. In this case, all the layers should have this information specified at their definition.\u003c/p>\u003cp>I don't have much experience with this complex architecture. Better find a way to define it as stateless! Could be worth investigating for making a pull request.\u003c/p>","id":"2966266219","isHighlighted":false,"author":{"username":"philippe_r_my","about":"","name":"Philippe R\u00e9my","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.215689,"profileUrl":"https://disqus.com/by/philippe_r_my/","url":"","reputation":1.215689,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2016-01-21T04:58:41","id":"192968483","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar32.jpg?1490436954"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar92.jpg?1490436954","large":{"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar92.jpg?1490436954"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-10-24T13:28:49","parent":2906446690,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Probably it's a problem of backend/bug in Keras/Tensorflow as you mentioned. What I can tell is that you have to define explicitly your batch size when you use the stateful model. In this case, all the layers should have this information specified at their definition.\n\nI don't have much experience with this complex architecture. Better find a way to define it as stateless! Could be worth investigating for making a pull request.","canVote":false,"thread":"5028095624","forum":"philipperemy-github-io-1","depth":1,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Do you have an example for a time series prediction in this fashion?\u003c/p>","id":"2877703581","isHighlighted":false,"author":{"username":"keshav_mathur","about":"","name":"Keshav Mathur","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.2363009999999999,"profileUrl":"https://disqus.com/by/keshav_mathur/","url":"","reputation":1.2363009999999999,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2016-08-29T23:50:20","id":"220230453","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/keshav_mathur.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/keshav_mathur.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/keshav_mathur.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-09-05T18:55:27","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Do you have an example for a time series prediction in this fashion?","canVote":false,"thread":"5028095624","forum":"philipperemy-github-io-1","depth":0,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>I still have to implement something but it should not be too difficult. I'll do that when I have time!\u003c/p>","id":"2966264939","isHighlighted":false,"author":{"username":"philippe_r_my","about":"","name":"Philippe R\u00e9my","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.215689,"profileUrl":"https://disqus.com/by/philippe_r_my/","url":"","reputation":1.215689,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2016-01-21T04:58:41","id":"192968483","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar32.jpg?1490436954"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar92.jpg?1490436954","large":{"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar92.jpg?1490436954"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-10-24T13:27:52","parent":2877703581,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"I still have to implement something but it should not be too difficult. I'll do that when I have time!","canVote":false,"thread":"5028095624","forum":"philipperemy-github-io-1","depth":1,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Thank you for your post!\u003c/p>\u003cp>I have a question: is it true that:\u003c/p>\u003cp>the \"state\" is preserved for every sample of any sequence WITHIN a batch?\u003c/p>\u003cp>I ask this because I want to know what would happen if you use the entire row of X as a sequence, and set \"stateful=False\". This way different batches would have nothing to share, but would each sequence within a batch still be \"stateful\"? Would it be equivalent to using each sample of a sequence at a time and set \"stateful=True\", as your second case does?\u003c/p>\u003cp>Thank you!\u003c/p>","id":"2829693794","isHighlighted":false,"author":{"username":"disqus_qW0mssUp3H","about":"","name":"yongqiang","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.235932,"profileUrl":"https://disqus.com/by/disqus_qW0mssUp3H/","url":"","reputation":1.235932,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2016-08-10T02:24:38","id":"218033942","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/disqus_qW0mssUp3H.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/disqus_qW0mssUp3H.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/disqus_qW0mssUp3H.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-08-10T02:34:13","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Thank you for your post! \n\nI have a question: is it true that:\n\nthe \"state\" is preserved for every sample of any sequence WITHIN a batch? \n\nI ask this because I want to know what would happen if you use the entire row of X as a sequence, and set \"stateful=False\". This way different batches would have nothing to share, but would each sequence within a batch still be \"stateful\"? Would it be equivalent to using each sample of a sequence at a time and set \"stateful=True\", as your second case does? \n\nThank you!","canVote":false,"thread":"5028095624","forum":"philipperemy-github-io-1","depth":0,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Hey,\u003c/p>\u003cp>Within a batch, each sequence has its OWN states. Also each sequence is seen as independent from the other sequences in the batch. If your batch is Y, sequences Y[1] and Y[2] will never have something in common (whatever stateful=False or stateful=True).\u003c/p>\u003cp>If the LSTM has the stateful mode, the states of the current batch will be propagated to the next batch (at index i). Batching sequences is only to speed up the computations on a GPU.\u003c/p>\u003cp>Let's consider a matrix X with 1024 rows and a batch size of 32.\u003cbr>In the first place, let's consider each row of X as a sequence (1024 sequences) and stateful=False. You're in the default Keras setup. It means that each sequence has its states propagated throughout all the sequence BUT each sequence has its own states and there is nothing shared in the batch with the other sequences (the first dimension of the states tensor is the batch_size). So in your own terms, each sequence within a batch will be stateful because that's the purpose of a recurrent neural network.\u003c/p>\u003cp>Again if you consider sample as sub-sequence (of length 1), and you set stateful=True, the case is different, because we are working in a supervised learning context. You have to provide more targets Y because you have more sequences (= 1024 x nb_columns) where shape(X) = (1024, nb_columns).\u003c/p>\u003cp>Hope this helps :)\u003c/p>\u003cp>Thanks!\u003c/p>","id":"2836403549","isHighlighted":false,"author":{"username":"philippe_r_my","about":"","name":"Philippe R\u00e9my","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.215689,"profileUrl":"https://disqus.com/by/philippe_r_my/","url":"","reputation":1.215689,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2016-01-21T04:58:41","id":"192968483","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar32.jpg?1490436954"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar92.jpg?1490436954","large":{"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar92.jpg?1490436954"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-08-14T01:54:49","parent":2829693794,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Hey,\n\nWithin a batch, each sequence has its OWN states. Also each sequence is seen as independent from the other sequences in the batch. If your batch is Y, sequences Y[1] and Y[2] will never have something in common (whatever stateful=False or stateful=True). \n\nIf the LSTM has the stateful mode, the states of the current batch will be propagated to the next batch (at index i). Batching sequences is only to speed up the computations on a GPU.\n\nLet's consider a matrix X with 1024 rows and a batch size of 32.\nIn the first place, let's consider each row of X as a sequence (1024 sequences) and stateful=False. You're in the default Keras setup. It means that each sequence has its states propagated throughout all the sequence BUT each sequence has its own states and there is nothing shared in the batch with the other sequences (the first dimension of the states tensor is the batch_size). So in your own terms, each sequence within a batch will be stateful because that's the purpose of a recurrent neural network.\n\nAgain if you consider sample as sub-sequence (of length 1), and you set stateful=True, the case is different, because we are working in a supervised learning context. You have to provide more targets Y because you have more sequences (= 1024 x nb_columns) where shape(X) = (1024, nb_columns).\n\nHope this helps :)\n\nThanks!","canVote":false,"thread":"5028095624","forum":"philipperemy-github-io-1","depth":1,"points":0,"moderationLabels":[],"isEdited":true},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>do you have the github  code of all code here  ? \u003cbr>thanks\u003c/p>","id":"2824952813","isHighlighted":false,"author":{"username":"jansdf","about":"","name":"jansdf","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.235932,"profileUrl":"https://disqus.com/by/jansdf/","url":"","reputation":1.235932,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2016-08-07T07:16:29","id":"217731479","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/jansdf.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar32.png"},"isCustom":false,"permalink":"https://disqus.com/api/users/avatars/jansdf.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png","large":{"permalink":"https://disqus.com/api/users/avatars/jansdf.jpg","cache":"//a.disquscdn.com/1492794604/images/noavatar92.png"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-08-07T07:17:57","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"do you have the github  code of all code here  ? \nthanks","canVote":false,"thread":"5028095624","forum":"philipperemy-github-io-1","depth":0,"points":0,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>Hey!\u003cbr>Yes I've just uploaded it here at : \u003ca href=\"https://disq.us/url?url=https%3A%2F%2Fgist.github.com%2Fphilipperemy%2F7104d9072d7f9fde55abe1c76f8a33ed%3A0yhY24jGZJjSWIDI3Z68grCjQZc&amp;cuid=4457424\" rel=\"nofollow noopener\">https://gist.github.com/phi...\u003c/a>\u003c/p>","id":"2826077263","isHighlighted":false,"author":{"username":"philippe_r_my","about":"","name":"Philippe R\u00e9my","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.215689,"profileUrl":"https://disqus.com/by/philippe_r_my/","url":"","reputation":1.215689,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2016-01-21T04:58:41","id":"192968483","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar32.jpg?1490436954"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar92.jpg?1490436954","large":{"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar92.jpg?1490436954"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-08-08T02:00:06","parent":2824952813,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Hey!\nYes I've just uploaded it here at : https://gist.github.com/philipperemy/7104d9072d7f9fde55abe1c76f8a33ed","canVote":false,"thread":"5028095624","forum":"philipperemy-github-io-1","depth":1,"points":0,"moderationLabels":["links"],"isEdited":false},{"dislikes":1,"numReports":0,"likes":0,"message":"\u003cp>Thanks, this is a very clear explanation.\u003c/p>\u003cp>What I'm still having trouble with, though, is actually the case of `batch_size &gt; 1` and also `return_sequences=True`. Do you think you could add an example for those case?\u003c/p>","id":"2882202213","isHighlighted":false,"author":{"username":"danielhershcovich","about":"","name":"Daniel Hershcovich","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.285963,"profileUrl":"https://disqus.com/by/danielhershcovich/","url":"","reputation":1.285963,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2014-01-23T07:07:38","id":"91823785","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/danielhershcovich.jpg","cache":"https://c.disquscdn.com/uploads/users/9182/3785/avatar32.jpg?1390460859"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/danielhershcovich.jpg","cache":"https://c.disquscdn.com/uploads/users/9182/3785/avatar92.jpg?1390460859","large":{"permalink":"https://disqus.com/api/users/avatars/danielhershcovich.jpg","cache":"https://c.disquscdn.com/uploads/users/9182/3785/avatar92.jpg?1390460859"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-09-08T08:37:18","parent":null,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"Thanks, this is a very clear explanation.\n\nWhat I'm still having trouble with, though, is actually the case of `batch_size > 1` and also `return_sequences=True`. Do you think you could add an example for those case?","canVote":false,"thread":"5028095624","forum":"philipperemy-github-io-1","depth":0,"points":-1,"moderationLabels":[],"isEdited":false},{"dislikes":0,"numReports":0,"likes":0,"message":"\u003cp>I'll write an example whenever I have time! Thanks!\u003c/p>","id":"2944131603","isHighlighted":false,"author":{"username":"philippe_r_my","about":"","name":"Philippe R\u00e9my","disable3rdPartyTrackers":false,"isPowerContributor":false,"isAnonymous":false,"rep":1.215689,"profileUrl":"https://disqus.com/by/philippe_r_my/","url":"","reputation":1.215689,"location":"","isPrivate":false,"signedUrl":"","isPrimary":true,"joinedAt":"2016-01-21T04:58:41","id":"192968483","reputationLabel":"Average","avatar":{"small":{"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar32.jpg?1490436954"},"isCustom":true,"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar92.jpg?1490436954","large":{"permalink":"https://disqus.com/api/users/avatars/philippe_r_my.jpg","cache":"https://c.disquscdn.com/uploads/users/19296/8483/avatar92.jpg?1490436954"}}},"media":[],"isSpam":false,"isDeletedByAuthor":false,"createdAt":"2016-10-11T02:45:34","parent":2882202213,"isApproved":true,"isDeleted":false,"isFlagged":false,"raw_message":"I'll write an example whenever I have time! Thanks!","canVote":false,"thread":"5028095624","forum":"philipperemy-github-io-1","depth":1,"points":0,"moderationLabels":[],"isEdited":false}],"thread":{"feed":"https://philipperemy-github-io-1.disqus.com/stateful_lstm_in_keras_philippe_remy_my_blog_70/latest.rss","identifiers":[],"dislikes":0,"likes":6,"message":"","id":"5028095624","createdAt":"2016-07-31T06:05:54","category":"5133990","author":"216811848","isSpam":false,"signedLink":"http://disq.us/?url=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&key=xxfKLEfNZ6dTkKwxxTf_aw","isDeleted":false,"hasStreaming":false,"raw_message":"","isClosed":false,"link":"http://philipperemy.github.io/keras-stateful-lstm/","slug":"stateful_lstm_in_keras_philippe_remy_my_blog_70","forum":"philipperemy-github-io-1","clean_title":"Stateful LSTM in Keras \u2013 Philippe Remy \u2013 My Blog.","posts":44,"moderators":[216811848],"title":"Stateful LSTM in Keras \u2013 Philippe Remy \u2013 My Blog.","highlightedPost":null}},"order":"popular"}</script>

    

    <div id="fixed-content"></div>


    
        
<script type="text/json" id="disqus-urls">{
    "root":"//disqus.com",
    "next":"https://c.disquscdn.com/next/current/embed"
}</script>

        
        <script>!function () {
            var d = document;
            var toH = d.head.appendChild.bind(d.head);

            var v = window.location.href.match(/[#&?]version=([0-9a-f]{32})/);
            var src = 'https://c.disquscdn.com/next/embed/lounge.load';
            if (v)
                src += '.' + v[1];
            src += '.js';

            var s = d.createElement('script');
            s.crossOrigin = 'anonymous';
            s.id = 'bootstrap-script';
            s.setAttribute('data-app', 'lounge');
            s.src = src;
            toH(s);

            var m = d.createElement('meta');
            m.setAttribute('http-equiv', 'Content-Security-Policy');
            m.setAttribute('content', "script-src https:;");
            toH(m);
        }();</script>
    


<script src="./common.bundle.08b03b11c747b79c4d4135b49e2f8725.js"></script><div id="layout" data-tracking-area="layout"><div id="onboard" data-tracking-area="onboard"><div></div></div><div id="highlighted-post" data-tracking-area="highlighted" class="highlighted-post" style="display: none;"></div><div id="global-alert"></div><header id="main-nav" data-tracking-area="main-nav"><nav class="nav nav-primary"><ul><li class="nav-tab nav-tab--primary tab-conversation active" data-role="post-count"><a class="publisher-nav-color"><span class="comment-count">44 comments</span><span class="comment-count-placeholder">Comments</span></a></li><li class="nav-tab nav-tab--primary tab-community"><a href="https://disqus.com/home/forums/philipperemy-github-io-1/" class="publisher-nav-color" data-action="community-sidebar" data-forum="philipperemy-github-io-1" id="community-tab"><span class="community-name"><strong>philipperemy.github.io</strong></span><strong class="community-name-placeholder">Community</strong></a></li><li class="nav-tab nav-tab--primary dropdown user-menu" data-role="logout"><a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="dropdown-toggle" data-toggle="dropdown">
<span class="dropdown-toggle-wrapper">

<span>
Login
</span>

</span> <span class="caret"></span>
</a>
<ul class="dropdown-menu">


<li>
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="auth:disqus">Disqus</a>
</li>
<li>
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="auth:facebook">Facebook</a>
</li>
<li>
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="auth:twitter">Twitter</a>
</li>
<li>
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="auth:google">Google</a>
</li>



</ul>
</li><li class="nav-tab nav-tab--primary notification-menu unread" data-role="notification-menu"><a href="https://disqus.com/home/inbox/" class="notification-container" data-action="home" data-home-path="home/inbox/">
<span class="notification-icon icon-comment" aria-hidden=""></span>
<span class="notification-count" data-role="notification-count">1</span>
</a>
</li></ul></nav></header><section id="conversation" data-role="main" data-tracking-area="main"><div class="nav nav-secondary" data-tracking-area="secondary-nav"><ul><li id="recommend-button" class="nav-tab nav-tab--secondary recommend dropdown"><div class="thread-likes"><a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="recommend" title="Recommend this discussion" class="dropdown-toggle ">
<span class="label label-default"><span class="recommend-icon icon-heart-empty"></span> Recommend</span>
<span class="label label-recommended"><span class="recommend-icon icon-heart"></span> Recommended</span>
<span class="label label-count">6</span>
</a>
<ul class="dropdown-menu dropdown-menu--coachmark">
<li>
<h2 class="coachmark__heading">Discussion Recommended!</h2>
<p class="coachmark__description">Recommending means this is a discussion worth sharing. It gets shared to your followers' Disqus feeds, and gives the creator kudos!</p>
<a href="https://disqus.com/home/?utm_source=disqus_embed&amp;utm_content=recommend_btn" class="btn btn-primary coachmark__button" target="_blank">
 Find More Discussions 
</a>
</li>
</ul>
</div></li><li id="thread-share-menu" class="nav-tab nav-tab--secondary dropdown share-menu hidden-sm"><a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="dropdown-toggle" data-toggle="dropdown" title="Share">
<span class="icon-export"></span>
<span class="label">Share</span>
</a>
<ul class="share-menu dropdown-menu">
<li>
<div class="share-menu__label">Share this discussion on</div>
<ul>
<li class="twitter">
<a data-action="share:twitter" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#">Twitter</a>
</li>
<li class="facebook">
<a data-action="share:facebook" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#">Facebook</a>
</li>
</ul>
</li>
</ul>
</li><li data-role="post-sort" class="nav-tab nav-tab--secondary dropdown sorting pull-right"><a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="dropdown-toggle" data-toggle="dropdown">Sort by Best<span class="caret"></span></a><ul class="dropdown-menu pull-right"><li class="selected"><a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="sort" data-sort="popular">Best<i aria-hidden="true" class="icon-checkmark"></i></a></li><li class=""><a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="sort" data-sort="desc">Newest<i aria-hidden="true" class="icon-checkmark"></i></a></li><li class=""><a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="sort" data-sort="asc">Oldest<i aria-hidden="true" class="icon-checkmark"></i></a></li></ul></li></ul></div><div id="posts"><div id="form" class="textarea-wrapper--top-level"><form class="reply"><div class="postbox">
<div role="alert"></div>
<div class="avatar">
<span class="user">
<img data-role="user-avatar" src="./noavatar92.7b2fde640943965cc88df0cdee365907.png" alt="Avatar">
</span>
</div>

<div class="textarea-wrapper" data-role="textarea" dir="auto"><div><span class="placeholder">Join the discussion…</span><div class="textarea" tabindex="0" role="textbox" aria-multiline="true" contenteditable="PLAINTEXT-ONLY" data-role="editable" aria-label="Join the discussion…" style="overflow: auto; word-wrap: break-word; max-height: 350px;"><p><br></p></div><div style="display: none;"><ul class="user-mention__list">
<li class="header user-mention__header">
<h5>in this conversation</h5>
</li>
</ul>
</div></div>
<div data-role="drag-drop-placeholder" class="media-drag-hover" style="display: none">
<div class="drag-text">
⬇ Drag and drop your images here to upload them.
</div>
</div>
<div class="media-preview empty" data-role="media-preview"><ul data-role="media-progress-list"></ul>
<ul data-role="media-rich-list"></ul>
<div class="media-expanded empty" data-role="media-preview-expanded">
<img src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" data-role="media-preview-expanded-image" alt="Media preview placeholder">
</div>
</div>
<div class="edit-alert" role="postbox-alert"></div>
<div class="post-actions">
<ul class="wysiwyg">
<li class="wysiwyg__item" data-role="media-uploader"><a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" tabindex="-1" data-action="attach" class="attach" title="Upload Images"><span>Attach</span></a>
<input type="file" data-role="media-upload" tabindex="-1" accept="image/*">
</li>
</ul>
</div>
</div>

<div data-role="login-form"><div><section class="auth-section logged-out">
<div class="connect">
<h6>Log in with</h6>
<ul data-role="login-menu" class="services login-buttons">

<li class="auth-disqus">
<button type="button" data-action="auth:disqus" title="Disqus" class="connect__button"><i class="icon-disqus"></i></button>
</li>
<li class="auth-facebook">
<button type="button" data-action="auth:facebook" title="Facebook" class="connect__button"><i class="icon-facebook-circle"></i></button>
</li>
<li class="auth-twitter">
<button type="button" data-action="auth:twitter" title="Twitter" class="connect__button"><i class="icon-twitter-circle"></i></button>
</li>
<li class="auth-google">
<button type="button" data-action="auth:google" title="Google" class="connect__button"><i class="icon-google-plus-circle"></i></button>
</li>
</ul>
</div>
<div class="guest">
<h6 class="guest-form-title">
<span class="register-text"> or sign up with Disqus </span>
<span class="guest-text"> or pick a name </span>
</h6>

<div class="help-tooltip__wrapper help-icon">
<div id="rules" class="tooltip show help-tooltip">
<h3 class="help-tooltip__heading">Disqus is a discussion network</h3>
<ul class="help-tooltip__list">
<li><span>Disqus never moderates or censors. The rules on this community are its own.</span></li>
<li><span>Your email is safe with us. It's only used for moderation and optional notifications.</span></li>
<li><span>Don't be a jerk or do anything illegal. Everything is easier that way.</span></li>
</ul>
<p class="clearfix"><a href="https://docs.disqus.com/kb/terms-and-policies/" class="btn btn-small help-tooltip__button" target="_blank">Read full terms and conditions</a></p>
</div>
</div>

<p class="input-wrapper">
<input dir="auto" type="text" placeholder="Name" name="display_name" id="view93_display_name" maxlength="30" class="input--text">
</p>

<div class="guest-details " data-role="guest-details">
<p class="input-wrapper">
<input dir="auto" type="email" placeholder="Email" name="email" id="view93_email" class="input--text">
</p>

<p class="input-wrapper">
<input dir="auto" type="password" class="register-text input--text" placeholder="Password" name="password" id="view93_password">
</p>

<div class="acceptance-wrapper register-text">
By signing up, you agree to the Disqus <a target="_blank" href="https://help.disqus.com/customer/portal/articles/1753105-basic-rules-for-disqus-powered-profiles-and-discussions">Basic Rules</a>, <a target="_blank" href="https://help.disqus.com/customer/portal/articles/466260-terms-of-service">Terms of Service</a>, and <a target="_blank" href="https://help.disqus.com/customer/portal/articles/466259-privacy-policy">Privacy Policy</a>.
</div>
<div class="acceptance-wrapper guest-text">
By posting, you agree to the Disqus <a target="_blank" href="https://help.disqus.com/customer/portal/articles/1753105-basic-rules-for-disqus-powered-profiles-and-discussions">Basic Rules</a>, <a target="_blank" href="https://help.disqus.com/customer/portal/articles/466260-terms-of-service">Terms of Service</a>, and <a target="_blank" href="https://help.disqus.com/customer/portal/articles/466259-privacy-policy">Privacy Policy</a>.
</div>

<input type="checkbox" name="author-guest" style="display:none">

<div class="proceed" data-role="submit-btn-container">
<button type="submit" class="proceed__button btn submit" aria-label="Next"><span class="icon-proceed"></span><div class="spinner"></div></button>
</div>
</div>
</div>
</section>

</div></div>
</div>
</form></div><button class="alert alert--realtime" data-role="realtime-notification" style="display: none;"></button><div id="no-posts" style="display: none;"></div><ul id="post-list" class="post-list"><li class="post" id="post-3169631450"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/arashmoaddel/" class="user" data-action="profile" data-username="arashmoaddel">
<img data-role="user-avatar" data-user="239868829" src="./avatar92.jpg" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/arashmoaddel/" data-action="profile" data-username="arashmoaddel" data-role="username">Arash Moaddel</a></span>

</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-3169631450" data-role="relative-time" class="time-ago" title="Wednesday, February 22, 2017 11:29 AM">
2 months ago
</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Hi and thanks for your code.<br>I was checking the code that you have posted on github , on this same post, and I noticed that in your code, after compiling the model , you are using the <a href="http://disq.us/url?url=http%3A%2F%2Fmodel.fit%3ArJseB4AYXEcVEh6fgSVDQvbOdyI&amp;cuid=4457424" rel="nofollow noopener">model.fit</a>() [line 95] and after that comes the model.train_on_batch</p><p>why have you used the fit method before training on batch loops ?</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="vote-up  count-1" data-action="upvote" title="">

<span class="updatable count" data-role="likes">1</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1gf47a2" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:3169631450">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"><li class="post" id="post-3204627037"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/philippe_r_my/" class="user" data-action="profile" data-username="philippe_r_my">
<img data-role="user-avatar" data-user="192968483" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/philippe_r_my/" data-action="profile" data-username="philippe_r_my" data-role="username">Philippe Rémy</a></span>

<span><a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-3169631450" class="parent-link" data-role="parent-link"><i aria-hidden="true" class="icon-forward" title="in reply to"></i> Arash Moaddel</a></span>
</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-3204627037" data-role="relative-time" class="time-ago" title="Tuesday, March 14, 2017 6:12 PM">
a month ago
</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Those are in two different IF blocks. They will never get executed at the same time. Either fit() or train_on_batch() depending on the condition.</p><p>UPDATE: My mistake. I call fit() one time but it does not change anything!</p><p>Thanks!</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1gzya1p" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:3204627037">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"><li class="post" id="post-3213370086"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/disqus_06pu6MQ5jY/" class="user" data-action="profile" data-username="disqus_06pu6MQ5jY">
<img data-role="user-avatar" data-user="246143979" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_06pu6MQ5jY/" data-action="profile" data-username="disqus_06pu6MQ5jY" data-role="username">Lucas Thompson</a></span>

<span><a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-3204627037" class="parent-link" data-role="parent-link"><i aria-hidden="true" class="icon-forward" title="in reply to"></i> Philippe Rémy</a></span>
</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-3213370086" data-role="relative-time" class="time-ago" title="Monday, March 20, 2017 8:05 AM">
a month ago
</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>I was wondering the same thing. There are two calls to fit made which are in both the if and else block.  On line 82 we enter the else block. On line 95 fit is called. In lines 102 through 112, which are in the same else block, train_on_batch is called. Possibly just some test code that was forgotten to delete?</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1h55o86" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:3213370086">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"><li class="post" id="post-3214782564"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/arashmoaddel/" class="user" data-action="profile" data-username="arashmoaddel">
<img data-role="user-avatar" data-user="239868829" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/arashmoaddel/" data-action="profile" data-username="arashmoaddel" data-role="username">Arash Moaddel</a></span>

<span><a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-3213370086" class="parent-link" data-role="parent-link"><i aria-hidden="true" class="icon-forward" title="in reply to"></i> Lucas Thompson</a></span>
</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-3214782564" data-role="relative-time" class="time-ago" title="Tuesday, March 21, 2017 3:45 AM">
a month ago
</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Yes <a data-dsq-mention="disqus_06pu6mq5jy:disqus" href="https://disqus.com/by/disqus_06pu6MQ5jY/" rel="nofollow noopener" data-action="profile" data-username="disqus_06pu6mq5jy" class="mention">Lucas Thompson</a>  , It doesn't seem to have any effects on train_on_bacth part. So I guess it can be deleted, although they are not in two different 'if' blocks <a data-dsq-mention="philippe_r_my:disqus" href="https://disqus.com/by/philippe_r_my/" rel="nofollow noopener" data-action="profile" data-username="philippe_r_my" class="mention">Philippe Rémy</a></p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1h5zy3o" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:3214782564">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"><li class="post" id="post-3222692239"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/philippe_r_my/" class="user" data-action="profile" data-username="philippe_r_my">
<img data-role="user-avatar" data-user="192968483" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/philippe_r_my/" data-action="profile" data-username="philippe_r_my" data-role="username">Philippe Rémy</a></span>

<span><a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-3214782564" class="parent-link" data-role="parent-link"><i aria-hidden="true" class="icon-forward" title="in reply to"></i> Arash Moaddel</a></span>
</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-3222692239" data-role="relative-time" class="time-ago" title="Saturday, March 25, 2017 2:45 AM">
a month ago
</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Yes actually you guys are right. I made a mistake by calling the fit() function everywhere (bad copy paste!). However, it does not change anything!</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1haph8v" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:3222692239">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"></ul>
</li></ul>
</li></ul>
</li></ul>
</li></ul>
</li><li class="post" id="post-2813184029"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/disqus_frKmsVnJGG/" class="user" data-action="profile" data-username="disqus_frKmsVnJGG">
<img data-role="user-avatar" data-user="216931341" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_frKmsVnJGG/" data-action="profile" data-username="disqus_frKmsVnJGG" data-role="username">RS</a></span>

</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-2813184029" data-role="relative-time" class="time-ago" title="Sunday, July 31, 2016 4:34 AM">
9 months ago
</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Really interesting! Thank you for sharing all that. I was really expecting the sub-sampling method with a stateful model to work better than that. However I think I still do not grasp totally the reason of that. How different is the input data from the LSTM's perspective when you sub sample or not? Is it related to the way the gradient is computed (after each sequence? after each batch?). If you don't mind giving your opinion on that, I'd highly appreciate!</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="vote-up  count-1" data-action="upvote" title="">

<span class="updatable count" data-role="likes">1</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1aiwaot" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2813184029">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"><li class="post" id="post-2826091256"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/philippe_r_my/" class="user" data-action="profile" data-username="philippe_r_my">
<img data-role="user-avatar" data-user="192968483" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/philippe_r_my/" data-action="profile" data-username="philippe_r_my" data-role="username">Philippe Rémy</a></span>

<span><a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-2813184029" class="parent-link" data-role="parent-link"><i aria-hidden="true" class="icon-forward" title="in reply to"></i> RS</a></span>
</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-2826091256" data-role="relative-time" class="time-ago" title="Sunday, August 7, 2016 7:16 PM">
9 months ago
</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Keep in mind that it's just a toy example. I think the sub-sampling can work good if you enforce that the full sequence is preserved through the batches, meaning that if X is my batch, I can concatenate X[i] and X[i+1] and it makes sense. I think the advantage of subsampling is that you can associate different targets to your sequence (like a many-to-many would do but at specific intervals e.g. every period of length 10, I generate an output). Let's consider a case where you have a sequence of length 1000 and you want to apply a stateful LSTM but with smaller sequences of length 10 (to have more data points). You can sub-sample by using the function prepare_sequences() from above. Instead of having a big sequence X of length 999 and trying to predict the 1000th value, you will have lots of smaller sequences of length 9 where you want to predict the 10th value. To make it work nicely, you have to enforce the ordering of your sequences (i.e. ban any shuffling when you call <a href="http://disq.us/url?url=http%3A%2F%2Fkeras.model.fit%3AWGfWaoR3pw8sTMxg6NrMqRQAevo&amp;cuid=4457424" rel="nofollow noopener">keras.model.fit</a>()) because otherwise you will lose the long term memory of your big sequence It's like sub-sampling from your big sequence and shuffle all your generated smaller sequences. It's important that X[0:9] comes before X[10:19] to keep the time axis value.<br>The gradient is always computed at the end of each batch. If your batch_size = 1, a batch becomes a single sequence and the gradient is computed at the end of this sequence.</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1aqkxyw" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2826091256">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"><li class="post" id="post-2837044309"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/disqus_NCbQCPFV88/" class="user" data-action="profile" data-username="disqus_NCbQCPFV88">
<img data-role="user-avatar" data-user="218511918" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_NCbQCPFV88/" data-action="profile" data-username="disqus_NCbQCPFV88" data-role="username">Phx</a></span>

<span><a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-2826091256" class="parent-link" data-role="parent-link"><i aria-hidden="true" class="icon-forward" title="in reply to"></i> Philippe Rémy</a></span>
</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-2837044309" data-role="relative-time" class="time-ago" title="Sunday, August 14, 2016 7:06 AM">
8 months ago
</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Hi, Can I just think it as: If we are in stateful=True mode, and I get a sequence X of 1000 feature, now I split the X into 10 subsequence with length = 100, for example as x1, x2,..,x10. Now I put x1 in the i-th place in batch #1(no matter how long the batch size is), x2 the same place in batch #2, and so on... When all the epoch ends, the lstm will get a long memory pattern of the whole sequence X.?</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1ax3ped" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2837044309">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"><li class="post" id="post-2848139090"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/philippe_r_my/" class="user" data-action="profile" data-username="philippe_r_my">
<img data-role="user-avatar" data-user="192968483" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/philippe_r_my/" data-action="profile" data-username="philippe_r_my" data-role="username">Philippe Rémy</a></span>

<span><a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-2837044309" class="parent-link" data-role="parent-link"><i aria-hidden="true" class="icon-forward" title="in reply to"></i> Phx</a></span>
</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-2848139090" data-role="relative-time" class="time-ago" title="Saturday, August 20, 2016 5:08 AM">
8 months ago
</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Let's consider stateful=True throughout this explanation.</p><p>If batch_size=1, yes to your question.</p><p>If batch_size is greater than 1 (2, 16, 32...), and if you want to keep your long memory, you must be careful. For this to work, you must ensure that x1 is indexed by i in batch_#1, x2 indexed by i in batch_#2, x3 indexed by i in batch_#3, where i MUST be the same across your batches (in your example it does not make sense to have a batch size different than 1. In your case, i=0). <br>When I say x3 indexed by i in batch#k, I mean if X_k is your k-th batch, X_k[i] = x3.</p><p>x1, ..., x10 = split(X)<br>batch_size = 1</p><p>LSTM_train(x1)<br>LSTM_train(x2)<br>LSTM_train(x3)<br>...<br>LSTM_train(x10)</p><p>will keep the long term memory because the cells are not reinitalized (stateful=True property).</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1b3pi6q" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2848139090">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"><li class="post" id="post-2970565116"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/disqus_gzpbp64ONX/" class="user" data-action="profile" data-username="disqus_gzpbp64ONX">
<img data-role="user-avatar" data-user="227891547" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_gzpbp64ONX/" data-action="profile" data-username="disqus_gzpbp64ONX" data-role="username">Rodrigo Pinto</a></span>

<span><a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-2848139090" class="parent-link" data-role="parent-link"><i aria-hidden="true" class="icon-forward" title="in reply to"></i> Philippe Rémy</a></span>
</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-2970565116" data-role="relative-time" class="time-ago" title="Wednesday, October 26, 2016 3:19 PM">
6 months ago
</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Why do people use sequences at all? Wouldn't it be better to always keep the long term memory?</p><p>Also, if a train a LSTM network in the stateless mode, and define the timestep = 1. Then what I am doing is simply train a kind of feedforward network right?</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1d4lipo" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2970565116">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"><li class="post" id="post-2970733733"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/philippe_r_my/" class="user" data-action="profile" data-username="philippe_r_my">
<img data-role="user-avatar" data-user="192968483" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/philippe_r_my/" data-action="profile" data-username="philippe_r_my" data-role="username">Philippe Rémy</a></span>

<span><a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-2970565116" class="parent-link" data-role="parent-link"><i aria-hidden="true" class="icon-forward" title="in reply to"></i> Rodrigo Pinto</a></span>
</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-2970733733" data-role="relative-time" class="time-ago" title="Wednesday, October 26, 2016 5:41 PM">
6 months ago
</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Probably because sometimes you don't want to carry over all the information from the whole sequence. Let's say you want to build a language model to model the english language. You will be interested to understand P( word1 | word2, word3 ...) and so on. But you may not want this sequence to be too big. For example you may not want to read the entire book to predict just the next word. Also I think it helps the network to gain stability when the inputs are more or less of the same length (to be confirmed). But, I agree that it would make sense for modelling Time Series where you may have very long term memory and when you don't know exactly when to cut.</p><p>LSTM Network in stateless and timestep = 1 will be a simple feedforward network. You will obviously still have all the architecture of the LSTM layers, including the gates and the states. But you will not ever the states[i-1] because you will never unroll across the time dimensions, because of timestep=1. Stateless will reset all your states every time so you lose the ability of having the states propagated across the training set.</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1d4p4th" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2970733733">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"></ul>
</li></ul>
</li></ul>
</li></ul>
</li></ul>
</li></ul>
</li><li class="post" id="post-3241942441"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/rahul_chandnani/" class="user" data-action="profile" data-username="rahul_chandnani">
<img data-role="user-avatar" data-user="247942784" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/rahul_chandnani/" data-action="profile" data-username="rahul_chandnani" data-role="username">Rahul Chandnani</a></span>

</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-3241942441" data-role="relative-time" class="time-ago" title="Wednesday, April 5, 2017 4:07 PM">
18 days ago
</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Hi,<br>I'm a student and I'm new in (LSTM) keras. I'll work on a project in which I have multivariate data (Bank Transactions).<br>Could you please tell me how to reshape data for input to LSTM, I have seen many examples for uni-variate data but couldn't find the example for multivariate data.</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1hm62sp" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:3241942441">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"></ul>
</li><li class="post" id="post-3214816607"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/arashmoaddel/" class="user" data-action="profile" data-username="arashmoaddel">
<img data-role="user-avatar" data-user="239868829" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/arashmoaddel/" data-action="profile" data-username="arashmoaddel" data-role="username">Arash Moaddel</a></span>

</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-3214816607" data-role="relative-time" class="time-ago" title="Tuesday, March 21, 2017 4:25 AM">
a month ago
</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>In stateless mode, Is the cell state reset after each sequence or each batch ?<br>In the 3rd question in the post u mention: At each sequence processing, this state array is reset.</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1h60odb" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:3214816607">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"></ul>
</li><li class="post" id="post-3212799792"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/disqus_HmGHBd5Vda/" class="user" data-action="profile" data-username="disqus_HmGHBd5Vda">
<img data-role="user-avatar" data-user="246100557" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_HmGHBd5Vda/" data-action="profile" data-username="disqus_HmGHBd5Vda" data-role="username">Bill Gao</a></span>

</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-3212799792" data-role="relative-time" class="time-ago" title="Sunday, March 19, 2017 10:24 PM">
a month ago
</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Let's say we have batch_size = 1, and samples (X_1, X_2, X_3, X_4, X_5) , the initial parameter for NN is alpha_0 <br>My question is in STATEFUL LSTM, the state of X_1 is computed by the initial parameter alpha_0, or is it computed by the updated parameter (say alpha_1) AFTER learning X_1; the state of X_2 is computed by the parameter alpha_1, or is it computed by the updated parameter (say alpha_2) AFTER learning X_2, etc.?</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1h4tg6o" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:3212799792">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"><li class="post" id="post-3222701790"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/philippe_r_my/" class="user" data-action="profile" data-username="philippe_r_my">
<img data-role="user-avatar" data-user="192968483" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/philippe_r_my/" data-action="profile" data-username="philippe_r_my" data-role="username">Philippe Rémy</a></span>

<span><a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-3212799792" class="parent-link" data-role="parent-link"><i aria-hidden="true" class="icon-forward" title="in reply to"></i> Bill Gao</a></span>
</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-3222701790" data-role="relative-time" class="time-ago" title="Saturday, March 25, 2017 3:02 AM">
a month ago
</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Notation: whenever I mention states, I mean (h,c).<br>The weights are called W (they do not comprise the states).</p><p>Let's consider bs=1, with stateful=True and your sequence (X_1, X_2, X_3, X_4, X_5), fed one at a time.</p><p>Your parameters and states are initialized to alpha_0 and W_0.<br>You feed X_1 to the model and the states are updated to alpha_1 and W_1 after X_1 is processed.<br>You feed X_2 to the model. At this moment, alpha_1 will be used and not alpha_0. Also W_1 will be used.<br>If you specified stateful=False, alpha_0 and W_1 would be used, instead of (alpha_1, W_1).</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1hapom6" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:3222701790">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"></ul>
</li></ul>
</li><li class="post" id="post-3212727689"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/jiajianhuang/" class="user" data-action="profile" data-username="jiajianhuang">
<img data-role="user-avatar" data-user="37425831" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/jiajianhuang/" data-action="profile" data-username="jiajianhuang" data-role="username">Jiajian</a></span>

</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-3212727689" data-role="relative-time" class="time-ago" title="Sunday, March 19, 2017 8:40 PM">
a month ago
</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>May I ask two questions ?</p><p>1. Why the model is trained in <a href="https://disq.us/url?url=https%3A%2F%2Fgist.github.com%2Fphilipperemy%2F7104d9072d7f9fde55abe1c76f8a33ed%23file-lstm-py-L108%3A57WFEHwNAZKABuxu2W5FyjWTgMg&amp;cuid=4457424" rel="nofollow noopener">https://gist.github.com/phi...</a> after `fit` in <a href="https://disq.us/url?url=https%3A%2F%2Fgist.github.com%2Fphilipperemy%2F7104d9072d7f9fde55abe1c76f8a33ed%23file-lstm-py-L95%3AA6IbM5fPejOOfschz0auZ7_jRSs&amp;cuid=4457424" rel="nofollow noopener">https://gist.github.com/phi...</a> ?</p><p>2. With a trainable `max_len` in practice, can we always use `USE_SEQUENCES = False` and `USE_STATELESS_MODEL = False` and forget about `statefulness`?</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1h4rwjt" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:3212727689">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"><li class="post" id="post-3222704188"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/philippe_r_my/" class="user" data-action="profile" data-username="philippe_r_my">
<img data-role="user-avatar" data-user="192968483" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/philippe_r_my/" data-action="profile" data-username="philippe_r_my" data-role="username">Philippe Rémy</a></span>

<span><a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-3212727689" class="parent-link" data-role="parent-link"><i aria-hidden="true" class="icon-forward" title="in reply to"></i> Jiajian</a></span>
</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-3222704188" data-role="relative-time" class="time-ago" title="Saturday, March 25, 2017 3:06 AM">
a month ago
</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Sure! Here are two answers.</p><p>1. That's a mistake. It does not have any effects though. Wrong copy/paste! Just remove the fit() function.<br>2. When you know exactly the size of your sequences (offline setup), you don't need to be stateful. The stateful mode is when you have online training. For example, you use stateful=True, when you receive one element every x seconds and you want to consider the whole as a sequence. Let's say you apply it to the stock market. You receive prices updates randomly. Between two values you don't want your states to be reset, right? You want to keep all the information. That's why you need statefulness. You need to have a control over your states.</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1hapqgs" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:3222704188">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"><li class="post" id="post-3248097610"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/siddharth_muthukumar/" class="user" data-action="profile" data-username="siddharth_muthukumar">
<img data-role="user-avatar" data-user="208763861" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/siddharth_muthukumar/" data-action="profile" data-username="siddharth_muthukumar" data-role="username">Siddharth Muthukumar</a></span>

<span><a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-3222704188" class="parent-link" data-role="parent-link"><i aria-hidden="true" class="icon-forward" title="in reply to"></i> Philippe Rémy</a></span>
</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-3248097610" data-role="relative-time" class="time-ago" title="Sunday, April 9, 2017 1:25 PM">
14 days ago
</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>However we knew the size of time sequence X in our example (shown by you in the post) and still switching from stateless to stateful proved advantageous as accuracy improved manifold. So is being stateful always good because we will be backpropagating more times with the states preserved as against stateless sub-sequencing based training?</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1hpu05m" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:3248097610">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"></ul>
</li></ul>
</li></ul>
</li><li class="post" id="post-3211446266"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/syedmoinudeen/" class="user" data-action="profile" data-username="syedmoinudeen">
<img data-role="user-avatar" data-user="246001985" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/syedmoinudeen/" data-action="profile" data-username="syedmoinudeen" data-role="username">Syed Moinudeen</a></span>

</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-3211446266" data-role="relative-time" class="time-ago" title="Saturday, March 18, 2017 11:35 PM">
a month ago
</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Hi Philippe, Thanks for writing this wonderful post. It has helped me understand stateful lstm clearly. <br>However , i have hit a roadblock somewhere. Please take a look at my problem.   <a href="https://disq.us/url?url=https%3A%2F%2Fgithub.com%2Ffchollet%2Fkeras%2Fissues%2F5857%3A-qrIsTFCvpMT-fzM3MFXely0JLo&amp;cuid=4457424" rel="nofollow noopener">https://github.com/fchollet...</a></p><p>I am using Stateful LSTM for time series prediction.  I input 5 features to the network. I am feeding the data for 50 days as input to predict the output for 51st day.  Could you please help me out?</p><p>Thanks!</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1h40fsq" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:3211446266">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"></ul>
</li><li class="post" id="post-3195403864"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/FedericoBecattini/" class="user" data-action="profile" data-username="FedericoBecattini">
<img data-role="user-avatar" data-user="75592058" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/FedericoBecattini/" data-action="profile" data-username="FedericoBecattini" data-role="username">Federico Becattini</a></span>

</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-3195403864" data-role="relative-time" class="time-ago" title="Thursday, March 9, 2017 2:47 PM">
a month ago
</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Hi, thanks for the great post! I'm trying to train an LSTM to predict sequences of values. The input data has variable length and the output data has the same length as the current input (so one output for each element in the input sequence). My task is actually more complex but you could think of it as a denoising task where given a noisy sequence you want to get the original signal.<br>I tried to implement it using a stateful lstm with batch_size=1 as in your example, training it by feeding just one sample at a time and restoring the memory after each sequence.</p><p>At prediction time, I often get the same output for each element in the sequence (which of course is bad). Eventually I realized that what I have trained is more similar to a sequence classification task since at each step it is trying to fit just one value. Is there a way to get N values at each timestep, where N is the number of samples already fed to the lstm? Is this the right way to proceed in you opinion? Thanks!</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1gugleg" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:3195403864">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"><li class="post" id="post-3205995468"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/disqus_Tdo8ImgQFV/" class="user" data-action="profile" data-username="disqus_Tdo8ImgQFV">
<img data-role="user-avatar" data-user="245630190" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_Tdo8ImgQFV/" data-action="profile" data-username="disqus_Tdo8ImgQFV" data-role="username">Nick</a></span>

<span><a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-3195403864" class="parent-link" data-role="parent-link"><i aria-hidden="true" class="icon-forward" title="in reply to"></i> Federico Becattini</a></span>
</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-3205995468" data-role="relative-time" class="time-ago" title="Wednesday, March 15, 2017 1:30 PM">
a month ago
</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Hi,</p><p>I am interested in sequence classification of multi-variate time sequences. Although I failed to implement this with LSTM. <br>I fed data in batch=1 and stateful=True with sliding (lagged) window of 7 days (my data is split by days). My network had accuracy 1 and loss 10^-6, which I believe is completely wrong.</p><p>Are there any chances you can put your findings into gist with some toy/random dataset? I am really interested to see what shapes of your X and Y and what is the shape of the sequence fed to neural network.</p><p>Thanks!</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1h0rlxo" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:3205995468">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"></ul>
</li><li class="post" id="post-3204642493"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/philippe_r_my/" class="user" data-action="profile" data-username="philippe_r_my">
<img data-role="user-avatar" data-user="192968483" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/philippe_r_my/" data-action="profile" data-username="philippe_r_my" data-role="username">Philippe Rémy</a></span>

<span><a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-3195403864" class="parent-link" data-role="parent-link"><i aria-hidden="true" class="icon-forward" title="in reply to"></i> Federico Becattini</a></span>
</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-3204642493" data-role="relative-time" class="time-ago" title="Tuesday, March 14, 2017 6:23 PM">
a month ago
</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p><a data-dsq-mention="federicobecattini:disqus" href="https://disqus.com/by/FedericoBecattini/" rel="nofollow noopener" data-action="profile" data-username="federicobecattini" class="mention">Federico Becattini</a> in your case you may use Masking. Have a look at this thread: <a href="https://disq.us/url?url=https%3A%2F%2Fgithub.com%2Ffchollet%2Fkeras%2Fissues%2F4624%3AUNTs3Ha5OfNSpbd9q9bjTNrVBi8&amp;cuid=4457424" rel="nofollow noopener">https://github.com/fchollet...</a>. Keras supports it.</p><p>Also I've uploaded an implementation of variable length LSTM with stateful mode here (But it's also with batch_size=1). <a href="https://disq.us/url?url=https%3A%2F%2Fgist.github.com%2Fphilipperemy%2F9dee137e504c863084fafae4d7b705e0%3AHjjPVyTQyuQA5I6wNJfOO06--Kc&amp;cuid=4457424" rel="nofollow noopener">https://gist.github.com/phi...</a></p><p>. What you can do is to batch all the sequences of the same length together if you don't want to use masking. For example all sequences of length 5 in a batch of 256. All sequences of length 10 in batch of 256. And so forth. In your case if you input the sequences at once into the LSTM you don't need to have stateful=True. This mode is when you want to feed your sequence over time and you don't want the states and cells to reset every time you resume your sequence.</p><p>Just as a summary: 2 main possibilities I'm thinking of: Masking and Same-length Batching.</p><p>To answer your last question, yes, feeding N values at each timestep is definitely a good way to proceed. Your gradients will be averaged over the N values and the training should be much smoother. Also do not forget to fine tune your network architecture and your learning rate. If you have more data, a complex network is preferable. According to one important deep learning theorem, the local minima are very close to the global minimum for very deep neural networks.</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1gzylz1" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:3204642493">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"></ul>
</li></ul>
</li><li class="post" id="post-3152028260"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/disqus_VNYd6bVME9/" class="user" data-action="profile" data-username="disqus_VNYd6bVME9">
<img data-role="user-avatar" data-user="225400184" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_VNYd6bVME9/" data-action="profile" data-username="disqus_VNYd6bVME9" data-role="username">Thai Le</a></span>

</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-3152028260" data-role="relative-time" class="time-ago" title="Monday, February 13, 2017 1:26 AM">
2 months ago
</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Hi Thank you for such instructive note. Here is the code to evaluate on predict dataset if I want to use the callback() to reset the states of the LSTM layer. Hope this helps anyone trying convince that the two implementations (resetting by callback and manually reset) are the same.</p><p>testx = np.expand_dims(np.expand_dims(X_test.flatten(), axis=1), axis=1)<br>    testy = np.expand_dims(np.array([[v] * max_len for v in y_test.flatten()]).flatten(), axis=1)<br>    mean_te_acc = []<br>    mean_te_loss = []<br>    for i in xrange(0, testx.shape[0], 1):<br>  if (i % max_len == 0):<br>  model.reset_states()<br>  te_loss, te_acc = model.test_on_batch(np.expand_dims(testx[i], axis = 1), [testy[i]])<br>  mean_te_acc.append(te_acc)<br>  mean_te_loss.append(te_loss)<br>    print('accuracy testing = {}'.format(np.mean(mean_te_acc)))<br>    print('loss testing = {}'.format(np.mean(mean_te_loss)))</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1g4mwkk" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:3152028260">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"><li class="post" id="post-3204624876"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/philippe_r_my/" class="user" data-action="profile" data-username="philippe_r_my">
<img data-role="user-avatar" data-user="192968483" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/philippe_r_my/" data-action="profile" data-username="philippe_r_my" data-role="username">Philippe Rémy</a></span>

<span><a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-3152028260" class="parent-link" data-role="parent-link"><i aria-hidden="true" class="icon-forward" title="in reply to"></i> Thai Le</a></span>
</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-3204624876" data-role="relative-time" class="time-ago" title="Tuesday, March 14, 2017 6:11 PM">
a month ago
</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Thanks <a data-dsq-mention="disqus_vnyd6bvme9:disqus" href="https://disqus.com/by/disqus_VNYd6bVME9/" rel="nofollow noopener" data-action="profile" data-username="disqus_vnyd6bvme9" class="mention">Thai Le</a> !</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1gzy8do" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:3204624876">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"></ul>
</li></ul>
</li><li class="post" id="post-3050344438"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/disqus_E360aD52Hb/" class="user" data-action="profile" data-username="disqus_E360aD52Hb">
<img data-role="user-avatar" data-user="234813818" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_E360aD52Hb/" data-action="profile" data-username="disqus_E360aD52Hb" data-role="username">Goulou</a></span>

</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-3050344438" data-role="relative-time" class="time-ago" title="Tuesday, December 13, 2016 9:41 AM">
4 months ago
</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>(wrong comment)</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1eg3gty" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:3050344438">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"></ul>
</li><li class="post" id="post-3029867928"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/disqus_8gon2cRIuO/" class="user" data-action="profile" data-username="disqus_8gon2cRIuO">
<img data-role="user-avatar" data-user="177619180" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_8gon2cRIuO/" data-action="profile" data-username="disqus_8gon2cRIuO" data-role="username">Francisco Raposo</a></span>

</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-3029867928" data-role="relative-time" class="time-ago" title="Thursday, December 1, 2016 10:20 AM">
5 months ago
</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Hey, great explanation! I have, however, some questions:<br>1) If my GPU has enough memory, is there any advantage (e.g., training time and so on) in using larger batches?<br>2) Assuming I have a batch size &gt; 1 and:<br>  a) the total number of samples is not dividable by the batch size. Is this gonna be a problem? I ask this because we set the batch size for network and by having a sample size not multiple of the batch size will mean that my last batch will be smaller than the specified batch size...<br>  b) do my prediction/evaluation batches need to be the same size as the one we set for the network, or is that just important for training?</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1e3wl20" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:3029867928">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"><li class="post" id="post-3222709482"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/philippe_r_my/" class="user" data-action="profile" data-username="philippe_r_my">
<img data-role="user-avatar" data-user="192968483" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/philippe_r_my/" data-action="profile" data-username="philippe_r_my" data-role="username">Philippe Rémy</a></span>

<span><a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-3029867928" class="parent-link" data-role="parent-link"><i aria-hidden="true" class="icon-forward" title="in reply to"></i> Francisco Raposo</a></span>
</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-3222709482" data-role="relative-time" class="time-ago" title="Saturday, March 25, 2017 3:15 AM">
a month ago
</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Thanks! Let me answer your questions.</p><p>1/ A larger batch is always better. The rule of thumbs is to have the largest possible batch your GPU can handle. The bigger your gradients are, the more accurate and smooth they will be. If you have batch_size=1, you can still converge to an optimal value, but it will be way more chaotic (much higher variance but still unbiased). And it will be way slower!</p><p>2/a/ It depends on the framework, I think Keras can handle it when the number of samples is not dividable for the batch size. <br>Correct, your last batch will be smaller than the specified batch size. But if you have 60,000 samples and a batch size of 128, having the last batch with 96 elements is not a big deal. It will have no visible effects.<br>2/b/ again it depends on the framework. In Keras, I don't think so! You should be able to give anything to the network.</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1hapuju" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:3222709482">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"></ul>
</li></ul>
</li><li class="post" id="post-2966113419"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/eyalgruss/" class="user" data-action="profile" data-username="eyalgruss">
<img data-role="user-avatar" data-user="181167657" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/eyalgruss/" data-action="profile" data-username="eyalgruss" data-role="username">Eyal Gruss</a></span>

</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-2966113419" data-role="relative-time" class="time-ago" title="Monday, October 24, 2016 4:06 AM">
6 months ago
</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>thanks for this elaborate post.<br>1)  could you elaborate on: "it seems that the callbacks are not properly called when using the parameter validation_data"? is there an issue for that?<br>2) i understand that the model needs to know the batch size but why does it need to know the number of timesteps? why could we not pass something like batch_input_size=(batch_size, None, nb_features) ?</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1d1y3rf" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2966113419">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"><li class="post" id="post-2966259590"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/philippe_r_my/" class="user" data-action="profile" data-username="philippe_r_my">
<img data-role="user-avatar" data-user="192968483" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/philippe_r_my/" data-action="profile" data-username="philippe_r_my" data-role="username">Philippe Rémy</a></span>

<span><a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-2966113419" class="parent-link" data-role="parent-link"><i aria-hidden="true" class="icon-forward" title="in reply to"></i> Eyal Gruss</a></span>
</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-2966259590" data-role="relative-time" class="time-ago" title="Monday, October 24, 2016 6:23 AM">
6 months ago
</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Hey,<br>1. From the code, you can see that the callbacks are only applied during training. I don't think they will be called during validation. To be confirmed. <a href="https://disq.us/url?url=https%3A%2F%2Fgithub.com%2Ffchollet%2Fkeras%2Fblob%2Fmaster%2Fkeras%2Fmodels.py%23L571%3AJlQdskxxJrbn1AKC_vvL0J3_aNc&amp;cuid=4457424" rel="nofollow noopener">https://github.com/fchollet...</a>. The issue is that your model would perform good on training data but badly on validation data. Again to be confirmed.<br>2. Probably because of Tensorflow and Theano at the same time. Theano compiles the code first so it may have to know this dimension for the RNN (C++/CUDA). Conceptually, this should not be a problem if time_steps is unknown at the model declaration. This is why I think it's more a technical issue related to the backend frameworks.</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1d218jq" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2966259590">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"><li class="post" id="post-2968340621"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/eyalgruss/" class="user" data-action="profile" data-username="eyalgruss">
<img data-role="user-avatar" data-user="181167657" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/eyalgruss/" data-action="profile" data-username="eyalgruss" data-role="username">Eyal Gruss</a></span>

<span><a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-2966259590" class="parent-link" data-role="parent-link"><i aria-hidden="true" class="icon-forward" title="in reply to"></i> Philippe Rémy</a></span>
</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-2968340621" data-role="relative-time" class="time-ago" title="Tuesday, October 25, 2016 10:30 AM">
6 months ago
</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p><a href="https://disq.us/url?url=https%3A%2F%2Fgithub.com%2Ffchollet%2Fkeras%2Fissues%2F4185%3AuVV36i3yGsY9Tq1Jwfna5us8SeM&amp;cuid=4457424" rel="nofollow noopener">https://github.com/fchollet...</a></p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1d39ua5" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2968340621">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"><li class="post" id="post-2970724267"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/philippe_r_my/" class="user" data-action="profile" data-username="philippe_r_my">
<img data-role="user-avatar" data-user="192968483" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/philippe_r_my/" data-action="profile" data-username="philippe_r_my" data-role="username">Philippe Rémy</a></span>

<span><a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-2968340621" class="parent-link" data-role="parent-link"><i aria-hidden="true" class="icon-forward" title="in reply to"></i> Eyal Gruss</a></span>
</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-2970724267" data-role="relative-time" class="time-ago" title="Wednesday, October 26, 2016 5:32 PM">
6 months ago
</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Thanks for opening this issue!</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1d4oxij" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2970724267">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"></ul>
</li></ul>
</li><li class="post" id="post-2966267521"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/eyalgruss/" class="user" data-action="profile" data-username="eyalgruss">
<img data-role="user-avatar" data-user="181167657" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/eyalgruss/" data-action="profile" data-username="eyalgruss" data-role="username">Eyal Gruss</a></span>

<span><a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-2966259590" class="parent-link" data-role="parent-link"><i aria-hidden="true" class="icon-forward" title="in reply to"></i> Philippe Rémy</a></span>
</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-2966267521" data-role="relative-time" class="time-ago" title="Monday, October 24, 2016 6:29 AM">
6 months ago
</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>in theano for the stateless case you can pass input_size=(None, nb_features)</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1d21eo1" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2966267521">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"><li class="post" id="post-2970724741"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/philippe_r_my/" class="user" data-action="profile" data-username="philippe_r_my">
<img data-role="user-avatar" data-user="192968483" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/philippe_r_my/" data-action="profile" data-username="philippe_r_my" data-role="username">Philippe Rémy</a></span>

<span><a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-2966267521" class="parent-link" data-role="parent-link"><i aria-hidden="true" class="icon-forward" title="in reply to"></i> Eyal Gruss</a></span>
</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-2970724741" data-role="relative-time" class="time-ago" title="Wednesday, October 26, 2016 5:32 PM">
6 months ago
</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>I have clearly no ideas here! Probably related to TF then!</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1d4oxvp" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2970724741">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"><li class="post" id="post-2970729297"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/eyalgruss/" class="user" data-action="profile" data-username="eyalgruss">
<img data-role="user-avatar" data-user="181167657" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/eyalgruss/" data-action="profile" data-username="eyalgruss" data-role="username">Eyal Gruss</a></span>

<span><a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-2970724741" class="parent-link" data-role="parent-link"><i aria-hidden="true" class="icon-forward" title="in reply to"></i> Philippe Rémy</a></span>
</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-2970729297" data-role="relative-time" class="time-ago" title="Wednesday, October 26, 2016 5:36 PM">
6 months ago
</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Turns out you can pass none for the timestip also for stateful rnns<br></p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1d4p1e9" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2970729297">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"></ul>
</li></ul>
</li></ul>
</li></ul>
</li></ul>
</li><li class="post" id="post-2906446690"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/Higgcz/" class="user" data-action="profile" data-username="Higgcz">
<img data-role="user-avatar" data-user="1650207" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/Higgcz/" data-action="profile" data-username="Higgcz" data-role="username">Vojtěch Micka</a></span>

</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-2906446690" data-role="relative-time" class="time-ago" title="Tuesday, September 20, 2016 6:04 AM">
7 months ago
</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container" style="height: 374px;">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Hi, thanks for the post.</p><p>May I ask something, I'm fighting with stateful LSTMs for couple of day.</p><p>I'm trying to use the stateful LSTM layer, but kinda without success. My model is quite simple, at the beginning I have few TimeDistributed Convolutional layers followed with ReLu and TimeDistributed MaxPooling:</p><p>model.add(TimeDistributed(Convolution2D(32, 3, 3, border_mode='same'), batch_input_shape = (batch_size, 1, img_channels, img_rows, img_cols)))<br>model.add(Activation('relu'))<br>model.add(TimeDistributed(MaxPooling2D(pool_size = (2,2))))<br>...<br>model.add(TimeDistributed(Flatten()))<br>model.add(LSTM(32, stateful = True, return_sequences = False))<br>...</p><p>However during adding the first layer I'm getting error "No initial states provided.", which is obviously connected with the fact, I'm specifying "batch_size", if I replace "batch_size" with None or if I define just "input_shape" the layer is successfully added to the model, but then I get the error during adding the LSTM layer, because I didn't define "batch_size".</p><p>This problem is certainly caused by TensorFlow backend, so I've tried to change it to Theano, however that make things even weirder. I was able to compile the model, but the model isn't able to learn, at least on GPU. When I try to learn the model, the loss becomes "nan" and accuracy becomes 0 after few epochs of training. I also set the theano flag "mode" to NanGuard, which gives me an output I'm not really sure how to properly interpret.</p><p>Anyway Theano is really slow comparing to TensorFlow, so I would prefer to solve the TensorFlow problem first.</p><p>Do you or anyone have some experience with similar problems? I would appreciate any help, thanks!</p><p>Vojta</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1c2f8ma" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2906446690">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"><li class="post" id="post-2966266219"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/philippe_r_my/" class="user" data-action="profile" data-username="philippe_r_my">
<img data-role="user-avatar" data-user="192968483" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/philippe_r_my/" data-action="profile" data-username="philippe_r_my" data-role="username">Philippe Rémy</a></span>

<span><a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-2906446690" class="parent-link" data-role="parent-link"><i aria-hidden="true" class="icon-forward" title="in reply to"></i> Vojtěch Micka</a></span>
</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-2966266219" data-role="relative-time" class="time-ago" title="Monday, October 24, 2016 6:28 AM">
6 months ago
</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Probably it's a problem of backend/bug in Keras/Tensorflow as you mentioned. What I can tell is that you have to define explicitly your batch size when you use the stateful model. In this case, all the layers should have this information specified at their definition.</p><p>I don't have much experience with this complex architecture. Better find a way to define it as stateless! Could be worth investigating for making a pull request.</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1d21dnv" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2966266219">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"></ul>
</li></ul>
</li><li class="post" id="post-2877703581"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/keshav_mathur/" class="user" data-action="profile" data-username="keshav_mathur">
<img data-role="user-avatar" data-user="220230453" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/keshav_mathur/" data-action="profile" data-username="keshav_mathur" data-role="username">Keshav Mathur</a></span>

</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-2877703581" data-role="relative-time" class="time-ago" title="Monday, September 5, 2016 11:55 AM">
8 months ago
</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Do you have an example for a time series prediction in this fashion?</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1blb6al" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2877703581">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"><li class="post" id="post-2966264939"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/philippe_r_my/" class="user" data-action="profile" data-username="philippe_r_my">
<img data-role="user-avatar" data-user="192968483" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/philippe_r_my/" data-action="profile" data-username="philippe_r_my" data-role="username">Philippe Rémy</a></span>

<span><a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-2877703581" class="parent-link" data-role="parent-link"><i aria-hidden="true" class="icon-forward" title="in reply to"></i> Keshav Mathur</a></span>
</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-2966264939" data-role="relative-time" class="time-ago" title="Monday, October 24, 2016 6:27 AM">
6 months ago
</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>I still have to implement something but it should not be too difficult. I'll do that when I have time!</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1d21cob" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2966264939">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"></ul>
</li></ul>
</li><li class="post" id="post-2829693794"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/disqus_qW0mssUp3H/" class="user" data-action="profile" data-username="disqus_qW0mssUp3H">
<img data-role="user-avatar" data-user="218033942" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/disqus_qW0mssUp3H/" data-action="profile" data-username="disqus_qW0mssUp3H" data-role="username">yongqiang</a></span>

</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-2829693794" data-role="relative-time" class="time-ago" title="Tuesday, August 9, 2016 7:34 PM">
8 months ago
</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Thank you for your post!</p><p>I have a question: is it true that:</p><p>the "state" is preserved for every sample of any sequence WITHIN a batch?</p><p>I ask this because I want to know what would happen if you use the entire row of X as a sequence, and set "stateful=False". This way different batches would have nothing to share, but would each sequence within a batch still be "stateful"? Would it be equivalent to using each sample of a sequence at a time and set "stateful=True", as your second case does?</p><p>Thank you!</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1asq5pe" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2829693794">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"><li class="post" id="post-2836403549"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/philippe_r_my/" class="user" data-action="profile" data-username="philippe_r_my">
<img data-role="user-avatar" data-user="192968483" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/philippe_r_my/" data-action="profile" data-username="philippe_r_my" data-role="username">Philippe Rémy</a></span>

<span><a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-2829693794" class="parent-link" data-role="parent-link"><i aria-hidden="true" class="icon-forward" title="in reply to"></i> yongqiang</a></span>
</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-2836403549" data-role="relative-time" class="time-ago" title="Saturday, August 13, 2016 6:54 PM">
8 months ago
</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Hey,</p><p>Within a batch, each sequence has its OWN states. Also each sequence is seen as independent from the other sequences in the batch. If your batch is Y, sequences Y[1] and Y[2] will never have something in common (whatever stateful=False or stateful=True).</p><p>If the LSTM has the stateful mode, the states of the current batch will be propagated to the next batch (at index i). Batching sequences is only to speed up the computations on a GPU.</p><p>Let's consider a matrix X with 1024 rows and a batch size of 32.<br>In the first place, let's consider each row of X as a sequence (1024 sequences) and stateful=False. You're in the default Keras setup. It means that each sequence has its states propagated throughout all the sequence BUT each sequence has its own states and there is nothing shared in the batch with the other sequences (the first dimension of the states tensor is the batch_size). So in your own terms, each sequence within a batch will be stateful because that's the purpose of a recurrent neural network.</p><p>Again if you consider sample as sub-sequence (of length 1), and you set stateful=True, the case is different, because we are working in a supervised learning context. You have to provide more targets Y because you have more sequences (= 1024 x nb_columns) where shape(X) = (1024, nb_columns).</p><p>Hope this helps :)</p><p>Thanks!</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1awpyzh" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2836403549">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"></ul>
</li></ul>
</li><li class="post" id="post-2824952813"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/jansdf/" class="user" data-action="profile" data-username="jansdf">
<img data-role="user-avatar" data-user="217731479" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/jansdf/" data-action="profile" data-username="jansdf" data-role="username">jansdf</a></span>

</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-2824952813" data-role="relative-time" class="time-ago" title="Sunday, August 7, 2016 12:17 AM">
9 months ago
</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>do you have the github  code of all code here  ? <br>thanks</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1apwjjh" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2824952813">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"><li class="post" id="post-2826077263"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/philippe_r_my/" class="user" data-action="profile" data-username="philippe_r_my">
<img data-role="user-avatar" data-user="192968483" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/philippe_r_my/" data-action="profile" data-username="philippe_r_my" data-role="username">Philippe Rémy</a></span>

<span><a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-2824952813" class="parent-link" data-role="parent-link"><i aria-hidden="true" class="icon-forward" title="in reply to"></i> jansdf</a></span>
</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-2826077263" data-role="relative-time" class="time-ago" title="Sunday, August 7, 2016 7:00 PM">
9 months ago
</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Hey!<br>Yes I've just uploaded it here at : <a href="https://disq.us/url?url=https%3A%2F%2Fgist.github.com%2Fphilipperemy%2F7104d9072d7f9fde55abe1c76f8a33ed%3A0yhY24jGZJjSWIDI3Z68grCjQZc&amp;cuid=4457424" rel="nofollow noopener">https://gist.github.com/phi...</a></p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1aqkn67" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2826077263">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"></ul>
</li></ul>
</li><li class="post" id="post-2882202213"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/danielhershcovich/" class="user" data-action="profile" data-username="danielhershcovich">
<img data-role="user-avatar" data-user="91823785" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/danielhershcovich/" data-action="profile" data-username="danielhershcovich" data-role="username">Daniel Hershcovich</a></span>

</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-2882202213" data-role="relative-time" class="time-ago" title="Thursday, September 8, 2016 1:37 AM">
8 months ago
</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>Thanks, this is a very clear explanation.</p><p>What I'm still having trouble with, though, is actually the case of `batch_size &gt; 1` and also `return_sequences=True`. Do you think you could add an example for those case?</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-1" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1bnzlgl" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2882202213">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"><li class="post" id="post-2944131603"><div role="alert"></div>
<div data-role="post-content" class="post-content">
<ul class="post-menu dropdown" data-role="menu">
<li class="collapse">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Collapse"><span>−</span></a>
</li>
<li class="expand">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="collapse" title="Expand"><span>+</span></a>
</li>

<li class="" role="menu">
<a class="dropdown-toggle" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="flag" data-role="flag" title="Flag as inappropriate">
<i aria-hidden="true" class="icon icon-flag"></i>
</a>
</li>
</ul>

<div class="indicator"></div>

<div class="avatar hovercard">
<a href="https://disqus.com/by/philippe_r_my/" class="user" data-action="profile" data-username="philippe_r_my">
<img data-role="user-avatar" data-user="192968483" src="./noavatar92.png" alt="Avatar">
</a>
</div>
<div class="post-body">
<header class="comment__header">
<span class="post-byline">
<span class="author publisher-anchor-color"><a href="https://disqus.com/by/philippe_r_my/" data-action="profile" data-username="philippe_r_my" data-role="username">Philippe Rémy</a></span>

<span><a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-2882202213" class="parent-link" data-role="parent-link"><i aria-hidden="true" class="icon-forward" title="in reply to"></i> Daniel Hershcovich</a></span>
</span>

<span class="post-meta">
<span class="bullet time-ago-bullet" aria-hidden="true">•</span>

<a href="http://philipperemy.github.io/keras-stateful-lstm/#comment-2944131603" data-role="relative-time" class="time-ago" title="Monday, October 10, 2016 7:45 PM">
6 months ago
</a>
</span>

</header>

<div class="post-body-inner">
<div class="post-message-container" data-role="message-container">
<div class="publisher-anchor-color" data-role="message-content">
<div class="post-message " data-role="message" dir="auto">
<p>I'll write an example whenever I have time! Thanks!</p>
</div>

<span class="post-media"><ul data-role="post-media-list"></ul></span>
</div>
</div>
<a class="see-more hidden" title="see more" data-action="see-more">see more</a>
</div>

<footer class="comment__footer"><menu class="comment-footer__menu">
<li class="voting" data-role="voting">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="vote-up  count-0" data-action="upvote" title="Vote up">

<span class="updatable count" data-role="likes">0</span>
<span class="control"><i aria-hidden="true" class="icon icon-arrow-2"></i></span>
</a>
<span role="button" class="vote-down  count-0" data-action="downvote" title="Vote down">

<span class="control"><i aria-hidden="true" class="icon icon-arrow"></i></span>
</span>
</li>
<li class="bullet" aria-hidden="true">•</li>


<li class="reply" data-role="reply-link">
<a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="reply">
<span class="text">Reply</span></a></li>
<li class="bullet" aria-hidden="true">•</li>


<li class="comment__share">
<a class="toggle"><span class="text">Share ›</span></a>
<ul class="comment-share__buttons">
<li class="twitter">
<button class="share__button" data-action="share:twitter">Twitter</button>
</li>
<li class="facebook">
<button class="share__button" data-action="share:facebook">Facebook</button>
</li>
<li class="link">
<input class="share__button" value="http://disq.us/p/1couyhf" name="Link" title="Click to copy post link" data-action="copy-link" readonly="">
</li>
</ul>
</li>

<li class="realtime" data-role="realtime-notification:2944131603">
<span style="display:none;" class="realtime-replies"></span>
<a style="display:none;" href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" class="realtime-button"></a>
</li>

</menu>
</footer>
</div>

<div data-role="blacklist-form"></div>
<div class="reply-form-container" data-role="reply-form"></div>
</div>

<ul data-role="children" class="children"></ul>
</li></ul>
</li></ul><div class="load-more" data-role="more" style="display: none;"><a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" data-action="more-posts" class="btn load-more__button">Load more comments</a></div></div></section><div id="placement-bottom" data-tracking-area="discovery-south"><div class="post-list" style="height: auto; visibility: visible;"><div style="display: block; width: 100%;"><div id="discovery-main-c345" class="discovery-main">

<section id="col-organic-c998" class="col-organic">
<header class="discovery-col-header">
<h2>Also on <strong>philipperemy.github.io</strong>
</h2>
</header>
<ul class="discovery-posts" data-role="discovery-posts"><li class="discovery-post post-0" id="discovery-link-organic-5262383334">
<a href="http://disq.us/url?url=http%3A%2F%2Fphilipperemy.github.io%2Fanomaly-detection%2F%3AV68Ka5ehMVcanxPOzuqPmU-D_GA&amp;imp=2oraae6682sqg&amp;prev_imp&amp;forum_id=4457424&amp;forum=philipperemy-github-io-1&amp;thread_id=5028095624&amp;thread=5262383334&amp;zone=thread&amp;area=bottom&amp;object_type=thread&amp;object_id=5262383334" class="publisher-anchor-color">

<header class="discovery-post-header">
<h3 title="Anomaly Detection in Time Series using Auto Encoders">
<span data-role="discovery-thread-title" class="title line-truncate" data-line-truncate="2">
Anomaly Detection in Time Series using Auto Encoders
</span>
</h3>

<ul class="meta">
<li class="comments">
1 comment
</li>
<li class="time">6 months ago</li>
</ul>
</header>

</a><a href="http://disq.us/url?url=http%3A%2F%2Fphilipperemy.github.io%2Fanomaly-detection%2F%3AV68Ka5ehMVcanxPOzuqPmU-D_GA&amp;imp=2oraae6682sqg&amp;prev_imp&amp;forum_id=4457424&amp;forum=philipperemy-github-io-1&amp;thread_id=5028095624&amp;thread=5262383334&amp;zone=thread&amp;area=bottom&amp;object_type=thread&amp;object_id=5262383334" class="top-comment" data-role="discovery-top-comment">
<img alt="Avatar" data-role="discovery-avatar">
<p><span class="user" data-role="discovery-top-comment-author">Edouard Fouché</span> — <span data-role="discovery-top-comment-snippet" class="line-truncate" data-line-truncate="3"> Hi, thank you for the nice article ! I found it quite insightful. I wrote a kind of related article, with a focus on high-dimensional data. Maybe some people here would find it …</span></p>
</a>

</li>
<li class="discovery-post post-1" id="discovery-link-organic-5025706203">
<a href="http://disq.us/url?url=http%3A%2F%2Fphilipperemy.github.io%2Finformation-extract%2F%3ArW1XeE2W48C_g-VqMpFsldaH4Y8&amp;imp=2oraae6682sqg&amp;prev_imp&amp;forum_id=4457424&amp;forum=philipperemy-github-io-1&amp;thread_id=5028095624&amp;thread=5025706203&amp;zone=thread&amp;area=bottom&amp;object_type=thread&amp;object_id=5025706203" class="publisher-anchor-color">

<header class="discovery-post-header">
<h3 title="Information Extraction with Stanford NLP – Philippe Remy – My Blog.">
<span data-role="discovery-thread-title" class="title line-truncate" data-line-truncate="2">
Information Extraction with Stanford NLP – Philippe Remy – My Blog.
</span>
</h3>

<ul class="meta">
<li class="comments">
1 comment
</li>
<li class="time">9 months ago</li>
</ul>
</header>

</a><a href="http://disq.us/url?url=http%3A%2F%2Fphilipperemy.github.io%2Finformation-extract%2F%3ArW1XeE2W48C_g-VqMpFsldaH4Y8&amp;imp=2oraae6682sqg&amp;prev_imp&amp;forum_id=4457424&amp;forum=philipperemy-github-io-1&amp;thread_id=5028095624&amp;thread=5025706203&amp;zone=thread&amp;area=bottom&amp;object_type=thread&amp;object_id=5025706203" class="top-comment" data-role="discovery-top-comment">
<img alt="Avatar" data-role="discovery-avatar">
<p><span class="user" data-role="discovery-top-comment-author">Rui Zhang</span> — <span data-role="discovery-top-comment-snippet" class="line-truncate" data-line-truncate="3"> nice one, can you combine these relationship into one? let's see in your example. joins, move over, will move..etc. are all the same, can you pre define some rules that capture these words …</span></p>
</a>

</li>
<li class="discovery-post post-2" id="discovery-link-organic-5025710555">
<a href="http://disq.us/url?url=http%3A%2F%2Fphilipperemy.github.io%2Fconfigure_gpu_for_deep_learning%2F%3AzRINM_1fRYLOZsV0fsAEjhkBi2g&amp;imp=2oraae6682sqg&amp;prev_imp&amp;forum_id=4457424&amp;forum=philipperemy-github-io-1&amp;thread_id=5028095624&amp;thread=5025710555&amp;zone=thread&amp;area=bottom&amp;object_type=thread&amp;object_id=5025710555" class="publisher-anchor-color">

<header class="discovery-post-header">
<h3 title="Configuration of a GPU for Deep Learning (Theano)">
<span data-role="discovery-thread-title" class="title line-truncate" data-line-truncate="2">
Configuration of a GPU for Deep Learning (Theano)
</span>
</h3>

<ul class="meta">
<li class="comments">
1 comment
</li>
<li class="time">9 months ago</li>
</ul>
</header>

</a><a href="http://disq.us/url?url=http%3A%2F%2Fphilipperemy.github.io%2Fconfigure_gpu_for_deep_learning%2F%3AzRINM_1fRYLOZsV0fsAEjhkBi2g&amp;imp=2oraae6682sqg&amp;prev_imp&amp;forum_id=4457424&amp;forum=philipperemy-github-io-1&amp;thread_id=5028095624&amp;thread=5025710555&amp;zone=thread&amp;area=bottom&amp;object_type=thread&amp;object_id=5025710555" class="top-comment" data-role="discovery-top-comment">
<img alt="Avatar" data-role="discovery-avatar">
<p><span class="user" data-role="discovery-top-comment-author">Philippe Rémy</span> — <span data-role="discovery-top-comment-snippet" class="line-truncate" data-line-truncate="3">These steps also work with the latest Titan X.</span></p>
</a>

</li>
<li class="discovery-post post-3" id="discovery-link-organic-5280726646">
<a href="http://disq.us/url?url=http%3A%2F%2Fphilipperemy.github.io%2Ftinder-deep-learning%2F%3AfBrpIC_14-c9Zxn6G6pecYJQYBw&amp;imp=2oraae6682sqg&amp;prev_imp&amp;forum_id=4457424&amp;forum=philipperemy-github-io-1&amp;thread_id=5028095624&amp;thread=5280726646&amp;zone=thread&amp;area=bottom&amp;object_type=thread&amp;object_id=5280726646" class="publisher-anchor-color">

<header class="discovery-post-header">
<h3 title="Deep Learning (Machine Learning) applied to Tinder">
<span data-role="discovery-thread-title" class="title line-truncate" data-line-truncate="2">
Deep Learning (Machine Learning) applied to Tinder
</span>
</h3>

<ul class="meta">
<li class="comments">
7 comments
</li>
<li class="time">6 months ago</li>
</ul>
</header>

</a><a href="http://disq.us/url?url=http%3A%2F%2Fphilipperemy.github.io%2Ftinder-deep-learning%2F%3AfBrpIC_14-c9Zxn6G6pecYJQYBw&amp;imp=2oraae6682sqg&amp;prev_imp&amp;forum_id=4457424&amp;forum=philipperemy-github-io-1&amp;thread_id=5028095624&amp;thread=5280726646&amp;zone=thread&amp;area=bottom&amp;object_type=thread&amp;object_id=5280726646" class="top-comment" data-role="discovery-top-comment">
<img alt="Avatar" data-role="discovery-avatar">
<p><span class="user" data-role="discovery-top-comment-author">Philippe Rémy</span> — <span data-role="discovery-top-comment-snippet" class="line-truncate" data-line-truncate="3"> 1/ correct!2/ correct!3/ correct!Manually selecting the LIKE and NOPE pictures would be the most ideal, but far too time consuming - at 100 a day it would take 3 years. I think you're …</span></p>
</a>

</li>
</ul>
</section>

</div>
</div></div></div><div id="footer" data-tracking-area="footer" class="disqus-footer__wrapper"><ul class="disqus-footer"><li class="disqus-footer__logo"><a href="https://disqus.com/" rel="nofollow" title="Powered by Disqus" class="disqus-footer__link">Powered by Disqus</a></li><li id="thread-subscribe-button" class="email disqus-footer__item"><div class="default"><a href="https://disqus.com/embed/comments/?base=default&amp;f=philipperemy-github-io-1&amp;t_u=http%3A%2F%2Fphilipperemy.github.io%2Fkeras-stateful-lstm%2F&amp;t_d=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;t_t=Stateful%20LSTM%20in%20Keras%20%E2%80%93%20Philippe%20Remy%20%E2%80%93%20My%20Blog.&amp;s_o=default#" rel="nofollow" data-action="subscribe" title="Subscribe and get email updates from this discussion" class="disqus-footer__link"><i aria-hidden="true" class="icon icon-mail"></i><span class="clip">Subscribe</span><i aria-hidden="true" class="icon icon-checkmark"></i></a></div><div class="form"><div class="input-wrapper"><input id="thread-subscribe-email" type="email" placeholder="yourname@email.com" class="disqus-footer__input input--text"></div></div></li><li class="install disqus-footer__item"><a href="https://publishers.disqus.com/engage?utm_source=philipperemy-github-io-1&amp;utm_medium=Disqus-Footer" rel="nofollow" target="_blank" class="disqus-footer__link"><i aria-hidden="true" class="icon icon-disqus"></i><span class="clip hidden-sm">Add Disqus to your site</span><span class="clip visible-sm hidden-xs">Add Disqus</span><span class="clip visible-xs">Add</span></a></li><li class="privacy disqus-footer__item"><a href="https://help.disqus.com/customer/portal/articles/1657951?utm_source=disqus&amp;utm_medium=embed-footer&amp;utm_content=privacy-btn" rel="nofollow" target="_blank" class="disqus-footer__link"><i aria-hidden="true" class="icon icon-lock"></i><span class="clip">Privacy</span></a></li></ul></div></div><iframe style="position: absolute; width: 1px; height: 1px; left: -9999px; display: none;" aria-hidden="true" id="ssIFrame_google" sandbox="allow-scripts allow-same-origin" src="./iframe.html"></iframe><div id="fb-root" class=" fb_reset"><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div></div></div><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div><iframe name="fb_xdm_frame_https" frameborder="0" allowtransparency="true" allowfullscreen="true" scrolling="no" id="fb_xdm_frame_https" aria-hidden="true" title="Facebook Cross Domain Communication Frame" tabindex="-1" src="./96nq-xsaNcg.html" style="border: none;"></iframe></div></div></div><img src="./tpid=c5mnhdpvrsbn2d" style="display: none;"><img src="./23096" style="display: none;"><img src="./saved_resource" style="display: none;"><iframe src="./sync.html" style="display: none;"></iframe></body></html>