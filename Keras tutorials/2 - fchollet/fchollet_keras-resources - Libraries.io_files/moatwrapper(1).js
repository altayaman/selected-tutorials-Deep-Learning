/**
 * Copyright (c) 2011-2016 Moat Inc. All Rights Reserved.
 */
 
!function(){try{var e=function(){var e=function(e,t){r.moatTag=this,this.pcode=e,this.ids=t,this.moatapi,this.eventBuffer=[],this.init()};return e.prototype.init=function(){var e=this;r.Queue.subscribe("moat-tag",function(t){e.initMoatTracking(t.videoElement,t.duration)}),r.Queue.subscribe("vpaid-events",function(t){var i={type:t.type,adVolume:r.ad.getAdVolume()};if(t.type===r.VPAIDevents.AdDurationChange&&(i.duration=t.args[0],i.confirmed=!0),"moat_DURATION_DEBUG"===t.type){if(!t.args||t.length<2)return;i[t.args[0]]=t.args[1]}if("moat_vastDuration"===t.type&&(i.moat_vastDuration=t.args[0]),e.moatapi){if(e.eventBuffer&&e.eventBuffer.length>0)for(var n=e.eventBuffer.length-1;n>=0;n--){var a=e.eventBuffer[n];e.moatapi.dispatchEvent(a)}e.eventBuffer=!1,e.moatapi.dispatchEvent(i)}else e.eventBuffer&&e.eventBuffer.push(i)}),r.Queue.subscribe("moatapi-events",function(t){e.moatapi&&e.moatapi.adData&&e.moatapi.adData.ids&&!e.moatapi.adData.ids[t.property]?e.moatapi.adData.ids[t.property]=t.value:e.ids&&!e.ids[t.property]&&(e.ids[t.property]=t.value)})},e.prototype.initMoatTracking=function(e,t){var i=document.createElement("script"),n=[],a={adData:{ids:this.ids,duration:t},dispatchEvent:function(e){this.sendEvent?(n&&(n.push(e),e=n,n=!1),this.sendEvent(e)):n.push(e)}},s="_moatApi"+Math.floor(1e8*Math.random()),o=r.Util.getDocAndWinOfEl(e),d=(o.elDoc,o.elWin);if(!d)return!1;this.moatapi=d[s]=a,i.type="text/javascript",e&&e.insertBefore(i,e.childNodes[0]||null);var l="#"+s;i.src="https://z.moatads.com/"+this.pcode+"/moatvideo.js"+l},e},t=function(){var e={"vpaid-events":[],"moat-tag":[],"internal-events":[],"skip-button":[],"moatapi-events":[]};return{subscribe:function(t,i){if(e[t]){var n=e[t].push(i)-1;return{remove:function(){delete e[t][n]}}}},publish:function(t,i){if(e[t])for(var n=e[t],a=n.length-1;a>=0;a--){var r=n[a];"function"==typeof r&&r.call(null,i)}}}},i=function(){var e=function(){this.availableResources=["StaticResource","IFrameResource","HTMLResource"],this.availableTypesMap={"image/gif":"img","image/jpeg":"img","image/png":"img","application/x-javascript":"js","application/x-shockwave-flash":"swf"},this.availableTypes=["swf","img"]};return e.prototype.loadCompanion=function(e,t,i,n,a,s,o,d){function l(e,t,i,n){function a(e){var t=[],i=e.getElementById(o);i&&t.push(i);for(var n=0,a=m.availableResources.length;n<a;n++){var r;if("StaticResource"==m.availableResources[n])for(var s=0,d=m.availableTypes.length;s<d;s++){var l=e.getElementById(o+"_"+m.availableResources[n]+"_"+m.availableTypes[s]);l&&t.push(l)}else r=e.getElementById(o+"_"+m.availableResources[n]);r&&t.push(r)}return t.length>0&&t}function r(e){if(!e||0==e.length)return!1;if(1==e.length)return e[0];for(var t=0,a=e.length;t<a;t++)if(n){if(e[t].id===o+"_"+i+"_"+n)return e[t]}else if(e[t].id===o+"_"+i)return e[t];return!1}var s,o="moatCompanionDiv_"+e+"x"+t;try{s=r(a(document))||r(a(window.top.document))}catch(e){}if(s)return s;var d=[];try{for(var l=window.frames,u=0,p=l.length;u<p;u++){try{var c=a(l[u].document)}catch(e){}c&&(d=d.concat(c))}}catch(e){}return(s=r(d))||!1}function u(e,t,i,n,a,r,s,o){o=o||[];for(var d="",l=0;l<o.length;l++)d+='<img src="'+o[l]+'" style="display:none" width="1" height="1">';if("StaticResource"===a){if("img"==r){var u='<img src="'+t+'" width="'+i+'" height="'+n+'">';d+=s?'<a href="'+s+'" target="_blank">'+u+"</a>":u}if("swf"==r){var p=Math.floor(1e7*Math.random());d+='<object type="application/x-shockwave-flash" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://download.macromedia.com/pub/sho ckwave/cabs/flash/swflash.cab#version=8,0,0,0" width="'+i+'" height="'+n+'" id="companion'+(p-1)+'"><param name="allowScriptAccess" value="always" /><param name= "movie" value="'+t+'" />'+(s?'<param name="FlashVars" value="clickTag='+encodeURIComponent(s)+'" />':"")+'<param name="wmode" value="opaque" /><embed type="application/x-shockwave-flash" src="'+t+'" '+(s?'flashvars="clickTag='+encodeURIComponent(s)+'" ':"")+'wmode="opaque" width="'+i+'" height="'+n+'" id="companion'+p+'"name="companion'+p+'"allowscriptaccess="always" /></object>'}}return"IFrameResource"===a&&(d+="<iframe style='border:0px; padding:0px; margin:0px;' width='"+i+"' height='"+n+"' frameborder='no' scrolling='no' marginheight='0' marginwidth='0' src='"+t+"'></iframe>"),"HTMLResource"===a&&(d+=t,e&&(i&&(e.style.width=i+"px"),n&&(e.style.height=n+"px"))),d}function p(){if(f)return!0;try{var s=t,p=l(i,n,e,s);if(!p)return!1;if("DIV"!==p.nodeName){var c=p;c.id="";var h=r.Util.getParentNode(c);if(!h)return!1;p=document.createElement("div"),r.Util.addTagSafely(p,h)}else p.id="";p.innerHTML=u(p,a,i,n,e,s,o,d)}catch(e){return!1}return!0}function c(r){try{var s=t,l=u(null,a,i,n,e,s,o,d);r.postMessage("zMoatAdContent#"+l,"*")}catch(e){return!1}return!0}function h(e,t,i,n){i>=n||e()||(i++,setTimeout(function(){h(e,t,i,n)},t))}function v(e){if(!f){var t,a,r;"string"==typeof e.data&&(t=e.data.match(/^zMoatPlaceholder#([0-9]+)x([0-9]+)$/))&&(a=t[1],r=t[2],a==i&&r==n&&(f=c(e.source)))}}var m=this;t=m.availableTypesMap[t];var f=!1,A=p();return A||(setTimeout(function(){h(p,500,0,10)},500),function(e,t,i){e.addEventListener?e.addEventListener(t,i,!1):e.attachEvent("on"+t,i)}(window,"message",v)),A},e},n=function(){var e=function(e){this.skipContainer,this.textContainer,this.iconContainer,this.skipIconUrl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABGdBTUEAALGPC/xhBQAAAKBJREFUOBFjYBgFsBD4////TCBmg/Hx0UB1FUD8CYi7cKoDSoLAMSCWxKkIKgFU8xSkGAh+4VQLkQeTz4CkJU6FQAmg/CuYepzqYAqg9E8gnYZLMVCOZANh5mMNV0oMBBmMEa6UGggyFCVckQ1kwhUuVBcHOQMHoKqXqRYpVE02KBGALWyBQUN0OsQILxwGEpX1sIYXDgNhhUM3NvlhLgYAYuCVi7Jf+AUAAAAASUVORK5CYII=",this.init(e)};return e.prototype.init=function(e){this.createContainer(e),this.createTextContainer(),this.createIconContainer(),e.appendChild(this.skipContainer),this.updateButtonTextSubscription=r.Queue.subscribe("skip-button",this.updateButtonText.bind(this)),r.Queue.subscribe("vpaid-events",this.addClickHandler.bind(this))},e.prototype.createContainer=function(e){this.skipContainer=document.createElement("div"),this.skipContainer.style.background="rgba(0,0,0,0.8)",this.skipContainer.style.color="#ffffff",this.skipContainer.style.fontSize="11px",this.skipContainer.style.fontFamily="arial,sans-serif",this.skipContainer.style.position="absolute",this.skipContainer.style.textAlign="center",this.skipContainer.style.right="0px",this.skipContainer.style.bottom="10%",this.skipContainer.style.padding="2%"},e.prototype.createTextContainer=function(){this.textContainer=document.createElement("span"),this.textContainer.style.verticalAlign="middle",this.skipContainer.appendChild(this.textContainer)},e.prototype.createIconContainer=function(){this.iconContainer=document.createElement("img"),this.iconContainer.style.display="none",this.iconContainer.style.verticalAlign="middle",this.iconContainer.setAttribute("src",this.skipIconUrl),this.skipContainer.appendChild(this.iconContainer)},e.prototype.updateButtonText=function(e){e.timeLeft>0?this.textContainer.innerHTML="you can skip this ad in "+e.timeLeft:(this.textContainer.innerHTML="Skip Ad",this.textContainer.style.fontSize="18px",this.iconContainer.style.display="inline",this.updateButtonTextSubscription.remove())},e.prototype.skipAd=function(){r.underlyingAsset&&r.underlyingAsset.skipAd()},e.prototype.addClickHandler=function(e){e.type===r.VPAIDevents.AdSkippableStateChange&&r.Util.addListener(this.skipContainer,"click",this.skipAd,"skipClickHandlerFn")},e.prototype.cleanUp=function(){this.skipContainer.parentNode.removeChild(this.skipContainer),this.skipContainer=null,this.textContainer=null,this.iconContainer=null},e},a=function(){var e,t=0,i=Math.floor(Math.random()*Math.pow(10,8));e="VPAID2JSWRAPPER1",r.Queue.subscribe("vpaid-events",function(n){var a={};a.e=32,a.q=t++,a.g=t,a.d=encodeURIComponent(r.qs.pcode+":"+n.type+":unknown:unknown"),a.i=e,a.t=r.startTime,a.m=(new Date).getTime()-r.startTime,a.ar=encodeURIComponent("0590c5f-clean"),a.de=i;var s=r.Util.objectToQueryString(a,!1),o="//pixel.moatads.com/pixel.gif?"+s+"&bq=8&o=3&ac=1&cs=0";(new Image).src=o})},r={ad:null,version:"2.0",startTime:(new Date).getTime(),playerProvidedEventCallbacks:{},VPAIDevents:{AdLoaded:"AdLoaded",AdStarted:"AdStarted",AdStopped:"AdStopped",AdSkipped:"AdSkipped",AdSkippableStateChange:"AdSkippableStateChange",AdSizeChange:"AdSizeChange",AdLinearChange:"AdLinearChange",AdDurationChange:"AdDurationChange",AdExpandedChange:"AdExpandedChange",AdRemainingTimeChange:"AdRemainingTimeChange",AdVolumeChange:"AdVolumeChange",AdImpression:"AdImpression",AdVideoStart:"AdVideoStart",AdVideoFirstQuartile:"AdVideoFirstQuartile",AdVideoMidpoint:"AdVideoMidpoint",AdVideoThirdQuartile:"AdVideoThirdQuartile",AdVideoComplete:"AdVideoComplete",AdClickThru:"AdClickThru",AdInteraction:"AdInteraction",AdUserAcceptInvitation:"AdUserAcceptInvitation",AdUserMinimize:"AdUserMinimize",AdUserClose:"AdUserClose",AdPaused:"AdPaused",AdPlaying:"AdPlaying",AdLog:"AdLog",AdError:"AdError"},VPAIDmethods:{resizeAd:"resizeAd",startAd:"startAd",stopAd:"stopAd",pauseAd:"pauseAd",resumeAd:"resumeAd",expandAd:"expandAd",collapseAd:"collapseAd",skipAd:"skipAd"}},s=function(){var e=function(){};return e.prototype.request=function(e){var t=this;DMVAST.client.get(e,{withCredentials:!1},function(e){e?t.extractStuff(e):r.Queue.publish("vpaid-events",{type:r.VPAIDevents.AdError,args:["no VAST tag response"]})})},e.prototype.extractStuff=function(e){var t=["progressive"];if(e&&e.ads&&0!==e.ads.length){var n={linearCreatives:[],companions:[]},a=e.ads[0];a.creativeId&&r.Queue.publish("moatapi-events",{property:"zMoatCreativeId",value:a.creativeId});for(var s=a.creatives,l=s.length-1;l>=0;l--){var u=s[l];switch(u.type){case"linear":for(var c={duration:u.duration,adParameters:u.adParameters,trackingEvents:u.trackingEvents,clickthroughURL:u.videoClickThroughURLTemplate,clicktrackingURLs:u.videoClickTrackingURLTemplates,vpaid:[],videos:[],skipoffset:u.skipDelay},h=u.mediaFiles,v=h.length-1;v>=0;v--){var m=h[v],f=m.mimeType.toLowerCase(),A=m.deliveryType.toLowerCase();"VPAID"===m.apiFramework&&("application/javascript"===f||"application/x-javascript"===f)&&t.indexOf(A)>-1&&c.vpaid.push(m),t.indexOf(A)>-1&&c.videos.push(m)}n.linearCreatives.push(c);break;case"companion":for(var g=u.variations.length-1;g>=0;g--)n.companions.push(u.variations[g])}}var y,_=n.linearCreatives.length;if(1===_)y=n.linearCreatives[0];else for(var l=_-1;l>=0;l--){var k=n.linearCreatives[l];if(k.videos.length>0||k.vpaid.length>0){y=k;break}}if(y||r.Queue.publish("vpaid-events",{type:r.VPAIDevents.AdError,args:["No suitable assets found"]}),r.TrackerManager=p(),new r.TrackerManager(y.trackingEvents,a.impressionURLTemplates,a.errorURLTemplates,y.clicktrackingURLs,a.surveys),n.companions.length>0){r.CompanionLoader=i();for(var C=new r.CompanionLoader,b=n.companions.length-1;b>=0;b--){var T,S,E=n.companions[b];E.htmlResource?(T="HTMLResource",S=E.htmlResource):E.iframeResource?(T="IFrameResource",S=E.iframeResource):E.staticResource&&(T="StaticResource",S=E.staticResource),C.loadCompanion(T,E.type,E.width,E.height,S,!1,E.companionClickThroughURLTemplate,E.trackingEvents.creativeView)}}if((y.vpaid.length>0||y.videos.length>0)&&"number"==typeof y.duration&&r.Queue.publish("vpaid-events",{type:"moat_vastDuration",args:[y.duration]}),y.vpaid.length>0){r.VpaidPlayer=o();var V=new r.VpaidPlayer;return void V.init(y.vpaid[0],y.adParameters,y.duration,n.companions)}if(y.videos.length>0){r.Queue.publish("vpaid-events",{type:"moat_DURATION_DEBUG",args:["mediafile","video"]}),r.Queue.publish("vpaid-events",{type:"moat_DURATION_DEBUG",args:["vast-duration",y.duration]}),r.VideoPlayer=d();var V=new r.VideoPlayer;return r.underlyingAsset=V,void V.init(y.videos,y.duration,y.clickthroughURL,n.companions,y.skipoffset)}r.Queue.publish("vpaid-events",{type:r.VPAIDevents.AdError,args:["No suitable assets found"]})}},e},o=function(){return o=function(){this._iframe,this._adCompanions,this._lastAdVolume,this._adParameters},o.prototype.init=function(e,t,i,n){var a=Math.random()+"";window["moatstartvpaid"+a]=this.startVPAID.bind(this),window["moatstartvpaiderr"+a]=this.handleError.bind(this);var s=document.createElement("iframe");this._iframe=s,s.style.display="none",document.body.appendChild(s);var o='<html><head><body><script>function startVPAID() {window.parent["moatstartvpaid'+a+'"]();};function errVPAID() {window.parent["moatstartvpaiderr'+a+'"]();};</script><script onerror="errVPAID();" onload="startVPAID();" src="'+e.fileURL+'"></script></body></head></html>';s.contentWindow.moatsrc=o,s.src="javascript:window.moatsrc",this._adCompanions=n,this._adParameters=t,r.Queue.publish("moat-tag",{videoElement:r.ad._domElToTrack,duration:i})},o.prototype.handleError=function(){r.Queue.publish("vpaid-events",{type:r.VPAIDevents.AdError,args:["no VPAID response"]})},o.prototype.wrapGetAdCompanions=function(){var e=this,t=this._vpaid.getAdCompanions;this._vpaid.getAdCompanions=function(){return e._adCompanions.length>0?r.Util.createXMLcompanionNode(e._adCompanions):t?t.call(e._vpaid):""}},o.prototype.createCallbacks=function(){var e={};for(var t in r.VPAIDevents){var i=function(e){var t=e;return function(){r.Queue.publish("vpaid-events",{type:t,args:arguments})}}(t);e[t]=i}return e},o.prototype.startVPAID=function(){var e=this._iframe.contentWindow,t=this,i=!1,n=0,a=function(){if(++n>20||i)return t.handleError(),!1;var a=e.getVPAIDAd&&"function"==typeof e.getVPAIDAd&&e.getVPAIDAd();if(a){t._vpaid=a,i=!0;var s=(a.handshakeVersion(r.version),t.createCallbacks());for(var o in s)a.subscribe(s[o],o);t.wrapGetAdCompanions(),r.underlyingAsset=a;var d={AdParameters:t._adParameters}||r.ad._creativeData||{};a.initAd(r.ad._width,r.ad._height,r.ad._viewMode,r.ad._desiredBitrate,d,r.ad._environmentVars);var l;try{l=a.getAdVolume()}catch(e){l=-1}return r.Queue.publish("internal-events",{volume:l}),!1}};r.Util.setSafeLoop(a,[],100)},o};!function(){var i=function(){r.Util=u(),r.Queue=t(),r.VpaidAd=c(),r.MoatTag=e(),l(),a();var i=r.Util.parseQS();if(i){r.qs=i;var n={};for(var s in i)n[s]=i[s];return n.wrapperType="js",new r.MoatTag(r.qs.pcode,n),new r.VpaidAd}};window.getVPAIDAd=function(){if(r.ad)return r.ad;var e=i();return r.ad=e}}();var d=function(){var e=function(){this._videoEl,this._adIsStarted,this._firstQuartileTime,this._firstQuartileReached,this._midpointTime,this._midpointReached,this._thirdQuartileTime,this._thirdQuartileReached,this._videoIsCompleted,this._adIsPlaying=!1,this._lastViewMode,this._originalSlotCursorStyle,this._originalVideoSlotCursorStyle,this._pauseAdOnClickThru=!0,this._adIsPausedViaClickThru=!1,this._clickthroughURL,this._lastClickThruTime,this._skipoffset,this._cleanupCalled,this._durationConfirmed=!1,this._adLinear=!0,this._adWidth=r.ad._width,this._adHeight=r.ad._height,this._adExpanded=!1,this._adSkippableState=!1,this._adRemainingTime=-2,this._adDuration=-2,this._adVolume=1,this._adCompanions="",this._adIcons=!1,this._skipButtonModule=n(),this._skipButtonManager};return e.prototype.init=function(e,t,i,n,a){this._videoEl=r.ad._videoSlot,this._adDuration=this._adRemainingTime=t,this._mediaFile=this.pickMediaFile(e),this._skipoffset=a,this._skipoffset||(isNaN(Number(r.qs.skip))===!1?this._skipoffset=Number(r.qs.skip):isNaN(Number(r.qs.zMoatSkip))===!1&&(this._skipoffset=Number(r.qs.zMoatSkip)));var s=r&&r.ad&&r.ad._slot,o=r&&r.ad&&r.ad._videoSlot;s&&s.style&&(this._originalSlotCursorStyle=s.style.cursor,s.style.cursor="pointer"),o&&o.style&&(this._originalVideoSlotCursorStyle=o.style.cursor,o.style.cursor="pointer"),void 0!==this._videoEl.volume&&"number"==typeof this._videoEl.volume&&(this._adVolume=this._videoEl.volume),r.Queue.publish("internal-events",{volume:this._adVolume}),this._clickthroughURL=i,this._lastViewMode=r.ad._viewMode,this._adCompanions=r.Util.createXMLcompanionNode(n),this.onAdClickHandler=this.onAdClick(),this.onErrorHandler=this.videoErrorHandlerFn(),this.createListeners(),"1"===r.qs.noctp&&(this._pauseAdOnClickThru=!1),this._adDuration&&(this.determineQuartiles(),r.Queue.publish("moat-tag",{videoElement:r.ad._domElToTrack,duration:this._adDuration})),r.Queue.publish("vpaid-events",{type:r.VPAIDevents.AdLoaded})},e.prototype.resizeAd=function(e,t,i,n){"string"==typeof i&&(i=i.toLowerCase());var a=i&&"fullscreen"===i,s="number"==typeof e&&"number"==typeof t&&!isNaN(e)&&!isNaN(t),o=!a&&!!s;!a&&!s||o&&!this._videoEl||(o&&(this._adHeight=t,this._adWidth=e,this._videoEl.width=e,this._videoEl.height=t),n&&r.ad._slot&&(r.ad._slot.style.width=e+"px",r.ad._slot.style.height=t+"px"),r.Queue.publish("vpaid-events",{type:r.VPAIDevents.AdSizeChange}))},e.prototype.startAd=function(){this._adIsStarted||(this.setVideoElSrc(this._mediaFile),"number"==typeof this._skipoffset&&(this._skipButtonManager=new this._skipButtonModule(r.ad._slot)),r.ad._environmentVars.videoSlotCanAutoPlay!==!1&&(this._videoEl.load(),this._videoEl.play(),this._adIsStarted=!0,this._adIsPlaying=!0,this._adIsPausedViaClickThru=!1,this.timer(),r.Queue.publish("vpaid-events",{type:r.VPAIDevents.AdStarted}),r.Queue.publish("vpaid-events",{type:r.VPAIDevents.AdImpression}),r.Queue.publish("vpaid-events",{type:r.VPAIDevents.AdVideoStart})))},e.prototype.stopAd=function(){this.cleanUp(),r.Queue.publish("vpaid-events",{type:r.VPAIDevents.AdStopped})},e.prototype.pauseAd=function(){1==this._adIsPlaying&&(this._videoEl.pause(),this._adIsPlaying=!1,r.Queue.publish("vpaid-events",{type:r.VPAIDevents.AdPaused}))},e.prototype.resumeAd=function(){0==this._adIsPlaying&&(this._videoEl.play(),this._adIsPlaying=!0,this._adIsPausedViaClickThru=!1,r.Queue.publish("vpaid-events",{type:r.VPAIDevents.AdPlaying}))},e.prototype.skipAd=function(){this.cleanUp(),r.Queue.publish("vpaid-events",{type:r.VPAIDevents.AdSkipped});var e=function(){r.Queue.publish("vpaid-events",{type:r.VPAIDevents.AdStopped})};r.Util.setSafeTimeout(e,400)},e.prototype.getAdLinear=function(){return this._adLinear},e.prototype.getAdCompanions=function(){return this._adCompanions},e.prototype.getAdExpanded=function(){return this._adExpanded},e.prototype.getAdHeight=function(){return this._adHeight},e.prototype.getAdWidth=function(){return this._adWidth},e.prototype.getAdVolume=function(){return this._videoEl.volume||this._adVolume},e.prototype.setAdVolume=function(e){this._adVolume=e,"number"==typeof this._videoEl.volume&&(this._videoEl.volume=e),r.Queue.publish("vpaid-events",{type:r.VPAIDevents.AdVolumeChange})},e.prototype.getAdRemainingTime=function(){return this._adDuration-this._videoEl.currentTime},e.prototype.getAdDuration=function(){return this._adDuration},e.prototype.getAdIcons=function(){return this._adIcons},e.prototype.getAdSkippableState=function(){return this._adSkippableState},e.prototype.setVideoElSrc=function(e){e&&"string"==typeof e.fileURL&&e.fileURL.length?this._videoEl.src=e.fileURL:r.Queue.publish("vpaid-events",{type:r.VPAIDevents.AdError,args:["invalid mediaFile or mediaFile fileURL"]})},e.prototype.pickMediaFile=function(e){for(var t=this._adWidth*this._adHeight,i=[],n=e.length-1;n>=0;n--){var a=e[n];""!==this._videoEl.canPlayType(a.mimeType)&&i.push({sizeDiff:Math.abs(t-a.width*a.height),bitrate:a.bitrate,mediaFile:a})}0===i.length&&r.Queue.publish("vpaid-events",{type:r.VPAIDevents.AdError,args:["AdError"]}),i.sort(function(e,t){var i=e.sizeDiff-t.sizeDiff;return 0!==i?i:t.bitrate-e.bitrate});for(var n=i.length-1;n>=0;n--){var s=i[n];if("probably"===this._videoEl.canPlayType(s.mediaFile.mimeType))return s.mediaFile}for(var n=i.length-1;n>=0;n--){var s=i[n];if("maybe"===this._videoEl.canPlayType(s.mediaFile.mimeType))return s.mediaFile}},e.prototype.onAdClick=function(){return function(e){var t=(new Date).getTime();if(void 0===this._lastClickThruTime||t-this._lastClickThruTime>100){if(this._lastClickThruTime=t,this._pauseAdOnClickThru===!0&&this._adIsPausedViaClickThru===!1)this.pauseAd(),this._adIsPausedViaClickThru=!0;else if(this._adIsPausedViaClickThru===!0)return void this.resumeAd();r.Queue.publish("vpaid-events",{type:r.VPAIDevents.AdClickThru,args:[this._clickthroughURL,null,!0]})}}.bind(this)},e.prototype.videoErrorHandlerFn=function(e){return function(e){r.Queue.publish("vpaid-events",{type:r.VPAIDevents.AdError,args:["AdError"]})}},e.prototype.createListeners=function(){r.Util.addListener(r.ad._slot,"click",this.onAdClickHandler,"slotClickHandlerFn"),r.Util.addListener(r.ad._videoSlot,"click",this.onAdClickHandler,"videoSlotClickHandlerFn"),r.Util.addListener(this._videoEl,"error",this.onErrorHandler,"videoErrorHandlerFn")},e.prototype.determineQuartiles=function(){var e=this._adDuration/4;this._firstQuartileTime=0+e,this._midpointTime=this._firstQuartileTime+e,this._thirdQuartileTime=this._midpointTime+e},e.prototype.onConfirmDuration=function(e){if(!this._adDuration&&0!==this._adDuration){if(!r.ad._domElToTrack)return r.Queue.publish("vpaid-events",{type:r.VPAIDevents.AdError,args:["AdError"]}),!1;r.Queue.publish("moat-tag",{videoElement:r.ad._domElToTrack,duration:self._adDuration})}this._adDuration=e,this.determineQuartiles(),this._durationConfirmed=!0,r.Queue.publish("vpaid-events",{type:r.VPAIDevents.AdDurationChange,args:[e]})},e.prototype.confirmDuration=function(){if(!this._durationConfirmed){var e=this._videoEl&&this._videoEl.duration;"number"==typeof e&&!isNaN(e)&&e>0&&this.onConfirmDuration(Math.round(e))}},e.prototype.timer=function(){var e=function(e){return function(){e.confirmDuration(),e._adDuration&&e.progressWatcher()}}(this);r.Util.setSafeLoop(e,[],500)},e.prototype.progressWatcher=function(){if(this._skipoffset&&this._adSkippableState===!1&&this._videoEl.currentTime>this._skipoffset&&(this._adSkippableState=!0,r.Queue.publish("vpaid-events",{type:r.VPAIDevents.AdSkippableStateChange})),r.Queue.publish("skip-button",{timeLeft:Math.max(Math.round(this._skipoffset-this._videoEl.currentTime),0)}),this._adIsStarted&&!this._firstQuartileReached&&this._videoEl.currentTime>this._firstQuartileTime)this._firstQuartileReached=!0,r.Queue.publish("vpaid-events",{type:r.VPAIDevents.AdVideoFirstQuartile});else if(this._adIsStarted&&this._firstQuartileReached&&!this._midpointReached&&this._videoEl.currentTime>this._midpointTime)this._midpointReached=!0,r.Queue.publish("vpaid-events",{type:r.VPAIDevents.AdVideoMidpoint});else if(this._adIsStarted&&this._firstQuartileReached&&this._midpointReached&&!this._thirdQuartileReached&&this._videoEl.currentTime>this._thirdQuartileTime)this._thirdQuartileReached=!0,r.Queue.publish("vpaid-events",{type:r.VPAIDevents.AdVideoThirdQuartile});else if(this._adIsStarted&&this._firstQuartileReached&&this._midpointReached&&this._thirdQuartileReached&&!this._videoIsCompleted&&(this._videoEl.currentTime>=this._adDuration||this._videoEl.ended)){this.cleanUp(),this._videoIsCompleted=!0,r.Queue.publish("vpaid-events",{type:r.VPAIDevents.AdVideoComplete});var e=function(){r.Queue.publish("vpaid-events",{type:r.VPAIDevents.AdStopped})};r.Util.setSafeTimeout(e,400)}},e.prototype.cleanUp=function(){this._cleanupCalled||(this._cleanupCalled=!0,r.Util.removeListener(r.ad._slot,"click",this.onAdClickHandler,"slotClickHandlerFn"),r.Util.removeListener(r.ad._videoSlot,"click",this.onAdClickHandler,"videoSlotClickHandlerFn"),r.Util.removeListener(this._videoEl,"error",this.onErrorHandler,"videoErrorHandlerFn"),r.ad._slot.style&&(r.ad._slot.style.cursor=this._originalSlotCursorStyle),r.ad._videoSlot.style&&(r.ad._videoSlot.style.cursor=this._originalVideoSlotCursorStyle),"number"==typeof this._skipoffset&&this._skipButtonManager.cleanUp())},e},l=function(){r.Queue.subscribe("vpaid-events",function(e){var t=e.type,i=e.args;if(r.playerProvidedEventCallbacks[t])for(var n=r.playerProvidedEventCallbacks[t],a=n.length-1;a>=0;a--){var s=n[a],o=s.fn,d=s.listenerScope;d||(d=null);try{o.apply(d,i)}catch(e){}}})},u=function(){var e={};return e.safeCallbacks={},e.findMoatScript=function(){for(var e=/moatwrapper/,t=document.getElementsByTagName("script"),i=t.length-1;i>=0;i--){var n=t[i];if(e.test(n.src))return n}},e.parseQS=function(){var t={},i=e.findMoatScript();if(!i)return!1;for(var n=i.src,a=n.split("#")[1],r=a.split("&"),s=r.length-1;s>=0;s--){var o=r[s].split("=");t[o[0]]=decodeURIComponent(o.slice(1).join("="))}return t.vast&&(t.vast=e.expandCachebuster(t.vast)),t},e.getScrUrls=function(){var e,t=r&&r.qs,i=[],n=new RegExp(/^scr\d{1,}/);if(!t)return i;for(key in t)0===key.search(n)&&"string"==typeof(e=t[key])&&i.push(e);return i},e.getParentNode=function(e){return e.parentNode||e.parentElement||!1},e.getElementNodeTree=function(t){if(!t)return!1;for(var i="number"==typeof cap?cap:50,n=[t],a=!1,r=0;r<i&&((a=e.getParentNode(t))&&1===a);r++)t=a,n.push(t)},e.getSafeNode=function(t){if(!t)return!1;if("OBJECT"!==t.nodeName&&"EMBED"!==t.nodeName)return t;for(var i=e.getElementNodeTree(t),n=!1,a=0;a<i.length;a++)if(el&&"OBJECT"!==el.nodeName&&"EMBED"!==el.nodeName){n=el;break}return n},e.hasChildNodes=function(e){return e&&e.childNodes&&e.childNodes.length>0},e.addTagSafely=function(t,i){if(!t||!i)return!1;var n=e.getSafeNode(i);if(!n)return!1;if(e.hasChildNodes(n)){var a=n.childNodes[Math.max(0,n.childNodes.length-1)]||null;n.insertBefore(t,a)}else n.appendChild(t);return n},e.addScriptToDOM=function(t,i,n){if("string"!=typeof t||!i||!document)return!1;var a=n||document.createElement("script");a.type="text/javascript";var r=e.addTagSafely(a,i);return!!r&&(a.src=t,r)},e.expandCachebuster=function(e){return e.replace("[MOAT_CB]",""+(new Date).getTime())},e.createXMLcompanionNode=function(e){if(!e||0===e.length)return"";for(var t,i,n,a,r,s,o,d,l,u=document.implementation.createDocument(null,"CompanionAds",null),p=e.length-1;p>=0;p--){if(t=e[p],i=u.createElementNS("","Companion"),i.setAttributeNS("","width",t.width),i.setAttributeNS("","height",t.height),n=u.createElementNS("","StaticResource"),n.setAttributeNS("","type",t.type),n.appendChild(u.createCDATASection(t.staticResource)),i.appendChild(n),t.companionClickThroughURLTemplate&&(a=u.createElementNS("","CompanionClickThrough"),a.appendChild(u.createCDATASection(t.companionClickThroughURLTemplate)),i.appendChild(a)),t.trackingEvents&&t.trackingEvents.creativeView){r=u.createElementNS("","TrackingEvents"),s=t.trackingEvents.creativeView;for(var c=s.length-1;c>=0;c--)o=s[c],d=u.createElementNS("","Tracking"),d.setAttributeNS("","event","creativeView"),d.appendChild(u.createCDATASection(o)),r.appendChild(d);i.appendChild(r)}u.documentElement.appendChild(i)}return l=new XMLSerializer,l.serializeToString(u)},e.emptyObj={},e.isArray=function(t){try{return"[object Array]"===e.emptyObj.toString.call(t)}catch(e){return!1}},e.isFunction=function(t){try{return"[object Function]"===e.emptyObj.toString.call(t)}catch(e){return!1}},e.isNumber=function(t){try{return"[object Number]"===e.emptyObj.toString.call(t)}catch(e){return!1}},e.timeouts=[],e.loops={},e.makeSafe=function(e,t,i){var n=!1;return function(){try{return t?i?e.apply(i,arguments):e.apply(this,arguments):e.apply(null,arguments)}catch(e){if(!n){n=!0;var a,s,o=e.name+" in makeSafe: "+e.message+", stack="+e.stack;try{a=r.qs.level1+"%3A"+r.qs.level2+"%3A"+r.qs.level3+"%3A"+r.qs.level4}catch(e){a="data%3Adata%3Adata%3Adata"}try{s=r.qs.vast}catch(e){s="-"}var d="//pixel.moatads.com/pixel.gif?e=24&d="+a+"&i="+encodeURIComponent("AMOBEEVIDEO1")+"&ac=1&k="+encodeURIComponent(o)+"&ar="+encodeURIComponent("0590c5f-clean")+"&j="+encodeURIComponent(document.referrer)+"&zMoatVast="+s+"&cs="+(new Date).getTime();(new Image).src=d,r.Queue.publish("vpaid-events",{type:r.VPAIDevents.AdError,args:["AdError"]})}}}},e.setSafeTimeout=function(t,i){t=e.makeSafe(t);var n;return window&&window.setTimeout&&(n=window.setTimeout(t,i),e.timeouts.push(n)),n},e.setSafeLoop=function(t,i,n){if(e.isFunction(t)&&e.isArray(i)&&e.isNumber(n)){var a=(new Date).getTime()+"";e.loops[a]&&window.clearTimeout(e.loops[a].tid),e.loops[a]={},e.loops[a].callback=e.makeSafe(t,i),e.loops[a].interval=n,e.loops[a].tid=e.setSafeTimeout(e.runLoop(a),n),t=null,i=null,n=null,a=null}},e.runLoop=function(t){return function(){if(!e.loops||!e.loops[t])return!1;var i=e.loops[t].callback,n=i.call(null);if("boolean"==typeof n&&n===!1)return window.clearTimeout(e.loops[t].tid),e.loops[t]=!1,!1;e.loops[t].tid=e.setSafeTimeout(e.runLoop(t),e.loops[t].interval),n=null,t=null}},e.objectToQueryString=function(e,t){var i="";for(var n in e)e.hasOwnProperty(n)&&(i+="&"+n+"="+e[n]);if(t)var i=encodeURI(i);return i.slice(1)},e.addListener=function(t,i,n,a){var r,s=this.makeSafe(n);if(r=t.addEventListener?{name:"addEventListener",evtPrefix:""}:{name:"attachEvent",evtPrefix:"on"},t&&r.name&&t[r.name])try{t[r.name](r.evtPrefix+i,s,!1)}catch(e){}a!==!1&&(e.safeCallbacks[i+a]=s)},e.removeListener=function(t,i,n,a){var r,s=i+a;if(!t)return delete e.safeCallbacks[s],!1;try{t.removeEventListener;t.detachEvent}catch(t){return delete e.safeCallbacks[s],!1}n=a!==!1?e.safeCallbacks[s]:n,r=t.removeEventListener?{name:"removeEventListener",evtPrefix:""}:{name:"detachEvent",evtPrefix:"on"};try{t[r.name](r.evtPrefix+i,n,!1)}catch(e){}delete e.safeCallbacks[s]},e.getDocAndWinOfEl=function(e){var t,i;try{t=e.ownerDocument,i=t&&(t.defaultView||t.parentWindow)}catch(e){}return{elDoc:t,elWin:i}},e},p=function(){var e={AdSkipped:"skip",AdStarted:"creativeView",AdVideoStart:"start",AdVideoFirstQuartile:"firstQuartile",AdVideoMidpoint:"midpoint",AdVideoThirdQuartile:"thirdQuartile",AdVideoComplete:"complete",AdUserAcceptInvitation:"acceptInvitation",AdUserMinimize:"collapse",AdUserClose:"close",AdPaused:"pause",AdPlaying:"resume",AdError:"error"};return p=function(e,t,i,n,a){this.trackingEvents=e,this.impressionURLs=t,this.scrURLS=r.Util.getScrUrls(),this.errorURLs=i,this.clicktrackingURLs=n,this.lastVolume=!1,this.surveys=a,this.init()},p.prototype.init=function(){var t=this;r.Queue.subscribe("internal-events",function(e){t.lastVolume=e.volume}),r.Queue.subscribe("vpaid-events",function(i){var n,a,s=!1;switch(i.type){case r.VPAIDevents.AdImpression:t.handleSurveys(),n=t.impressionURLs,s=!0;break;case r.VPAIDevents.AdVolumeChange:var o,d=r.underlyingAsset&&r.underlyingAsset.getAdVolume();"number"==typeof t.lastVolume&&"number"==typeof d&&(0===d&&t.lastVolume>0?o="mute":d>0&&0===t.lastVolume&&(o="unmute")),t.lastVolume=d,o&&(n=t.trackingEvents[o]);break;case r.VPAIDevents.AdClickThru:n=t.clicktrackingURLs;break;case r.VPAIDevents.AdError:n=t.errorURLs;break;default:var l=e[i.type];n=l&&t.trackingEvents[l]}if(n)for(var u=n.length-1;u>=0;u--)if("string"==typeof(a=n[u]))try{(new Image).src=a}catch(e){}if(s)for(var p=t.scrURLS,c=p.length-1;c>=0;c--)r.Util.addScriptToDOM(p[c],r.ad._domElToTrack)})},p.prototype.handleSurveys=function(){if(this.surveys&&r.ad._domElToTrack)for(var e,t,i,n=r.ad._domElToTrack,a=this.surveys,s=!1,o=0;o<a.length;o++)if(i=a[o],"js"===function(e){var t="";if(e.type){var i=e.type.split("/");t="javascript"===i[i.length-1]?"js":"pixel"}else{var n=e.url.match(/([^\/&?#]+)(?:$|#|\?)/i),a=n&&2===n.length&&n[1],r=a&&a.split(".");t=r&&r[r.length-1]}return"js"===t?"js":"pixel"}(i)){if(!s){var d=r.Util.getDocAndWinOfEl(n);e=d.elDoc,t=d.elWin,s=!0}if(!t)continue;var l=e.createElement("script");l.src=i.url,l.type="text/javascript";var u=r.Util.getParentNode(n),p=u||n;p.insertBefore(l,p.childNodes[0]||null)}else(new Image).src=i.url},p},c=function(){var e=function(e){return r.version},t=function(e,t,i,n,a,o){if(this._width=e,this._height=t,this._viewMode=i||"normal",this._desiredBitrate=n,this._creativeData=a,this._environmentVars=o,this._slot=o.slot,this._videoSlot=o.videoSlot,"string"==typeof this._videoSlot.nodeName&&"number"==typeof this._videoSlot.nodeType?this._domElToTrack=this._videoSlot:this._domElToTrack=this._slot,r&&r.moatTag&&r.moatTag.ids&&this._domElToTrack){var t="number"==typeof this._domElToTrack.offsetHeight?this._domElToTrack.offsetHeight:"-",e="number"==typeof this._domElToTrack.offsetWidth?this._domElToTrack.offsetHeight:"-";r.moatTag.ids.origSize=e+"x"+t}
r.qs.vast,r.qs.asset;if(r.qs.vast){r.VastLoader=s();(new r.VastLoader).request(r.qs.vast)}else if(r.qs.asset){r.VideoPlayer=d();var l=new r.VideoPlayer;r.underlyingAsset=l;var u=[{fileURL:r.qs.asset,mimeType:"video/mp4",height:this._height,width:this._width,bitrate:this._desiredBitrate}];l.init(u,!1,r.qs.clickTag,!1)}else r.Queue.publish("vpaid-events",{type:r.VPAIDevents.AdError,args:["AdError"]})},i=function(e,t,i){var n=r.playerProvidedEventCallbacks;n[t]?n[t].push({fn:e,listenerScope:i}):n[t]=[{fn:e,listenerScope:i}]},n=function(e,t){for(var i=r.playerProvidedEventCallbacks[t],n=i.length-1;n>=0;n--){e===i[n].fn&&i.splice(n,1)}},a=function(e,t,i){r.underlyingAsset&&r.underlyingAsset.resizeAd(e,t,i)},o=function(){r.underlyingAsset&&r.underlyingAsset.startAd()},l=function(){r.underlyingAsset&&r.underlyingAsset.stopAd()},u=function(){r.underlyingAsset&&r.underlyingAsset.pauseAd()},p=function(){r.underlyingAsset&&r.underlyingAsset.resumeAd()},c=function(){r.underlyingAsset&&r.underlyingAsset.expandAd()},h=function(){r.underlyingAsset&&r.underlyingAsset.collapseAd()},v=function(){r.underlyingAsset&&r.underlyingAsset.skipAd()},m=function(e){isNaN(e)===!1&e>=0&&e<=1&&r.underlyingAsset&&r.underlyingAsset.setAdVolume(e)},f=function(){return r.underlyingAsset?r.underlyingAsset.getAdRemainingTime():-2},A=function(){if(r.underlyingAsset)return r.underlyingAsset.getAdWidth()},g=function(){if(r.underlyingAsset)return r.underlyingAsset.getAdIcons()},y=function(){if(r.underlyingAsset)return r.underlyingAsset.getAdSkippableState()},_=function(){if(r.underlyingAsset)return r.underlyingAsset.getAdLinear()},k=function(){if(r.underlyingAsset)return r.underlyingAsset.getAdCompanions()},C=function(){if(r.underlyingAsset)return r.underlyingAsset.getAdExpanded()},b=function(){if(r.underlyingAsset)return r.underlyingAsset.getAdHeight()},T=function(){return r.underlyingAsset?r.underlyingAsset.getAdVolume():1},S=function(){return r.underlyingAsset?r.underlyingAsset.getAdDuration():-2},E=function(){this._width,this._height,this._viewMode,this._desiredBitrate,this._creativeData,this._environmentVars,this._slot,this._videoSlot,this._domElToTrack};return E.prototype={initAd:r.Util.makeSafe(t,!0),collapseAd:r.Util.makeSafe(h,!0),constructor:r.Util.makeSafe(constructor,!0),expandAd:r.Util.makeSafe(c,!0),getAdCompanions:r.Util.makeSafe(k,!0),getAdDuration:r.Util.makeSafe(S,!0),getAdExpanded:r.Util.makeSafe(C,!0),getAdHeight:r.Util.makeSafe(b,!0),getAdIcons:r.Util.makeSafe(g,!0),getAdLinear:r.Util.makeSafe(_,!0),getAdRemainingTime:r.Util.makeSafe(f,!0),getAdSkippableState:r.Util.makeSafe(y,!0),getAdVolume:r.Util.makeSafe(T,!0),getAdWidth:r.Util.makeSafe(A,!0),handshakeVersion:r.Util.makeSafe(e,!0),pauseAd:r.Util.makeSafe(u,!0),resizeAd:r.Util.makeSafe(a,!0),resumeAd:r.Util.makeSafe(p,!0),setAdVolume:r.Util.makeSafe(m,!0),skipAd:r.Util.makeSafe(v,!0),startAd:r.Util.makeSafe(o,!0),stopAd:r.Util.makeSafe(l,!0),subscribe:r.Util.makeSafe(i,!0),unsubscribe:r.Util.makeSafe(n,!0)},E}}catch(e){try{var h=e.name+" in global t/c: "+e.message+", stack="+e.stack,v="//pixel.moatads.com/pixel.gif?e=24&d=data%3Adata%3Adata%3Adata&i="+encodeURIComponent("AMOBEEVIDEO1")+"&ac=1&k="+encodeURIComponent(h)+"&ar="+encodeURIComponent("0590c5f-clean")+"&j="+encodeURIComponent(document.referrer)+"&cs="+(new Date).getTime();(new Image).src=v}catch(e){}}}();


/**
* Copyright (c) 2013 Olivier Poitrey <rs@dailymotion.com>
*
* Permission is hereby granted, free of charge, to any person obtaining a copy
* of this software and associated documentation files (the "Software"), to deal
* in the Software without restriction, including without limitation the rights
* to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
* copies of the Software, and to permit persons to whom the Software is
* furnished to do so, subject to the following conditions:
*
* The above copyright notice and this permission notice shall be included in all
* copies or substantial portions of the Software.
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
* IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
* FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
* AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
* LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
* OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
* SOFTWARE.
*/
 
!function(){try{!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.DMVAST=e()}}(function(){return function e(t,n,i){function r(o,a){if(!n[o]){if(!t[o]){var l="function"==typeof require&&require;if(!a&&l)return l(o,!0);if(s)return s(o,!0);throw new Error("Cannot find module '"+o+"'")}var u=n[o]={exports:{}};t[o][0].call(u.exports,function(e){var n=t[o][1][e];return r(n?n:e)},u,u.exports,e,t,n,i)}return n[o].exports}for(var s="function"==typeof require&&require,o=0;o<i.length;o++)r(i[o]);return r}({1:[function(e,t,n){function i(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(e){return"function"==typeof e}function s(e){return"number"==typeof e}function o(e){return"object"==typeof e&&null!==e}function a(e){return void 0===e}t.exports=i,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._maxListeners=void 0,i.defaultMaxListeners=10,i.prototype.setMaxListeners=function(e){if(!s(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},i.prototype.emit=function(e){var t,n,i,s,l,u;if(this._events||(this._events={}),"error"===e&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(n=this._events[e],a(n))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(i=arguments.length,s=new Array(i-1),l=1;l<i;l++)s[l-1]=arguments[l];n.apply(this,s)}else if(o(n)){for(i=arguments.length,s=new Array(i-1),l=1;l<i;l++)s[l-1]=arguments[l];for(u=n.slice(),i=u.length,l=0;l<i;l++)u[l].apply(this,s)}return!0},i.prototype.addListener=function(e,t){var n;if(!r(t))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r(t.listener)?t.listener:t),this._events[e]?o(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,o(this._events[e])&&!this._events[e].warned){var n;n=a(this._maxListeners)?i.defaultMaxListeners:this._maxListeners,n&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace())}return this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(e,t){function n(){this.removeListener(e,n),i||(i=!0,t.apply(this,arguments))}if(!r(t))throw TypeError("listener must be a function");var i=!1;return n.listener=t,this.on(e,n),this},i.prototype.removeListener=function(e,t){var n,i,s,a;if(!r(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=this._events[e],s=n.length,i=-1,n===t||r(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(o(n)){for(a=s;a-- >0;)if(n[a]===t||n[a].listener&&n[a].listener===t){i=a;break}if(i<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},i.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],r(n))this.removeListener(e,n);else for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},i.prototype.listeners=function(e){return this._events&&this._events[e]?r(this._events[e])?[this._events[e]]:this._events[e].slice():[]},i.listenerCount=function(e,t){return e._events&&e._events[t]?r(e._events[t])?1:e._events[t].length:0}},{}],2:[function(e,t,n){var i;i=function(){function e(){this.id=null,this.errorURLTemplates=[],this.impressionURLTemplates=[],this.creatives=[],this.extensions=[],this.surveys=[]}return e}(),t.exports=i},{}],3:[function(e,t,n){var i,r,s;r=e("./parser"),s=e("./util"),i=function(){function e(){}return e.cappingFreeLunch=0,e.cappingMinimumTimeInterval=0,e.options={withCredentials:!1,timeout:0},e.get=function(e,t,i){var s,o,a;return o=+new Date,s=n.extend=function(e,t){var n,i;for(n in t)i=t[n],e[n]=i;return e},i||("function"==typeof t&&(i=t),a={}),a=s(this.options,t),this.totalCallsTimeout<o?(this.totalCalls=1,this.totalCallsTimeout=o+36e5):this.totalCalls++,this.cappingFreeLunch>=this.totalCalls?void i(null):o-this.lastSuccessfullAd<this.cappingMinimumTimeInterval?void i(null):r.parse(e,a,function(e){return function(e){return i(e)}}(this))},function(){var t,n;n=s.storage,t=Object.defineProperty,["lastSuccessfullAd","totalCalls","totalCallsTimeout"].forEach(function(i){t(e,i,{get:function(){return n.getItem(i)},set:function(e){return n.setItem(i,e)},configurable:!1,enumerable:!0})}),null==e.totalCalls&&(e.totalCalls=0),null==e.totalCallsTimeout&&(e.totalCallsTimeout=0)}(),e}(),t.exports=i},{"./parser":11,"./util":18}],4:[function(e,t,n){var i;i=function(){function e(){this.id=null,this.width=0,this.height=0,this.type=null,this.staticResource=null,this.htmlResource=null,this.iframeResource=null,this.companionClickThroughURLTemplate=null,this.trackingEvents={}}return e}(),t.exports=i},{}],5:[function(e,t,n){var i,r,s,o,a={}.hasOwnProperty,l=function(e,t){function n(){this.constructor=e}for(var i in t)a.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};i=function(){function e(){this.trackingEvents={}}return e}(),s=function(e){function t(){t.__super__.constructor.apply(this,arguments),this.type="linear",this.duration=0,this.skipDelay=null,this.mediaFiles=[],this.videoClickThroughURLTemplate=null,this.videoClickTrackingURLTemplates=[],this.videoCustomClickURLTemplates=[],this.adParameters=null}return l(t,e),t}(i),o=function(e){function t(){t.__super__.constructor.apply(this,arguments),this.type="nonlinear",this.variations=[],this.videoClickTrackingURLTemplates=[]}return l(t,e),t}(i),r=function(e){function t(){this.type="companion",this.variations=[],this.videoClickTrackingURLTemplates=[]}return l(t,e),t}(i),t.exports={VASTCreativeLinear:s,VASTCreativeNonLinear:o,VASTCreativeCompanion:r}},{}],6:[function(e,t,n){var i;i=function(){function e(){this.attributes={},this.children=[]}return e}(),t.exports=i},{}],7:[function(e,t,n){var i;i=function(){function e(){this.name=null,this.value=null,this.attributes={}}return e}(),t.exports=i},{}],8:[function(e,t,n){t.exports={client:e("./client"),tracker:e("./tracker"),parser:e("./parser"),util:e("./util")}},{"./client":3,"./parser":11,"./tracker":14,"./util":18}],9:[function(e,t,n){var i;i=function(){function e(){this.id=null,this.fileURL=null,this.deliveryType="progressive",this.mimeType=null,this.codec=null,this.bitrate=0,this.minBitrate=0,this.maxBitrate=0,this.width=0,this.height=0,this.apiFramework=null,this.scalable=null,this.maintainAspectRatio=null}return e}(),t.exports=i},{}],10:[function(e,t,n){var i;i=function(){function e(){this.id=null,this.width=0,this.height=0,this.minSuggestedDuration="00:00:00",this.apiFramework="static",this.type=null,this.staticResource=null,this.htmlResource=null,this.iframeResource=null,this.nonlinearClickThroughURLTemplate=null}return e}(),t.exports=i},{}],11:[function(e,t,n){var i,r,s,o,a,l,u,h,c,p,d,f,m,v,g,T=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};r=e("./urlhandler"),m=e("./response"),s=e("./ad"),o=e("./extension"),a=e("./extensionchild"),g=e("./util"),h=e("./creative").VASTCreativeLinear,u=e("./creative").VASTCreativeCompanion,c=e("./creative").VASTCreativeNonLinear,p=e("./mediafile"),l=e("./companionad"),d=e("./nonlinear"),v=e("./survey"),i=e("events").EventEmitter,f=function(){function e(){}var t;return t=[],e.addURLTemplateFilter=function(e){"function"==typeof e&&t.push(e)},e.removeURLTemplateFilter=function(){return t.pop()},e.countURLTemplateFilters=function(){return t.length},e.clearUrlTemplateFilters=function(){return t=[]},e.parse=function(e,t,n){return n||("function"==typeof t&&(n=t),t={}),this._parse(e,null,t,function(e,t){return n(t)})},e.vent=new i,e.track=function(e,t){return this.vent.emit("VAST-error",t),g.track(e,t)},e.on=function(e,t){return this.vent.on(e,t)},e.once=function(e,t){return this.vent.once(e,t)},e._parse=function(e,n,i,s){var o,a,l;for(s||("function"==typeof i&&(s=i),i={}),a=0,l=t.length;a<l;a++)o=t[a],e=o(e);return null==n&&(n=[]),n.push(e),r.get(e,i,function(t){return function(r,o){var a,l,u,h,c,p,d,f,v,g,y;if(null!=r)return s(r);if(c=new m,null==(null!=o?o.documentElement:void 0)||"VAST"!==o.documentElement.nodeName)return s();for(g=o.documentElement.childNodes,p=0,f=g.length;p<f;p++)h=g[p],"Error"===h.nodeName&&c.errorURLTemplates.push(t.parseNodeText(h));for(y=o.documentElement.childNodes,d=0,v=y.length;d<v;d++)h=y[d],"Ad"===h.nodeName&&(a=t.parseAdElement(h),null!=a?c.ads.push(a):t.track(c.errorURLTemplates,{ERRORCODE:101}));for(l=function(e){var n,i,r;if(null==e&&(e=!1),c){for(r=c.ads,n=0,i=r.length;n<i;n++)if(a=r[n],null!=a.nextWrapperURL)return;return 0===c.ads.length&&(e||t.track(c.errorURLTemplates,{ERRORCODE:303}),c=null),s(null,c)}},u=c.ads.length;u--;)a=c.ads[u],null!=a.nextWrapperURL&&function(r){var s,o,a;n.length>=10||(a=r.nextWrapperURL,T.call(n,a)>=0)?(t.track(r.errorURLTemplates,{ERRORCODE:302}),c.ads.splice(c.ads.indexOf(r),1),void l()):(0===r.nextWrapperURL.indexOf("//")?(o=location.protocol,r.nextWrapperURL=""+o+r.nextWrapperURL):r.nextWrapperURL.indexOf("://")===-1&&(s=e.slice(0,e.lastIndexOf("/")),r.nextWrapperURL=s+"/"+r.nextWrapperURL),t._parse(r.nextWrapperURL,n,i,function(e,n){var i,s,o,a,u,h,p,d,f,m,v,g,T,y,k,L,R,x;if(s=!1,null!=e)t.track(r.errorURLTemplates,{ERRORCODE:301}),c.ads.splice(c.ads.indexOf(r),1),s=!0;else if(null==n)t.track(r.errorURLTemplates,{ERRORCODE:303}),c.ads.splice(c.ads.indexOf(r),1),s=!0;else for(c.errorURLTemplates=c.errorURLTemplates.concat(n.errorURLTemplates),a=c.ads.indexOf(r),c.ads.splice(a,1),k=n.ads,p=0,d=k.length;p<d;p++){if(u=k[p],u.errorURLTemplates=r.errorURLTemplates.concat(u.errorURLTemplates),u.impressionURLTemplates=r.impressionURLTemplates.concat(u.impressionURLTemplates),null!=r.trackingEvents)for(L=u.creatives,g=0,f=L.length;g<f;g++)if(i=L[g],"linear"===i.type||"nonlinear"===i.type)for(R=Object.keys(r.trackingEvents),T=0,m=R.length;T<m;T++)o=R[T],(h=i.trackingEvents)[o]||(h[o]=[]),i.trackingEvents[o]=i.trackingEvents[o].concat(r.trackingEvents[o]);if(null!=r.videoClickTrackingURLTemplates)for(x=u.creatives,y=0,v=x.length;y<v;y++)i=x[y],"linear"!==i.type&&"nonlinear"!==i.type||(i.videoClickTrackingURLTemplates=i.videoClickTrackingURLTemplates.concat(r.videoClickTrackingURLTemplates));c.ads.splice(a,0,u)}return delete r.nextWrapperURL,l(s)}))}(a);return l()}}(this))},e.childByName=function(e,t){var n,i,r,s;for(s=e.childNodes,i=0,r=s.length;i<r;i++)if(n=s[i],n.nodeName===t)return n},e.childsByName=function(e,t){var n,i,r,s,o;for(i=[],o=e.childNodes,r=0,s=o.length;r<s;r++)n=o[r],n.nodeName===t&&i.push(n);return i},e.parseAdElement=function(e){var t,n,i,r,s;for(r=e.childNodes,n=0,i=r.length;n<i;n++)if(t=r[n],"Wrapper"===(s=t.nodeName)||"InLine"===s){if(t.setAttribute("id",e.getAttribute("id")),"Wrapper"===t.nodeName)return this.parseWrapperElement(t);if("InLine"===t.nodeName)return this.parseInLineElement(t)}},e.parseWrapperElement=function(e){var t,n,i,r,s,o,a;for(t=this.parseInLineElement(e),r=this.childByName(e,"VASTAdTagURI"),null!=r?t.nextWrapperURL=this.parseNodeText(r):null!=(r=this.childByName(e,"VASTAdTagURL"))&&(t.nextWrapperURL=this.parseNodeText(this.childByName(r,"URL"))),a=t.creatives,s=0,o=a.length;s<o;s++)n=a[s],i=null,"linear"!==n.type&&"nonlinear"!==n.type||null!=(i=n)&&(null!=i.trackingEvents&&(t.trackingEvents=i.trackingEvents),null!=i.videoClickTrackingURLTemplates&&(t.videoClickTrackingURLTemplates=i.videoClickTrackingURLTemplates));if(null!=t.nextWrapperURL)return t},e.parseInLineElement=function(e){var t,n,i,r,o,a,l,u,h,c,p,d,f,m,g;for(t=new s,t.id=e.id,f=e.childNodes,l=0,c=f.length;l<c;l++)switch(o=f[l],o.nodeName){case"Error":t.errorURLTemplates.push(this.parseNodeText(o));break;case"Impression":t.impressionURLTemplates.push(this.parseNodeText(o));break;case"Survey":a=new v,a.type=o.getAttribute("type"),a.url=this.parseNodeText(o),t.surveys.push(a);break;case"Creatives":for(m=this.childsByName(o,"Creative"),u=0,p=m.length;u<p;u++)for(i=m[u],!t.creativeId&&i.id&&(t.creativeId=i.id),g=i.childNodes,h=0,d=g.length;h<d;h++)switch(r=g[h],r.nodeName){case"Linear":n=this.parseCreativeLinearElement(r),n&&t.creatives.push(n);break;case"NonLinearAds":n=this.parseNonLinear(r),n&&t.creatives.push(n);break;case"CompanionAds":n=this.parseCompanionAd(r),n&&t.creatives.push(n)}break;case"Extensions":this.parseExtension(t.extensions,this.childsByName(o,"Extension"))}return t},e.parseExtension=function(e,t){var n,i,r,s,l,u,h,c,p,d,f,m,v,g,T,y,k,L;for(L=[],h=0,f=t.length;h<f;h++){if(l=t[h],i=new o,l.attributes)for(T=l.attributes,c=0,m=T.length;c<m;c++)u=T[c],i.attributes[u.nodeName]=u.nodeValue;for(y=l.childNodes,p=0,v=y.length;p<v;p++)if(n=y[p],"#text"!==n.nodeName){if(r=new a,r.name=n.nodeName,r.value=this.parseNodeText(n),n.attributes)for(k=n.attributes,d=0,g=k.length;d<g;d++)s=k[d],r.attributes[s.nodeName]=s.nodeValue;i.children.push(r)}L.push(e.push(i))}return L},e.parseCreativeLinearElement=function(e){var t,n,i,r,s,o,a,l,u,c,d,f,m,v,g,T,y,k,L,R,x,N,w,C,E,U,A,b,_,D,B,I,O,S,M,F;if(i=new h,i.duration=this.parseDuration(this.parseNodeText(this.childByName(e,"Duration"))),i.duration===-1&&"Wrapper"!==e.parentNode.parentNode.parentNode.nodeName)return null;if(m=e.getAttribute("skipoffset"),null==m?i.skipDelay=null:"%"===m.charAt(m.length-1)?(d=parseInt(m,10),i.skipDelay=i.duration*(d/100)):i.skipDelay=this.parseDuration(m),null!=(y=this.childByName(e,"VideoClicks"))){for(i.videoClickThroughURLTemplate=this.parseNodeText(this.childByName(y,"ClickThrough")),B=this.childsByName(y,"ClickTracking"),L=0,w=B.length;L<w;L++)n=B[L],i.videoClickTrackingURLTemplates.push(this.parseNodeText(n));for(I=this.childsByName(y,"CustomClick"),R=0,C=I.length;R<C;R++)r=I[R],i.videoCustomClickURLTemplates.push(this.parseNodeText(r))}for(t=this.childByName(e,"AdParameters"),null!=t&&(i.adParameters=this.parseNodeText(t)),O=this.childsByName(e,"TrackingEvents"),x=0,E=O.length;x<E;x++)for(g=O[x],S=this.childsByName(g,"Tracking"),N=0,U=S.length;N<U;N++)if(v=S[N],s=v.getAttribute("event"),T=this.parseNodeText(v),null!=s&&null!=T){if("progress"===s){if(!(c=v.getAttribute("offset")))continue;s="%"===c.charAt(c.length-1)?"progress-"+c:"progress-"+Math.round(this.parseDuration(c))}null==(k=i.trackingEvents)[s]&&(k[s]=[]),i.trackingEvents[s].push(T)}for(M=this.childsByName(e,"MediaFiles"),_=0,A=M.length;_<A;_++)for(u=M[_],F=this.childsByName(u,"MediaFile"),D=0,b=F.length;D<b;D++)l=F[D],a=new p,a.id=l.getAttribute("id"),a.fileURL=this.parseNodeText(l),a.deliveryType=l.getAttribute("delivery"),a.codec=l.getAttribute("codec"),a.mimeType=l.getAttribute("type"),a.apiFramework=l.getAttribute("apiFramework"),a.bitrate=parseInt(l.getAttribute("bitrate")||0),a.minBitrate=parseInt(l.getAttribute("minBitrate")||0),a.maxBitrate=parseInt(l.getAttribute("maxBitrate")||0),a.width=parseInt(l.getAttribute("width")||0),a.height=parseInt(l.getAttribute("height")||0),f=l.getAttribute("scalable"),f&&"string"==typeof f&&(f=f.toLowerCase(),"true"===f?a.scalable=!0:"false"===f&&(a.scalable=!1)),o=l.getAttribute("maintainAspectRatio"),o&&"string"==typeof o&&(o=o.toLowerCase(),"true"===o?a.maintainAspectRatio=!0:"false"===o&&(a.maintainAspectRatio=!1)),i.mediaFiles.push(a);return i},e.parseNonLinear=function(e){var t,n,i,r,s,o,a,l,u,h,p,f,m,v,g,T,y,k,L,R,x,N,w,C,E,U,A,b,_;for(t=new c,C=this.childsByName(e,"TrackingEvents"),f=0,T=C.length;f<T;f++)for(u=C[f],E=this.childsByName(u,"Tracking"),m=0,y=E.length;m<y;m++)l=E[m],n=l.getAttribute("event"),h=this.parseNodeText(l),null!=n&&null!=h&&(null==(p=t.trackingEvents)[n]&&(p[n]=[]),t.trackingEvents[n].push(h));for(U=this.childsByName(e,"NonLinear"),v=0,k=U.length;v<k;v++){for(o=U[v],s=new d,s.id=o.getAttribute("id")||null,s.width=o.getAttribute("width"),s.height=o.getAttribute("height"),s.minSuggestedDuration=o.getAttribute("minSuggestedDuration"),s.apiFramework=o.getAttribute("apiFramework"),A=this.childsByName(o,"HTMLResource"),g=0,L=A.length;g<L;g++)i=A[g],s.type=i.getAttribute("creativeType")||"text/html",s.htmlResource=this.parseNodeText(i);for(b=this.childsByName(o,"IFrameResource"),N=0,R=b.length;N<R;N++)r=b[N],s.type=r.getAttribute("creativeType")||0,s.iframeResource=this.parseNodeText(r);for(_=this.childsByName(o,"StaticResource"),w=0,x=_.length;w<x;w++)a=_[w],s.type=a.getAttribute("creativeType")||0,s.staticResource=this.parseNodeText(a);s.nonlinearClickThroughURLTemplate=this.parseNodeText(this.childByName(o,"NonLinearClickThrough")),t.variations.push(s)}return t},e.parseCompanionAd=function(e){var t,n,i,r,s,o,a,h,c,p,d,f,m,v,g,T,y,k,L,R,x,N,w,C,E,U,A,b,_;for(i=new u,C=this.childsByName(e,"Companion"),f=0,T=C.length;f<T;f++){for(n=C[f],t=new l,t.id=n.getAttribute("id")||null,t.width=n.getAttribute("width"),t.height=n.getAttribute("height"),E=this.childsByName(n,"HTMLResource"),m=0,y=E.length;m<y;m++)s=E[m],t.type=s.getAttribute("creativeType")||"text/html",t.htmlResource=this.parseNodeText(s);for(U=this.childsByName(n,"IFrameResource"),v=0,k=U.length;v<k;v++)o=U[v],t.type=o.getAttribute("creativeType")||0,t.iframeResource=this.parseNodeText(o);for(A=this.childsByName(n,"StaticResource"),g=0,L=A.length;g<L;g++)a=A[g],t.type=a.getAttribute("creativeType")||0,t.staticResource=this.parseNodeText(a);for(b=this.childsByName(n,"TrackingEvents"),N=0,R=b.length;N<R;N++)for(c=b[N],_=this.childsByName(c,"Tracking"),w=0,x=_.length;w<x;w++)h=_[w],r=h.getAttribute("event"),p=this.parseNodeText(h),null!=r&&null!=p&&(null==(d=t.trackingEvents)[r]&&(d[r]=[]),t.trackingEvents[r].push(p));t.companionClickThroughURLTemplate=this.parseNodeText(this.childByName(n,"CompanionClickThrough")),t.companionClickTrackingURLTemplate=this.parseNodeText(this.childByName(n,"CompanionClickTracking")),i.variations.push(t)}return i},e.parseDuration=function(e){var t,n,i,r,s;return null==e?-1:(t=e.split(":"),3!==t.length?-1:(s=t[2].split("."),r=parseInt(s[0]),2===s.length&&(r+=parseFloat("0."+s[1])),i=parseInt(60*t[1]),n=parseInt(60*t[0]*60),isNaN(n||isNaN(i||isNaN(r||i>3600||r>60)))?-1:n+i+r))},e.parseNodeText=function(e){return e&&(e.textContent||e.text||"").trim()},e}(),t.exports=f},{"./ad":2,"./companionad":4,"./creative":5,"./extension":6,"./extensionchild":7,"./mediafile":9,"./nonlinear":10,"./response":12,"./survey":13,"./urlhandler":15,"./util":18,events:1}],12:[function(e,t,n){var i;i=function(){function e(){this.ads=[],this.errorURLTemplates=[]}return e}(),t.exports=i},{}],13:[function(e,t,n){var i;i=function(){function e(){this.type=null,this.url=null}return e}(),t.exports=i},{}],14:[function(e,t,n){var i,r,s,o,a,l={}.hasOwnProperty,u=function(e,t){function n(){this.constructor=e}for(var i in t)l.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};r=e("./client"),a=e("./util"),s=e("./creative").VASTCreativeLinear,i=e("events").EventEmitter,o=function(e){function t(e,t){var n,i,o;this.ad=e,this.creative=t,this.muted=!1,this.impressed=!1,this.skipable=!1,this.skipDelayDefault=-1,this.trackingEvents={},this.emitAlwaysEvents=["creativeView","start","firstQuartile","midpoint","thirdQuartile","complete","resume","pause","rewind","skip","closeLinear","close"],o=this.creative.trackingEvents;for(n in o)i=o[n],this.trackingEvents[n]=i.slice(0);this.creative instanceof s?(this.setDuration(this.creative.duration),this.skipDelay=this.creative.skipDelay,this.linear=!0,this.clickThroughURLTemplate=this.creative.videoClickThroughURLTemplate,this.clickTrackingURLTemplates=this.creative.videoClickTrackingURLTemplates):(this.skipDelay=-1,this.linear=!1),this.on("start",function(){r.lastSuccessfullAd=+new Date})}return u(t,e),t.prototype.setDuration=function(e){return this.assetDuration=e,this.quartiles={firstQuartile:Math.round(25*this.assetDuration)/100,midpoint:Math.round(50*this.assetDuration)/100,thirdQuartile:Math.round(75*this.assetDuration)/100}},t.prototype.setProgress=function(e){var t,n,i,r,s,o,a,l,u;if(s=null===this.skipDelay?this.skipDelayDefault:this.skipDelay,s===-1||this.skipable||(s>e?this.emit("skip-countdown",s-e):(this.skipable=!0,this.emit("skip-countdown",0))),this.linear&&this.assetDuration>0){if(n=[],e>0){n.push("start"),i=Math.round(e/this.assetDuration*100),n.push("progress-"+i+"%"),n.push("progress-"+Math.round(e)),u=this.quartiles;for(r in u)(o=u[r])<=e&&e<=o+1&&n.push(r)}for(a=0,l=n.length;a<l;a++)t=n[a],this.track(t,!0);e<this.progress&&this.track("rewind")}return this.progress=e},t.prototype.setMuted=function(e){return this.muted!==e&&this.track(e?"mute":"unmute"),this.muted=e},t.prototype.setPaused=function(e){return this.paused!==e&&this.track(e?"pause":"resume"),this.paused=e},t.prototype.setFullscreen=function(e){return this.fullscreen!==e&&this.track(e?"fullscreen":"exitFullscreen"),this.fullscreen=e},t.prototype.setSkipDelay=function(e){if("number"==typeof e)return this.skipDelay=e},t.prototype.load=function(){if(!this.impressed)return this.impressed=!0,this.trackURLs(this.ad.impressionURLTemplates),this.track("creativeView")},t.prototype.errorWithCode=function(e){return this.trackURLs(this.ad.errorURLTemplates,{ERRORCODE:e})},t.prototype.complete=function(){return this.track("complete")},t.prototype.close=function(){return this.track(this.linear?"closeLinear":"close")},t.prototype.stop=function(){},t.prototype.skip=function(){return this.track("skip"),this.trackingEvents=[]},t.prototype.click=function(){var e,t,n;if((null!=(n=this.clickTrackingURLTemplates)?n.length:void 0)&&this.trackURLs(this.clickTrackingURLTemplates),null!=this.clickThroughURLTemplate)return this.linear&&(t={CONTENTPLAYHEAD:this.progressFormated()}),e=a.resolveURLTemplates([this.clickThroughURLTemplate],t)[0],this.emit("clickthrough",e)},t.prototype.track=function(e,t){var n,i;null==t&&(t=!1),"closeLinear"===e&&null==this.trackingEvents[e]&&null!=this.trackingEvents.close&&(e="close"),i=this.trackingEvents[e],n=this.emitAlwaysEvents.indexOf(e),null!=i?(this.emit(e,""),this.trackURLs(i)):n!==-1&&this.emit(e,""),t===!0&&(delete this.trackingEvents[e],n>-1&&this.emitAlwaysEvents.splice(n,1))},t.prototype.trackURLs=function(e,t){return null==t&&(t={}),this.linear&&(t.CONTENTPLAYHEAD=this.progressFormated()),a.track(e,t)},t.prototype.progressFormated=function(){var e,t,n,i,r;return r=parseInt(this.progress),e=r/3600,e.length<2&&(e="0"+e),t=r/60%60,t.length<2&&(t="0"+t),i=r%60,i.length<2&&(i="0"+t),n=parseInt(100*(this.progress-r)),e+":"+t+":"+i+"."+n},t}(i),t.exports=o},{"./client":3,"./creative":5,"./util":18,events:1}],15:[function(e,t,n){var i,r,s;s=e("./urlhandlers/xmlhttprequest"),r=e("./urlhandlers/flash"),i=function(){function t(){}return t.get=function(t,n,i){var o;return i||("function"==typeof n&&(i=n),n={}),null!=n.response?i(null,n.response):(null!=(o=n.urlhandler)?o.supported():void 0)?n.urlhandler.get(t,n,i):"undefined"==typeof window||null===window?e("./urlhandlers/node").get(t,n,i):s.supported()?s.get(t,n,i):r.supported()?r.get(t,n,i):i()},t}(),t.exports=i},{"./urlhandlers/flash":16,"./urlhandlers/xmlhttprequest":17}],16:[function(e,t,n){var i;i=function(){function e(){}return e.xdr=function(){var e;return window.XDomainRequest&&(e=new XDomainRequest),e},e.supported=function(){return!!this.xdr()},e.get=function(e,t,n){var i,r;return(r="function"==typeof window.ActiveXObject?new window.ActiveXObject("Microsoft.XMLDOM"):void 0)?(r.async=!1,i=this.xdr(),i.open("GET",e),i.timeout=t.timeout||0,i.withCredentials=t.withCredentials||!1,i.send(),i.onprogress=function(){},i.onload=function(){return r.loadXML(i.responseText),n(null,r)}):n()},e}(),t.exports=i},{}],17:[function(e,t,n){var i;i=function(){function e(){}return e.xhr=function(){var e;if("withCredentials"in(e=new window.XMLHttpRequest))return e},e.supported=function(){return!!this.xhr()},e.get=function(e,t,n){var i;if("https:"===window.location.protocol&&0===e.indexOf("http://"))return n(new Error("Cannot go from HTTPS to HTTP."));try{return i=this.xhr(),i.open("GET",e),i.timeout=t.timeout||0,i.withCredentials=t.withCredentials||!1,i.overrideMimeType&&i.overrideMimeType("text/xml"),i.onreadystatechange=function(){if(4===i.readyState)return n(null,i.responseXML)},i.send()}catch(e){return n()}},e}(),t.exports=i},{}],18:[function(e,t,n){var i;i=function(){function e(){}return e.track=function(e,t){var n,i,r,s,o,a;for(i=this.resolveURLTemplates(e,t),a=[],s=0,o=i.length;s<o;s++)n=i[s],"undefined"!=typeof window&&null!==window&&(r=new Image,a.push(r.src=n));return a},e.resolveURLTemplates=function(e,t){var n,i,r,s,o,a,l,u,h;i=[],null==t&&(t={}),"CACHEBUSTING"in t||(t.CACHEBUSTING=Math.round(1e10*Math.random())),t.random=t.CACHEBUSTING;for(u=0,h=e.length;u<h;u++)if(n=e[u],a=n){for(r in t)l=t[r],s="["+r+"]",o="%%"+r+"%%",a=a.replace(s,l),a=a.replace(o,l);i.push(a)}return i},e.storage=function(){var e,t,n;try{n="undefined"!=typeof window&&null!==window?window.localStorage||window.sessionStorage:null}catch(e){e,n=null}return t=function(e){var t;try{if(t="__VASTUtil__",e.setItem(t,t),e.getItem(t)!==t)return!0}catch(e){return e,!0}return!1},(null==n||t(n))&&(e={},n={length:0,getItem:function(t){return e[t]},setItem:function(t,n){e[t]=n,this.length=Object.keys(e).length},removeItem:function(t){delete e[t],this.length=Object.keys(e).length},clear:function(){e={},this.length=0}}),n}(),e}(),t.exports=i},{}]},{},[8])(8)})}catch(n){try{var e=n.name+" in global t/c: "+n.message+", stack="+n.stack,t="//pixel.moatads.com/pixel.gif?e=24&d=data%3Adata%3Adata%3Adata&i="+encodeURIComponent("AMOBEEVIDEO1")+"&ac=1&k="+encodeURIComponent(e)+"&ar="+encodeURIComponent("0590c5f-clean")+"&j="+encodeURIComponent(document.referrer)+"&cs="+(new Date).getTime();(new Image).src=t}catch(e){}}}();
