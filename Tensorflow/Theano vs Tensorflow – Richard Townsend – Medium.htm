<!DOCTYPE html>
<!-- saved from url=(0074)https://medium.com/@sentimentron/faceoff-theano-vs-tensorflow-e25648c31800 -->
<html xmlns:cc="http://creativecommons.org/ns#"><head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# medium-com: http://ogp.me/ns/fb/medium-com#"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Theano vs Tensorflow – Richard Townsend – Medium</title><link rel="canonical" href="https://medium.com/@sentimentron/faceoff-theano-vs-tensorflow-e25648c31800"><meta name="title" content="Theano vs Tensorflow – Richard Townsend – Medium"><meta name="referrer" content="always"><meta name="description" content="TensorFlow is a recent addition to a constellation of frameworks designed to accelerate the process of building deep models. Of these, I’ve only previously had time to learn Theano — one of the more…"><meta property="og:title" content="Theano vs Tensorflow – Richard Townsend – Medium"><meta property="og:url" content="https://medium.com/@sentimentron/faceoff-theano-vs-tensorflow-e25648c31800"><meta property="og:image" content="https://cdn-images-1.medium.com/max/1200/1*5JiPSy-VWASl7L9kflq4ag.png"><meta property="fb:app_id" content="542599432471018"><meta property="og:description" content="Should you rewrite everything?"><meta name="twitter:description" content="Should you rewrite everything?"><meta name="twitter:image:src" content="https://cdn-images-1.medium.com/max/1200/1*5JiPSy-VWASl7L9kflq4ag.png"><link rel="publisher" href="https://plus.google.com/103654360130207659246"><link rel="author" href="https://medium.com/@sentimentron"><meta property="author" content="Richard Townsend"><meta property="og:type" content="article"><meta name="twitter:card" content="summary_large_image"><meta property="article:publisher" content="https://www.facebook.com/medium"><meta property="article:author" content="Richard Townsend"><meta property="fb:smart_publish:robots" content="noauto"><meta name="robots" content="index, follow"><meta property="article:published_time" content="2016-05-30T17:25:29.213Z"><meta name="twitter:site" content="@Medium"><meta property="og:site_name" content="Medium"><meta name="twitter:label1" value="Reading time"><meta name="twitter:data1" value="9 min read"><script type="text/javascript" async="" src="./Theano vs Tensorflow – Richard Townsend – Medium_files/ga.js"></script><script type="application/ld+json">{"@context":"http://schema.org","@type":"NewsArticle","image":{"@type":"ImageObject","width":1920,"height":921,"url":"https://cdn-images-1.medium.com/max/2000/1*5JiPSy-VWASl7L9kflq4ag.png"},"datePublished":"2016-05-30T17:25:29.213Z","dateModified":"2017-04-21T08:45:54.566Z","headline":"Theano vs Tensorflow","name":"Theano vs Tensorflow","keywords":["Deep Learning","Machine Learning","TensorFlow"],"author":{"@type":"Person","name":"Richard Townsend","url":"https://medium.com/@sentimentron"},"creator":["Richard Townsend"],"mainEntityOfPage":"https://medium.com/@sentimentron/faceoff-theano-vs-tensorflow-e25648c31800"}</script><meta name="twitter:app:name:iphone" content="Medium"><meta name="twitter:app:id:iphone" content="828256236"><meta name="twitter:app:url:iphone" content="medium://p/e25648c31800"><meta property="al:ios:app_name" content="Medium"><meta property="al:ios:app_store_id" content="828256236"><meta property="al:android:package" content="com.medium.reader"><meta property="al:android:app_name" content="Medium"><meta property="al:ios:url" content="medium://p/e25648c31800"><meta property="al:android:url" content="medium://p/e25648c31800"><meta property="al:web:url" content="https://medium.com/@sentimentron/faceoff-theano-vs-tensorflow-e25648c31800"><link rel="search" type="application/opensearchdescription+xml" title="Medium" href="https://medium.com/osd.xml"><link rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/e25648c31800"><meta name="theme-color" content="#000000"><link rel="stylesheet" type="text/css" href="./Theano vs Tensorflow – Richard Townsend – Medium_files/fonts-lazy-latin-base.jMU532QDmysQMOINr-cr2A.css"><link rel="stylesheet" href="./Theano vs Tensorflow – Richard Townsend – Medium_files/main-base.yWJy42GYy18J8Z6wl98nqg.css"><script>if (window.top !== window.self) window.top.location = window.self.location.href;var OB_startTime = new Date().getTime(); var OB_loadErrors = []; function _onerror(e) { OB_loadErrors.push(e) }; if (document.addEventListener) document.addEventListener("error", _onerror, true); else if (document.attachEvent) document.attachEvent("onerror", _onerror); function _asyncScript(u) {var d = document, f = d.getElementsByTagName("script")[0], s = d.createElement("script"); s.type = "text/javascript"; s.async = true; s.src = u; f.parentNode.insertBefore(s, f);}function _asyncStyles(u) {var d = document, f = d.getElementsByTagName("script")[0], s = d.createElement("link"); s.rel = "stylesheet"; s.href = u; f.parentNode.insertBefore(s, f); return s}var _gaq = _gaq || [];_gaq.push(["_setAccount", "UA-24232453-2"]); _gaq.push(["_setDomainName", window.location.hostname]); _gaq.push(["_setAllowLinker", true]); _gaq.push(["_trackPageview"]);_asyncScript(("https:" == document.location.protocol ? "https://ssl" : "http://www") + ".google-analytics.com/ga.js");(new Image()).src = "/_/stat?event=pixel.load&origin=" + encodeURIComponent(location.origin);</script><!--[if lt IE 9]><script charset="UTF-8" src="https://cdn-static-1.medium.com/_/fp/js/shiv.RI2ePTZ5gFmMgLzG5bEVAA.js"></script><![endif]--><link rel="icon" href="https://cdn-static-1.medium.com/_/fp/icons/favicon-medium.TAS6uQ-Y7kcKgi0xjcYHXw.ico" class="js-favicon"><link rel="apple-touch-icon" sizes="152x152" href="https://cdn-images-1.medium.com/fit/c/304/304/1*W0nmth_X8nFKjn6BZ388UQ.png"><link rel="apple-touch-icon" sizes="120x120" href="https://cdn-images-1.medium.com/fit/c/240/240/1*W0nmth_X8nFKjn6BZ388UQ.png"><link rel="apple-touch-icon" sizes="76x76" href="https://cdn-images-1.medium.com/fit/c/152/152/1*W0nmth_X8nFKjn6BZ388UQ.png"><link rel="apple-touch-icon" sizes="60x60" href="https://cdn-images-1.medium.com/fit/c/120/120/1*W0nmth_X8nFKjn6BZ388UQ.png"><link rel="mask-icon" href="https://cdn-static-1.medium.com/_/fp/icons/favicon.KjTfUJo7yJH_fCoUzzH3cg.svg" color="#171717"></head><body itemscope="" class="postShowScreen browser-chrome os-mac is-withMagicUnderlines is-js" data-action-scope="_actionscope_0"><script>document.body.className = document.body.className.replace(/(^|\s)is-noJs(\s|$)/, "$1is-js$2")</script><div class="site-main surface-container" id="container"><div class="butterBar butterBar--error" data-action-scope="_actionscope_1"></div><div class="surface" id="_obv.shell._surface_1493015003863" style="display: block; visibility: visible;"><div class="screenContent surface-content is-supplementalPostContentLoaded" data-used="true" data-action-scope="_actionscope_2"><canvas class="canvas-renderer" width="1440" height="679"></canvas><div class="container u-maxWidth740 u-xs-margin0 notesPositionContainer js-notesPositionContainer"><div class="notesMarkers" data-action-scope="_actionscope_4"></div></div><div class="metabar u-clearfix js-metabar is-hiddenWhenMinimized"><div class="metabar-inner u-marginAuto u-maxWidth1000 u-paddingLeft20 u-paddingRight20 js-metabarMiddle"><div class="metabar-block metabar-block--left u-floatLeft u-height65 u-xs-height56"><a href="https://medium.com/" class="siteNav-logo" data-log-event="home"><span class="svgIcon svgIcon--logoNew svgIcon--45px is-flushLeft"><svg class="svgIcon-use" width="45" height="45" viewBox="-17 18 45 45" data-multipart="true"><path d="M11.525 28.078c-.472-.225-.858.002-.858.506v20.044l8.616 4.113c.948.46 1.717.14 1.717-.7v-19.3a.22.22 0 0 0-.124-.19l-9.35-4.46v-.01z"></path><path d="M.333 43.696l9.83-15.247c.278-.43.89-.6 1.36-.38l9.364 4.47c.06.03.082.1.047.15L10.666 48.63.333 43.698v-.002z"></path><path d="M-8.57 28.35c-.786-.375-1.053-.096-.592.62L.333 43.696l10.333 4.932L.356 32.635a.156.156 0 0 0-.06-.054l-8.866-4.23z"></path><path d="M.333 52.033c0 .84-.643 1.22-1.43.844l-8.045-3.84c-.472-.224-.858-.82-.858-1.325V28.89c0-.672.515-.976 1.145-.675l9.133 4.36a.092.092 0 0 1 .055.084v19.37z"></path></svg></span><span class="u-textScreenReader">Homepage</span></a></div><div class="metabar-block u-floatRight u-xs-absolute u-xs-textAlignRight u-xs-right0 u-xs-marginRight20 u-height65 u-xs-height56"><div class="buttonSet"><a class="button button--primary button--chromeless u-accentColor--buttonNormal is-inSiteNavBar u-lineHeight30 u-height32" href="https://medium.com/m/signin?redirect=https%3A%2F%2Fmedium.com%2F%40sentimentron%2Ffaceoff-theano-vs-tensorflow-e25648c31800" data-action="sign-in-prompt" data-redirect="https://medium.com/@sentimentron/faceoff-theano-vs-tensorflow-e25648c31800" data-action-source="nav_signup">Sign in / Sign up</a></div></div></div></div><div class="metabar metabar--spacer js-metabarSpacer u-height65 u-xs-height56"></div><main role="main"><article class=" u-sizeViewHeightMin100 u-overflowHidden postArticle postArticle--full u-marginBottom40" lang="en" data-scroll="native"><header class="container u-maxWidth740"><div class="postMetaHeader u-paddingBottom10 row"><div class="col u-size12of12 js-postMetaLockup"><div class="postMetaLockup postMetaLockup--authorWithBio u-flex js-postMetaLockup"><div class="u-flex0"><a class="link avatar u-baseColor--link" href="https://medium.com/@sentimentron?source=post_header_lockup" data-action="show-user-card" data-action-source="post_header_lockup" data-action-value="ec21902de320" data-action-type="hover" data-user-id="ec21902de320" dir="auto"><img src="./Theano vs Tensorflow – Richard Townsend – Medium_files/0-j0J7Tp44phEIV9r3.jpg" class="avatar-image avatar-image--small" alt="Go to the profile of Richard Townsend"></a></div><div class="u-flex1 u-paddingLeft15 u-overflowHidden"><a class="link link link--darken link--darker u-baseColor--link" href="https://medium.com/@sentimentron?source=post_header_lockup" data-action="show-user-card" data-action-source="post_header_lockup" data-action-value="ec21902de320" data-action-type="hover" data-user-id="ec21902de320" dir="auto">Richard Townsend</a><span class="followState js-followState buttonSet-inner" data-user-id="ec21902de320"><button class="button u-paddingLeft10 u-paddingRight10 u-height19 u-lineHeight13 u-verticalAlignMiddle u-fontSize12 u-uiTextMedium u-noUserSelect button--withChrome u-baseColor--buttonNormal button--withHover button--unblock js-unblockButton u-marginLeft10 u-marginTopNegative2 u-xs-hide" data-action="sign-in-prompt" data-sign-in-action="toggle-block-user" data-requires-token="true" data-action-source="post_header_lockup"><span class="button-label  button-defaultState">Blocked</span><span class="button-label button-hoverState">Unblock</span></button><button class="button button--primary u-paddingLeft10 u-paddingRight10 u-height19 u-lineHeight13 u-verticalAlignMiddle u-fontSize12 u-uiTextMedium u-noUserSelect button--withChrome u-accentColor--buttonNormal button--follow js-followButton u-marginLeft10 u-marginTopNegative2 u-xs-hide" data-action="sign-in-prompt" data-sign-in-action="toggle-subscribe-user" data-requires-token="true" data-redirect="https://medium.com/_/subscribe/user/ec21902de320" data-action-source="post_header_lockup_follow"><span class="button-label  button-defaultState js-buttonLabel">Follow</span><span class="button-label button-activeState">Following</span></button></span><div class="postMetaInline u-noWrapWithEllipsis u-xs-normalWrap u-xs-lineClamp2">I program operating systems by day, and Natural Language models by night.</div><div class="postMetaInline js-testPostMetaInlineSupplemental"><time datetime="2016-05-30T17:25:29.213Z">May 30, 2016</time><span class="middotDivider u-fontSize12"></span><span class="readingTime" title="9 min read"></span></div></div></div></div></div></header><div class="postArticle-content js-postField js-notesSource js-trackedPost" data-post-id="e25648c31800" data-source="post_page" data-tracking-context="postPage" data-scroll="native"><section name="57d8" class="section section--body section--first"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h1 name="aea6" id="aea6" class="graf graf--h3 graf--leading graf--title">Porting a model to TensorFlow</h1></div><div class="section-inner sectionLayout--fullWidth"><figure name="f4ff" id="f4ff" class="graf graf--figure graf--layoutFillWidth graf-after--h3" data-scroll="native"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 48%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded is-imageLoaded" data-image-id="1*5JiPSy-VWASl7L9kflq4ag.png" data-width="2500" data-height="1200" data-scroll="native"><img src="./Theano vs Tensorflow – Richard Townsend – Medium_files/1-5JiPSy-VWASl7L9kflq4ag.png" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="35"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/2000/1*5JiPSy-VWASl7L9kflq4ag.png" src="./Theano vs Tensorflow – Richard Townsend – Medium_files/1-5JiPSy-VWASl7L9kflq4ag(1).png"><noscript class="js-progressiveMedia-inner">&lt;img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/2000/1*5JiPSy-VWASl7L9kflq4ag.png"&gt;</noscript></div></div></figure></div><div class="section-inner sectionLayout--insetColumn"><p name="5647" id="5647" class="graf graf--p graf-after--figure">TensorFlow is a recent addition to a <a href="http://deeplearning.net/software_links/" data-href="http://deeplearning.net/software_links/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">constellation of frameworks </a>designed to accelerate the process of building deep models. Of these, I’ve only previously had time to learn Theano — one of the more venerable frameworks in this fairly young field. Just like TensorFlow, Theano uses Python as a meta-programming language to describe a model symbolically — add these two tensors together; take the average of this over that axis — and then differentiate it to ensure that parameter optimisation is tractable and efficient. Unlike TensorFlow however, Theano requires end-users to re-implement lots of the standard components that often crop up in models — especially optimisers, cost calculations and things like dropout (often used in combination with softmax). Both libraries also allow a mix of GPU and CPU code generation. But aside from style, which framework helps you get results fast? Which is easier to program? Which produces models which train quickly? TensorFlow offers a nice API, lots of built in functionality and <a href="https://www.tensorflow.org/versions/r0.8/how_tos/using_gpu/index.html" data-href="https://www.tensorflow.org/versions/r0.8/how_tos/using_gpu/index.html" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">a robust device model and integrated cluster awareness</a>, whereas Theano offers <a href="http://deeplearning.net/software/theano/extending/optimization.html" data-href="http://deeplearning.net/software/theano/extending/optimization.html" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">more aggressive compute graph optimisation</a> and <a href="http://deeplearning.net/software/theano/library/config.html" data-href="http://deeplearning.net/software/theano/library/config.html" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">lots of tuneable parameters</a>. So which on balance provides the best blend of performance and productivity?</p><h3 name="9b19" id="9b19" class="graf graf--h3 graf-after--p">Introducing Dracula</h3><p name="1060" id="1060" class="graf graf--p graf-after--h3">To find out, I decided to port a reasonably simple natural language model — <a href="http://dracula.sentimentron.co.uk/" data-href="http://dracula.sentimentron.co.uk" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">called Dracula </a>— from Theano to TensorFlow. Dracula is an LSTM-based sequence tagger (the initial application is part-of-speech tagging) that operates at the level of individual characters, making its models small and reducing the need for preprocessing operations like thresholding rare words, building dictionaries of proper nouns, filtering emoticons and other pre-processing that’s unlikely to help performance outside the validation environment, meaning it’s good for less-structured environments like Twitter.</p><figure name="3bfe" id="3bfe" class="graf graf--figure graf-after--p"><div class="aspectRatioPlaceholder is-locked" style="max-width: 700px; max-height: 367px;"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 52.400000000000006%;"></div><div class="progressiveMedia js-progressiveMedia graf-image is-canvasLoaded" data-image-id="1*ASLWyfro_yRaAQWAccQ31g.png" data-width="2500" data-height="1310" data-action="zoom" data-action-value="1*ASLWyfro_yRaAQWAccQ31g.png" data-scroll="native"><img src="./Theano vs Tensorflow – Richard Townsend – Medium_files/1-ASLWyfro_yRaAQWAccQ31g.png" crossorigin="anonymous" class="progressiveMedia-thumbnail js-progressiveMedia-thumbnail"><canvas class="progressiveMedia-canvas js-progressiveMedia-canvas" width="75" height="38"></canvas><img class="progressiveMedia-image js-progressiveMedia-image" data-src="https://cdn-images-1.medium.com/max/1600/1*ASLWyfro_yRaAQWAccQ31g.png"><noscript class="js-progressiveMedia-inner">&lt;img class="progressiveMedia-noscript js-progressiveMedia-inner" src="https://cdn-images-1.medium.com/max/1600/1*ASLWyfro_yRaAQWAccQ31g.png"&gt;</noscript></div></div></figure><p name="f8cd" id="f8cd" class="graf graf--p graf-after--figure">Dracula has a couple of main steps:</p><ol class="postList"><li name="33e6" id="33e6" class="graf graf--li graf-after--p">Generating character embeddings inputs;</li><li name="728c" id="728c" class="graf graf--li graf-after--li">Applying zero or more LSTM layers per word, at the character level;</li><li name="cb98" id="cb98" class="graf graf--li graf-after--li">Mean-pooling the character-level representations into character-level representations;</li><li name="c0e8" id="c0e8" class="graf graf--li graf-after--li">Applying zero or more LSTM layers per sentence, at the word-level;</li><li name="d97a" id="d97a" class="graf graf--li graf-after--li">Applying softmax to generate the final per-word labels.</li></ol><p name="3026" id="3026" class="graf graf--p graf-after--li graf--trailing">This makes it just tractable enough for a reasonably short port, but just complicated enough to hit some unusual TensorFlow API corners.</p></div></div></section><section name="485e" class="section section--body section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="6719" id="6719" class="graf graf--h3 graf--leading">Going out of the&nbsp;box</h3><p name="9dd7" id="9dd7" class="graf graf--p graf-after--h3">Theano needs a fairly standard set of tools and is easily installed via pip. TensorFlow is just as straightforward: just follow the instructions. However, when I first evaluated TensorFlow several months ago, I quickly found out that they’d <a href="https://github.com/tensorflow/tensorflow/issues/20" data-href="https://github.com/tensorflow/tensorflow/issues/20" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">hard-coded a dependency on the CUDA 7.0 SDK into their build files</a>, making it very difficult to run on system using a later version of CUDA. In the last few weeks, the TensorFlow team have released version 0.8, which corrects that problem. It also now supports Python 3 — which I’m gradually switching to — but for the rest of this post I’m using 2.7.</p><p name="daa4" id="daa4" class="graf graf--p graf-after--p">Once installed, I tested it out using an example script from Google, reproduced below:</p><figure name="1401" id="1401" class="graf graf--figure graf--iframe graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 103.571%;"></div><div class="iframeContainer"><iframe width="700" height="250" src="./Theano vs Tensorflow – Richard Townsend – Medium_files/07ad30bdb50d3cb6c4affab5213cf261.html" data-media-id="07ad30bdb50d3cb6c4affab5213cf261" allowfullscreen="" frameborder="0"></iframe></div></div></figure><p name="5074" id="5074" class="graf graf--p graf-after--figure">Here’s a rough equivalent in Theano:</p><figure name="9242" id="9242" class="graf graf--figure graf--iframe graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 87.857%;"></div><div class="iframeContainer"><iframe width="700" height="250" src="./Theano vs Tensorflow – Richard Townsend – Medium_files/ec7425d32ba1efdb7a6894d9e97f9959.html" data-media-id="ec7425d32ba1efdb7a6894d9e97f9959" allowfullscreen="" frameborder="0"></iframe></div></div></figure><p name="a915" id="a915" class="graf graf--p graf-after--figure">These two little scripts actually encapsulate a great deal of the difference between the two frameworks. Each starts off with two identically-generated numpy arrays describing the input, and the target output (it’s mathematically <em class="markup--em markup--p-em">z = 0.1 * x + 0.2 * y</em>). Next, comes model initialisation:</p><figure name="1b88" id="1b88" class="graf graf--figure graf--iframe graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 40.714%;"></div><div class="iframeContainer"><iframe width="700" height="250" src="./Theano vs Tensorflow – Richard Townsend – Medium_files/2b8b8c3916cbe0e06c8b332bf0ae113a.html" data-media-id="2b8b8c3916cbe0e06c8b332bf0ae113a" allowfullscreen="" frameborder="0"></iframe></div></div></figure><p name="d01f" id="d01f" class="graf graf--p graf-after--figure">Note that TensorFlow doesn’t require any special treatment of the <em class="markup--em markup--p-em">x </em>and <em class="markup--em markup--p-em">y</em> variables: they just exist in their native forms. Theano meanwhile requires some additional plumbing to say that the variables are symbolic inputs to the function. The syntax defining what the <em class="markup--em markup--p-em">b</em> and <em class="markup--em markup--p-em">W</em> variables look like is also, in my opinion, a little nicer.</p><figure name="043b" id="043b" class="graf graf--figure graf--iframe graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 40.714%;"></div><div class="iframeContainer"><iframe width="700" height="250" src="./Theano vs Tensorflow – Richard Townsend – Medium_files/83f5f593fa30aacf2736918d7bb2097f.html" data-media-id="83f5f593fa30aacf2736918d7bb2097f" allowfullscreen="" frameborder="0"></iframe></div></div></figure><p name="5fdd" id="5fdd" class="graf graf--p graf-after--figure">Next up is the way of actually learning: gradient descent.</p><ol class="postList"><li name="8548" id="8548" class="graf graf--li graf-after--p">These lines are all about specifying what we’re minimising, in this case mean squared error. The syntax is similar.</li><li name="a51a" id="a51a" class="graf graf--li graf-after--li">Lines marked (2) are about setting up the code to compute the gradients with respect to each of the variables we’re learning, and changing the weights in response to a new gradient. TensorFlow gives access to lots of good optimisers out of the box (including gradient descent and Adadelta). Theano makes me do all the hard work. This is both a good and bad thing: it offers ultimate control, but also affects code comprehension and increases verification effort.</li><li name="e91f" id="e91f" class="graf graf--li graf-after--li">Finally, we form a training function that zips together everything previously so we can update it.</li></ol><p name="d716" id="d716" class="graf graf--p graf-after--li">Finally, we get to the body of the training itself:</p><figure name="17f9" id="17f9" class="graf graf--figure graf--iframe graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 43.857%;"></div><div class="iframeContainer"><iframe width="700" height="250" src="./Theano vs Tensorflow – Richard Townsend – Medium_files/0857cfb3082a3aa0b99ec03077cf125e.html" data-media-id="0857cfb3082a3aa0b99ec03077cf125e" allowfullscreen="" frameborder="0"></iframe></div></div></figure><p name="cad5" id="cad5" class="graf graf--p graf-after--figure">Again, the function of these fragments is essentially identical: but TensorFlow’s philosophy of encapsulating the graph execution in the <em class="markup--em markup--p-em">Session</em> object does feel conceptually cleaner than Theano’s.</p><h3 name="10dc" id="10dc" class="graf graf--h3 graf-after--p">Porting the embeddings matrix</h3><p name="f5d8" id="f5d8" class="graf graf--p graf-after--h3">Step 1 of Dracula is to take two arrays per batch as input: one represents the character indices for each tweet, and the other describes how the characters are laid out into words that we want to classify. <a href="https://github.com/Sentimentron/Dracula/blob/2016-04-16/nn_layers.py#L10" data-href="https://github.com/Sentimentron/Dracula/blob/2016-04-16/nn_layers.py#L10" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">Here’s what the embeddings matrix code looks in Theano:</a></p><figure name="e8b4" id="e8b4" class="graf graf--figure graf--iframe graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 12.429%;"></div><div class="iframeContainer"><iframe width="700" height="250" src="./Theano vs Tensorflow – Richard Townsend – Medium_files/4d5c0661fb86a49aa5f0fd989d50e4a3.html" data-media-id="4d5c0661fb86a49aa5f0fd989d50e4a3" allowfullscreen="" frameborder="0"></iframe></div></div></figure><p name="658f" id="658f" class="graf graf--p graf-after--figure">And here’s how it looks in TensorFlow:</p><figure name="e8fd" id="e8fd" class="graf graf--figure graf--iframe graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 12.429%;"></div><div class="iframeContainer"><iframe width="700" height="250" src="./Theano vs Tensorflow – Richard Townsend – Medium_files/ce40358d9b594970bcc87947d85c3953.html" data-media-id="ce40358d9b594970bcc87947d85c3953" allowfullscreen="" frameborder="0"></iframe></div></div></figure><p name="0cbe" id="0cbe" class="graf graf--p graf-after--figure">TensorFlow doesn’t have a <em class="markup--em markup--p-em">flatten</em> operation like Theano does (for those looking — <a href="http://tensorflow.org/api_docs/python/array_ops.html#reshape" data-href="http://tensorflow.org/api_docs/python/array_ops.html#reshape" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">pass -1 into the <em class="markup--em markup--p-em">reshape</em> function’s shape parameter</a>), but actually that turned out not to be necessary: <a href="https://www.tensorflow.org/versions/r0.8/api_docs/python/array_ops.html#gather" data-href="https://www.tensorflow.org/versions/r0.8/api_docs/python/array_ops.html#gather" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank"><em class="markup--em markup--p-em">gather</em></a> does the equivalent operation by slicing up the embeddings matrix <em class="markup--em markup--p-em">Wemb</em> into slices defined by the matrix of indices <em class="markup--em markup--p-em">x. </em>Whilst TensorFlow’s written documentation is generally excellent — if a bit confusing — it’s online documentation is especially excellent: whilst I was groping around for <em class="markup--em markup--p-em">gather,</em> TensorFlow gave me really excellent error messages to help me figure out what was going on. <a href="https://www.tensorflow.org/versions/r0.8/api_docs/python/nn.html#embedding_lookup" data-href="https://www.tensorflow.org/versions/r0.8/api_docs/python/nn.html#embedding_lookup" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">Since I first ported some of the code, 0.8 introduces a new function which improves handling of very large embeddings matrices distributed across multiple machines.</a></p><h3 name="b60e" id="b60e" class="graf graf--h3 graf-after--p">Aside: testing TensorFlow</h3><p name="f1ab" id="f1ab" class="graf graf--p graf-after--h3">As I port each layer of Dracula over to TensorFlow, I’m adding and revising tests as I go along. I use Python’s <em class="markup--em markup--p-em">unittest</em> module because it’s convenient and built-in, but it’s more interesting to discuss how TensorFlow fits in. Here’s the test for the above:</p><figure name="77d5" id="77d5" class="graf graf--figure graf--iframe graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 94.143%;"></div><div class="iframeContainer"><iframe width="700" height="250" src="./Theano vs Tensorflow – Richard Townsend – Medium_files/9dce1b19c77c46418f5e689130addd53.html" data-media-id="9dce1b19c77c46418f5e689130addd53" allowfullscreen="" frameborder="0"></iframe></div></div></figure><p name="9fe3" id="9fe3" class="graf graf--p graf-after--figure">Straightforward stuff, set up some numpy arrays, declare the embeddings matrix as a tf.Variable (since in the model it’s learned) and declare the input index array as a constant for evaluation. We then run through the session boilerplate, execute the <em class="markup--em markup--p-em">embeddings_layer</em> function to get a Tensor, and then use <em class="markup--em markup--p-em">eval</em> to turn it into a numpy array for assertion.</p><h3 name="a999" id="a999" class="graf graf--h3 graf-after--p">Per-word averaging / max&nbsp;pooling</h3><p name="b10b" id="b10b" class="graf graf--p graf-after--h3">Per-word averaging is a convolution operation that takes the embeddings or letter-level LSTM output for each character, and turns it into a discrete word embedding that can then be fed to higher recurrent layers. Getting this bit right was the hardest part of creating the first version of the model and underwent several revisions to improve performance. The final version uses a <em class="markup--em markup--p-em">(max word index, max char index, batch size, embedding size)-</em>sized<em class="markup--em markup--p-em"> </em>tensor from the embeddings layer and then averages out the second dimension, leaving a 3D <em class="markup--em markup--p-em">(max word index, batch size, embedding size) </em>tensor. The mask is used to communicate to the algorithm which bits of the input are defined (i.e. covered by actual letters in the input), so the input is masked off via element-wise multiplication and then summed to produce the divider. The divider is normalised so that it contains no zeros (if a zero’s on the bottom, then there should be a zero on top too). The per-dimension total is then element-wise divided by this result. Theano’s code is relatively straightforward:</p><figure name="0edb" id="0edb" class="graf graf--figure graf--iframe graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 34.429%;"></div><div class="iframeContainer"><iframe width="700" height="250" src="./Theano vs Tensorflow – Richard Townsend – Medium_files/6f111a544f3d50fba8029e9e3b06d063.html" data-media-id="6f111a544f3d50fba8029e9e3b06d063" allowfullscreen="" frameborder="0"></iframe></div></div></figure><p name="7972" id="7972" class="graf graf--p graf-after--figure">The <em class="markup--em markup--p-em">dimshuffle</em> calls aren’t actually unnecessary, and I picked this up during the port (they’ll be removed in a future version). Note than in Theano, operations like <em class="markup--em markup--p-em">sum</em> are often attached to the tensors themselves, indicating that the result is derived from the previous step in the computational graph. Operations which bring multiple parts of the compute graph together (like <em class="markup--em markup--p-em">eq</em>) are still defined within Theano’s main namespace. Tensorflow’s version looks very similar, but moves everything into the main namespace.</p><figure name="30b3" id="30b3" class="graf graf--figure graf--iframe graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 53.286%;"></div><div class="iframeContainer"><iframe width="700" height="250" src="./Theano vs Tensorflow – Richard Townsend – Medium_files/7c27cfaec6e676a166cee6d01ac9ec42.html" data-media-id="7c27cfaec6e676a166cee6d01ac9ec42" allowfullscreen="" frameborder="0"></iframe></div></div></figure><h3 name="ef67" id="ef67" class="graf graf--h3 graf-after--figure">Softmax and&nbsp;dropout</h3><p name="a5b9" id="a5b9" class="graf graf--p graf-after--h3">The softmax layer is used to produce a probability distribution across the possible labels. Both frameworks assume that the input to softmax is 2D, so we have to use the frameworks’ iteration constructs to scan across each 2D slice of the 3D output of Dracula. Both final softmax layers use dropout during training to try to fight overfitting.</p><figure name="4991" id="4991" class="graf graf--figure graf--iframe graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 94.143%;"></div><div class="iframeContainer"><iframe width="700" height="250" src="./Theano vs Tensorflow – Richard Townsend – Medium_files/9c73c9cb5bf35ac5230daf25c96d5805.html" data-media-id="9c73c9cb5bf35ac5230daf25c96d5805" allowfullscreen="" frameborder="0"></iframe></div></div></figure><p name="3442" id="3442" class="graf graf--p graf-after--figure">Again, there’s an issue with undefined input, which should always be given a particular label. The way this is accomplished by Dracula in Theano is to create a default tensor with the probability distribution of the undefined label, and then setting the defined areas to the output of <a href="http://deeplearning.net/software/theano/library/tensor/nnet/nnet.html#tensor.nnet.softmax" data-href="http://deeplearning.net/software/theano/library/tensor/nnet/nnet.html#tensor.nnet.softmax" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">softmax</a>. Theano’s <a href="http://deeplearning.net/software/theano/library/scan.html" data-href="http://deeplearning.net/software/theano/library/scan.html" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">scan</a> function is used to convert the <em class="markup--em markup--p-em">(max word index, batch size, embedding size)</em> input into a <em class="markup--em markup--p-em">(batch size, embedding size)</em> slice.</p><p name="5703" id="5703" class="graf graf--p graf-after--p">Tensorflow’s implementation is a little more complicated because I opted to use the same implementation to produce both the probability distributions and the raw activations for computing the cost. This is needed because of the cost function I chose, <a href="https://www.tensorflow.org/versions/r0.8/api_docs/python/nn.html#sparse_softmax_cross_entropy_with_logits" data-href="https://www.tensorflow.org/versions/r0.8/api_docs/python/nn.html#sparse_softmax_cross_entropy_with_logits" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">which for some inexplicable reason does softmax internally (“for efficiency”)</a>.</p><figure name="1f60" id="1f60" class="graf graf--figure graf--iframe graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 75.286%;"></div><div class="iframeContainer"><iframe width="700" height="250" src="./Theano vs Tensorflow – Richard Townsend – Medium_files/1def06292e997e5e672964abba9d524a.html" data-media-id="1def06292e997e5e672964abba9d524a" allowfullscreen="" frameborder="0"></iframe></div></div></figure><p name="90c9" id="90c9" class="graf graf--p graf-after--figure">Overall it’s very straightforward: TensorFlow has a built in drop-out function, and <em class="markup--em markup--p-em">map_fn</em> takes care of creating the 2D slices. Because TensorFlow’s indexing capability is limited, it’s not possible to mask undefined regions of the input in TensorFlow like in Theano: but it’s possible to work around it in this case by using the correct cost function.</p><h3 name="9a78" id="9a78" class="graf graf--h3 graf-after--p">Gluing it together with LSTM&nbsp;layers</h3><p name="d2fc" id="d2fc" class="graf graf--p graf-after--h3">Dracula supports a variable number of LSTM layers at both the word and character levels to perform sequence tagging. This — more than anywhere else — is where the port differs from Theano. The Theano implementation applies the modifed form of the LSTM presented in the sentiment analysis demo multiple times, and supports both 2D and 3D versions (thanks to broadcasting). The forward and backward iterations are summed to produce the final output.</p><figure name="6f96" id="6f96" class="graf graf--figure graf--iframe graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 216.714%;"></div><div class="iframeContainer"><iframe width="700" height="250" src="./Theano vs Tensorflow – Richard Townsend – Medium_files/cf7760d7739c9675430bedab56059a46.html" data-media-id="cf7760d7739c9675430bedab56059a46" allowfullscreen="" frameborder="0"></iframe></div></div></figure><p name="2951" id="2951" class="graf graf--p graf-after--figure">The TensorFlow version has only one single activation weight and bias, and the multiple layers are natively supported within the framework. TensorFlow requires two 2D scans (both per-word and per-letter) to compute the output.</p><figure name="ce28" id="ce28" class="graf graf--figure graf--iframe graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 91%;"></div><div class="iframeContainer"><iframe width="700" height="250" src="./Theano vs Tensorflow – Richard Townsend – Medium_files/5424e562e2d2d92c8f6acdcf5d7f405c.html" data-media-id="5424e562e2d2d92c8f6acdcf5d7f405c" allowfullscreen="" frameborder="0"></iframe></div></div></figure><h3 name="1485" id="1485" class="graf graf--h3 graf-after--figure">Cost function</h3><p name="26ab" id="26ab" class="graf graf--p graf-after--h3">This was surprisingly one of the more difficult pieces to port. In Theano, the cost is computed with via mean squared-error based on the negative log probabilities, and looks like this:</p><figure name="ef0a" id="ef0a" class="graf graf--figure graf--iframe graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 18.714%;"></div><div class="iframeContainer"><iframe width="700" height="250" src="./Theano vs Tensorflow – Richard Townsend – Medium_files/f830951933887b88cc6345561ccb1414.html" data-media-id="f830951933887b88cc6345561ccb1414" allowfullscreen="" frameborder="0"></iframe></div></div></figure><p name="bced" id="bced" class="graf graf--p graf-after--figure"><a href="https://www.tensorflow.org/versions/r0.8/api_docs/python/nn.html#sparse_softmax_cross_entropy_with_logits" data-href="https://www.tensorflow.org/versions/r0.8/api_docs/python/nn.html#sparse_softmax_cross_entropy_with_logits" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">TensorFlow’s got a function which does much the same thing</a>, and (guess what!) it only operates on 2D tensors. So to port this code, it’s necessary to iterate in much the same way, with the caveat that indexing via lists, TensorFlow Variable objects and other symbolic tensors is not supported. As a result, it’s not possible do a <a href="https://www.tensorflow.org/versions/r0.8/api_docs/python/functional_ops.html#map_fn" data-href="https://www.tensorflow.org/versions/r0.8/api_docs/python/functional_ops.html#map_fn" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank"><em class="markup--em markup--p-em">map_fn</em></a> on a <a href="https://www.tensorflow.org/versions/r0.8/api_docs/python/constant_op.html#range" data-href="https://www.tensorflow.org/versions/r0.8/api_docs/python/constant_op.html#range" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">tf.range</a> and access the labels and computed probabilities within the scanning function like in Theano, <a href="http://stackoverflow.com/questions/37086098/does-tensorflow-map-fn-support-taking-more-than-one-tensor" data-href="http://stackoverflow.com/questions/37086098/does-tensorflow-map-fn-support-taking-more-than-one-tensor" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">and it’s not possible to pass more than one tensor in either.</a></p><p name="fc76" id="fc76" class="graf graf--p graf-after--p">The solution was to combine the tensors representing the reference labels (<em class="markup--em markup--p-em">y</em>) and the unscaled activations (<em class="markup--em markup--p-em">pred_logits</em>) are combined and then unpacked within the map routine. This is a little gross, but it works.</p><figure name="66b0" id="66b0" class="graf graf--figure graf--iframe graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 56.429%;"></div><div class="iframeContainer"><iframe width="700" height="250" src="./Theano vs Tensorflow – Richard Townsend – Medium_files/979ad6cc80d8c6c1d911df598004276b.html" data-media-id="979ad6cc80d8c6c1d911df598004276b" allowfullscreen="" frameborder="0"></iframe></div></div></figure><h3 name="b57e" id="b57e" class="graf graf--h3 graf-after--figure">Supporting code and infrastructure</h3><p name="7a45" id="7a45" class="graf graf--p graf-after--h3">Instead of needing numpy to save Theano’s parameters, TensorFlow has the capability to save tensor values built-in, so that’s great. The only catch is that all variables must be specified in advance (otherwise TensorFlow will complain when model parameters are reloaded), meaning that hyper-parameter optimisations where layers are added or removed have to be considered in advance.</p><figure name="a836" id="a836" class="graf graf--figure graf--iframe graf-after--p"><div class="aspectRatioPlaceholder is-locked"><div class="aspectRatioPlaceholder-fill" style="padding-bottom: 43.857%;"></div><div class="iframeContainer"><iframe width="700" height="250" src="./Theano vs Tensorflow – Richard Townsend – Medium_files/4eb099a0937b449d767ed538156ab907.html" data-media-id="4eb099a0937b449d767ed538156ab907" allowfullscreen="" frameborder="0"></iframe></div></div></figure><p name="0083" id="0083" class="graf graf--p graf-after--figure">Saving the state of the graph is as easy as creating a <a href="https://www.tensorflow.org/versions/r0.8/api_docs/python/state_ops.html#Saver" data-href="https://www.tensorflow.org/versions/r0.8/api_docs/python/state_ops.html#Saver" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">tf.train.Saver object</a> with some tf.Variables, including it in the session and then calling it’s save method. The Saver object also supports incremental checkpointing, making it a good fit for environments where training can stop and start (like Amazon EC2 Spot Instances).</p><h3 name="3fea" id="3fea" class="graf graf--h3 graf-after--p">Performance</h3><p name="70e2" id="70e2" class="graf graf--p graf-after--h3"><a href="https://www.reddit.com/r/MachineLearning/comments/3shflv/tensorflows_poor_performance_means_they_dont_use/" data-href="https://www.reddit.com/r/MachineLearning/comments/3shflv/tensorflows_poor_performance_means_they_dont_use/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">TensorFlow has acquired a reputation for being sluggish</a>, and that certainly bears out in my testing. For the initial pre-training stage (with no LSTM layers, just embeddings, averaging and softmax), TensorFlow takes 163 seconds per epoch to train on my single NVidia GTX 980 consumer-class GPU. With letter layer LSTMs, it takes 5503 seconds per epoch. In Theano, the first stage takes 95 seconds per epoch and the second requires 1709, despite doing more work in the LSTM layers. Whilst there is likely some optimisation work to do, a significant amount of this difference is probably down to Theano’s more aggressive compilation and optimisation strategy, which can result in long startup times for the model. Without optimisation enabled, the model starts up as quickly under Theano as it does under TensorFlow. <a href="https://github.com/soumith/convnet-benchmarks" data-href="https://github.com/soumith/convnet-benchmarks" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">The good news is that TensorFlow’s performance is improving, and for certain workloads it’s quite competitive with other specialized frameworks.</a> But for single-machine workloads, it’s quite hard to recommend it at this stage.</p><h3 name="0c26" id="0c26" class="graf graf--h3 graf-after--p">Conclusion</h3><p name="5b90" id="5b90" class="graf graf--p graf-after--h3 graf--trailing">The big unknown is whether Theano can turn into TensorFlow (e.g. <a href="http://deeplearning.net/software/theano/tutorial/using_multi_gpu.html" data-href="http://deeplearning.net/software/theano/tutorial/using_multi_gpu.html" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">by adding multi-GPU support</a>) faster than TensorFlow can turn into Theano. I wouldn’t count on it: <a href="https://cloud.google.com/ml/" data-href="https://cloud.google.com/ml/" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">with a fully managed cloud platform already available</a>, <a href="http://googleresearch.blogspot.co.uk/2016/04/deepmind-moves-to-tensorflow.html" data-href="http://googleresearch.blogspot.co.uk/2016/04/deepmind-moves-to-tensorflow.html" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">its growing adoption inside Google</a>, <a href="https://cloudplatform.googleblog.com/2016/05/Google-supercharges-machine-learning-tasks-with-custom-chip.html" data-href="https://cloudplatform.googleblog.com/2016/05/Google-supercharges-machine-learning-tasks-with-custom-chip.html" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">custom hardware</a>, Google’s significant developer resources and mind-share, and the promise to bring the core engine to other platforms, there’s no chance of TensorFlow going anywhere in the near future. Right now, assuming the compute time involved in training is cheap, there may be small productivity improvements under TensorFlow — it has built-in optimizers, more built in neural network capabilities, and tightly integrated check-pointing — but its performance and its potential just hasn’t arrived yet. <a href="https://github.com/Sentimentron/Dracula/tree/tensorflow3" data-href="https://github.com/Sentimentron/Dracula/tree/tensorflow3" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">Whilst I’m not officially releasing or supporting the code behind this article</a> (which definitely bears the scars of battle), I’m going to keep it around and update it for TensorFlow 0.9 (hopefully due soon).</p></div></div></section></div><footer class="u-paddingTop10"><div class="container u-maxWidth740"><div class="row"><div class="col u-size12of12"></div></div><div class="row"><div class="col u-size12of12 js-postTags"><div class="u-paddingBottom10"><ul class="tags tags--postTags tags--borderless"><li><a class="link u-baseColor--link" href="https://medium.com/tag/deep-learning?source=post" data-action-source="post">Deep Learning</a></li><li><a class="link u-baseColor--link" href="https://medium.com/tag/machine-learning?source=post" data-action-source="post">Machine Learning</a></li><li><a class="link u-baseColor--link" href="https://medium.com/tag/tensorflow?source=post" data-action-source="post">TensorFlow</a></li></ul></div></div></div><div class="row js-postActionsFooter"><div class="postActions col u-size12of12"><div class="u-floatLeft buttonSet buttonSet--withLabels"><div class="buttonSet-inner"><div class="js-actionRecommend" data-post-id="e25648c31800" data-is-icon-29px="true" data-has-recommend-list="true" data-source="post_actions_footer"><button class="button button--primary button--large button--chromeless is-touchIconFadeInPulse u-accentColor--buttonNormal button--withIcon button--withSvgIcon u-accentColor--iconLight js-actionRecommendButton" title="Recommend to share this article with your followers and let the author know you liked it" aria-label="Recommend to share this article with your followers and let the author know you liked it" data-action="sign-in-prompt" data-sign-in-action="upvote" data-requires-token="true" data-redirect="https://medium.com/_/vote/p/e25648c31800" data-action-source="post_actions_footer"><span class="button-defaultState"><span class="svgIcon svgIcon--heart svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M16.215 23.716c-.348.288-.984.826-1.376 1.158a.526.526 0 0 1-.68 0c-.36-.307-.92-.78-1.22-1.03C9.22 20.734 3 15.527 3 10.734 3 7.02 5.916 4 9.5 4c1.948 0 3.77.898 5 2.434C15.73 4.898 17.552 4 19.5 4c3.584 0 6.5 3.02 6.5 6.734 0 4.9-6.125 9.96-9.785 12.982zM19.5 5.2c-1.774 0-3.423.923-4.41 2.468a.699.699 0 0 1-.59.323.706.706 0 0 1-.59-.32c-.988-1.54-2.637-2.47-4.41-2.47-2.922 0-5.3 2.49-5.3 5.54 0 4.23 6.19 9.41 9.517 12.19.217.18.566.48.783.66l.952-.79c3.496-2.88 9.348-7.72 9.348-12.05 0-3.05-2.378-5.53-5.3-5.53z"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--heartFilled svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M19.5 4c-1.948 0-3.77.898-5 2.434C13.27 4.898 11.448 4 9.5 4 5.916 4 3 7.02 3 10.734c0 4.793 6.227 10 9.95 13.11.296.25.853.723 1.212 1.03.196.166.48.166.677 0 .39-.332 1.02-.87 1.37-1.158 3.66-3.022 9.79-8.08 9.79-12.982C26 7.02 23.08 4 19.5 4z" fill-rule="evenodd"></path></svg></span></span></button><button class="button button--chromeless u-baseColor--buttonNormal" data-action="show-recommends" data-action-value="e25648c31800">25</button></div></div><div class="buttonSet-inner"><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon" data-action="scroll-to-responses" data-action-source="post_actions_footer"><span class="svgIcon svgIcon--response svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M21.27 20.058c1.89-1.826 2.754-4.17 2.754-6.674C24.024 8.21 19.67 4 14.1 4 8.53 4 4 8.21 4 13.384c0 5.175 4.53 9.385 10.1 9.385 1.007 0 2-.14 2.95-.41.285.25.592.49.918.7 1.306.87 2.716 1.31 4.19 1.31.276-.01.494-.14.6-.36a.625.625 0 0 0-.052-.65c-.61-.84-1.042-1.71-1.282-2.58a5.417 5.417 0 0 1-.154-.75zm-3.85 1.324l-.083-.28-.388.12a9.72 9.72 0 0 1-2.85.424c-4.96 0-8.99-3.706-8.99-8.262 0-4.556 4.03-8.263 8.99-8.263 4.95 0 8.77 3.71 8.77 8.27 0 2.25-.75 4.35-2.5 5.92l-.24.21v.32c0 .07 0 .19.02.37.03.29.1.6.19.92.19.7.49 1.4.89 2.08-.93-.14-1.83-.49-2.67-1.06-.34-.22-.88-.48-1.16-.74z"></path></svg></span></button><button class="button button--chromeless u-baseColor--buttonNormal" data-action="scroll-to-responses">1</button></div></div><div class="u-floatRight buttonSet buttonSet--narrow"><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon" title="Share on Twitter" aria-label="Share on Twitter" data-action="share-on-twitter" data-action-source="post_actions_footer"><span class="svgIcon svgIcon--twitter svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M21.967 11.8c.018 5.93-4.607 11.18-11.177 11.18-2.172 0-4.25-.62-6.047-1.76l-.268.422-.038.5.186.013.168.012c.3.02.44.032.6.046 2.06-.026 3.95-.686 5.49-1.86l1.12-.85-1.4-.048c-1.57-.055-2.92-1.08-3.36-2.51l-.48.146-.05.5c.22.03.48.05.75.08.48-.02.87-.07 1.25-.15l2.33-.49-2.32-.49c-1.68-.35-2.91-1.83-2.91-3.55 0-.05 0-.01-.01.03l-.49-.1-.25.44c.63.36 1.35.57 2.07.58l1.7.04L7.4 13c-.978-.662-1.59-1.79-1.618-3.047a4.08 4.08 0 0 1 .524-1.8l-.825.07a12.188 12.188 0 0 0 8.81 4.515l.59.033-.06-.59v-.02c-.05-.43-.06-.63-.06-.87a3.617 3.617 0 0 1 6.27-2.45l.2.21.28-.06c1.01-.22 1.94-.59 2.73-1.09l-.75-.56c-.1.36-.04.89.12 1.36.23.68.58 1.13 1.17.85l-.21-.45-.42-.27c-.52.8-1.17 1.48-1.92 2L22 11l.016.28c.013.2.014.35 0 .52v.04zm.998.038c.018-.22.017-.417 0-.66l-.498.034.284.41a8.183 8.183 0 0 0 2.2-2.267l.97-1.48-1.6.755c.17-.08.3-.02.34.03a.914.914 0 0 1-.13-.292c-.1-.297-.13-.64-.1-.766l.36-1.254-1.1.695c-.69.438-1.51.764-2.41.963l.48.15a4.574 4.574 0 0 0-3.38-1.484 4.616 4.616 0 0 0-4.61 4.613c0 .29.02.51.08.984l.01.02.5-.06.03-.5c-3.17-.18-6.1-1.7-8.08-4.15l-.48-.56-.36.64c-.39.69-.62 1.48-.65 2.28.04 1.61.81 3.04 2.06 3.88l.3-.92c-.55-.02-1.11-.17-1.6-.45l-.59-.34-.14.67c-.02.08-.02.16 0 .24-.01 2.12 1.55 4.01 3.69 4.46l.1-.49-.1-.49c-.33.07-.67.12-1.03.14-.18-.02-.43-.05-.64-.07l-.76-.09.23.73c.57 1.84 2.29 3.14 4.28 3.21l-.28-.89a8.252 8.252 0 0 1-4.85 1.66c-.12-.01-.26-.02-.56-.05l-.17-.01-.18-.01L2.53 21l1.694 1.07a12.233 12.233 0 0 0 6.58 1.917c7.156 0 12.2-5.73 12.18-12.18l-.002.04z"></path></svg></span></button><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon" title="Share on Facebook" aria-label="Share on Facebook" data-action="share-on-facebook" data-action-source="post_actions_footer"><span class="svgIcon svgIcon--facebook svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M16.39 23.61v-5.808h1.846a.55.55 0 0 0 .546-.48l.36-2.797a.551.551 0 0 0-.547-.62H16.39V12.67c0-.67.12-.813.828-.813h1.474a.55.55 0 0 0 .55-.55V8.803a.55.55 0 0 0-.477-.545c-.436-.06-1.36-.116-2.22-.116-2.5 0-4.13 1.62-4.13 4.248v1.513H10.56a.551.551 0 0 0-.55.55v2.797c0 .304.248.55.55.55h1.855v5.76c-4.172-.96-7.215-4.7-7.215-9.1 0-5.17 4.17-9.36 9.31-9.36 5.14 0 9.31 4.19 9.31 9.36 0 4.48-3.155 8.27-7.43 9.15M14.51 4C8.76 4 4.1 8.684 4.1 14.46c0 5.162 3.75 9.523 8.778 10.32a.55.55 0 0 0 .637-.543v-6.985a.551.551 0 0 0-.55-.55H11.11v-1.697h1.855a.55.55 0 0 0 .55-.55v-2.063c0-2.02 1.136-3.148 3.03-3.148.567 0 1.156.027 1.597.06v1.453h-.924c-1.363 0-1.93.675-1.93 1.912v1.78c0 .3.247.55.55.55h2.132l-.218 1.69H15.84c-.305 0-.55.24-.55.55v7.02c0 .33.293.59.623.54 5.135-.7 9.007-5.11 9.007-10.36C24.92 8.68 20.26 4 14.51 4"></path></svg></span></button></div></div></div></div><div class="js-postPromotionWrapper postPromotionWrapper" data-location-id="footer_above_post_attribution"></div><div class="container u-maxWidth740 js-postAttributionFooterContainer u-paddingTop20 u-paddingBottom20 u-marginTop10 u-borderTopLightest u-xs-paddingTop10 u-xs-paddingBottom10"><div class="row js-postFooterInfo"><div class="col u-size12of12"><li class="u-block u-paddingBottom18 js-cardUser"><div class="u-marginLeft20 u-floatRight"><span class="followState js-followState buttonSet-inner" data-user-id="ec21902de320"><button class="button button--small u-noUserSelect button--withChrome u-baseColor--buttonNormal button--withHover button--unblock js-unblockButton" data-action="sign-in-prompt" data-sign-in-action="toggle-block-user" data-requires-token="true" data-action-source="footer_card"><span class="button-label  button-defaultState">Blocked</span><span class="button-label button-hoverState">Unblock</span></button><button class="button button--primary button--small u-noUserSelect button--withChrome u-accentColor--buttonNormal button--follow js-followButton" data-action="sign-in-prompt" data-sign-in-action="toggle-subscribe-user" data-requires-token="true" data-redirect="https://medium.com/_/subscribe/user/ec21902de320" data-action-source="footer_card_follow"><span class="button-label  button-defaultState js-buttonLabel">Follow</span><span class="button-label button-activeState">Following</span></button></span></div><div class="u-tableCell "><a class="link avatar u-baseColor--link" href="https://medium.com/@sentimentron?source=footer_card" title="Go to the profile of Richard Townsend" aria-label="Go to the profile of Richard Townsend" data-action-source="footer_card" data-user-id="ec21902de320" dir="auto"><img src="./Theano vs Tensorflow – Richard Townsend – Medium_files/0-j0J7Tp44phEIV9r3.jpg" class="avatar-image avatar-image--small" alt="Go to the profile of Richard Townsend"></a></div><div class="u-tableCell u-verticalAlignMiddle u-breakWord u-paddingLeft15"><h3 class="u-fontSize18 u-lineHeightTighter u-marginBottom4"><a class="link link--primary u-accentColor--hoverTextNormal" href="https://medium.com/@sentimentron" property="cc:attributionName" title="Go to the profile of Richard Townsend" aria-label="Go to the profile of Richard Townsend" rel="author cc:attributionUrl" data-user-id="ec21902de320" dir="auto">Richard Townsend</a></h3><p class="u-fontSize14 u-lineHeightBaseSans u-textColorDark u-marginBottom4">I program operating systems by day, and Natural Language models by night.</p></div></li></div></div></div><div class="js-postFooterPlacements" data-action-scope="_actionscope_6"><div class="streamItem streamItem--placementCardGrid js-streamItem"><div class="u-clearfix u-backgroundGrayLightest"><div class="row u-marginAuto u-maxWidth1000 u-paddingTop30 u-paddingBottom40"><div class="col u-padding8 u-xs-size12of12 u-size4of12"><div class="u-height280 u-sizeFullWidth u-backgroundWhite u-borderCardBorder u-boxShadow u-borderBox u-borderRadius4 js-trackedPost" data-post-id="b5151dd03f3f" data-source="placement_card_footer_grid---------0-44" data-tracking-context="placement" data-scroll="native"><a class="link link--noUnderline u-baseColor--link" href="https://medium.com/@sentimentron/making-open-data-work-for-open-source-software-b5151dd03f3f?source=placement_card_footer_grid---------0-44" data-action-source="placement_card_footer_grid---------0-44"><div class="u-backgroundCover u-backgroundColorGrayLight u-height100 u-sizeFullWidth u-borderBottomLight u-borderRadiusTop4" style="background-image: url(&quot;https://cdn-images-1.medium.com/fit/c/800/240/0*lMlYRLnd8DCrem9J.png&quot;); background-position: 50% 50% !important;"></div></a><div class="u-padding15 u-borderBox u-flexColumn u-height180"><a class="link link--noUnderline u-flex1 u-baseColor--link" href="https://medium.com/@sentimentron/making-open-data-work-for-open-source-software-b5151dd03f3f?source=placement_card_footer_grid---------0-44" data-action-source="placement_card_footer_grid---------0-44"><div class="postMetaInline u-marginBottom7">More from Richard Townsend</div><div class="u-textColorDarkest u-contentSansBold u-fontSize24 u-maxHeight2LineHeightTighter u-lineClamp2 u-textOverflowEllipsis u-letterSpacingTight u-paddingBottom2">Making Open Data work for Open Source Software</div></a><div class="u-paddingTop10 u-flex0 u-flexCenter"><div class="u-flex1"><div class="u-flexCenter"><div class="postMetaInline-avatar u-flex0"><a class="link avatar u-baseColor--link" href="https://medium.com/@sentimentron" data-action="show-user-card" data-action-value="ec21902de320" data-action-type="hover" data-user-id="ec21902de320" dir="auto"><img src="./Theano vs Tensorflow – Richard Townsend – Medium_files/0-j0J7Tp44phEIV9r3(1).jpg" class="avatar-image u-size36x36 u-xs-size32x32" alt="Go to the profile of Richard Townsend"></a></div><div class="postMetaInline-authorLockup u-flex1 u-noWrapWithEllipsis"><a class="link link link--darken link--darker u-baseColor--link" href="https://medium.com/@sentimentron?source=placement_card_footer_grid---------0-44" data-action="show-user-card" data-action-source="placement_card_footer_grid---------0-44" data-action-value="ec21902de320" data-action-type="hover" data-user-id="ec21902de320" dir="auto">Richard Townsend</a><div class="u-fontSize12 u-baseColor--textNormal u-textColorNormal js-postMetaInlineSupplemental"><span class="readingTime u-textColorNormal" title="3 min read"></span></div></div></div></div><div class="u-flex0 u-flexCenter"><div class="buttonSet"><div class="js-actionRecommend" data-post-id="b5151dd03f3f" data-is-label-padded="true" data-source="placement_card_footer_grid---------0-44"><button class="button button--primary button--chromeless is-touchIconFadeInPulse u-accentColor--buttonNormal button--withIcon button--withSvgIcon u-accentColor--iconLight js-actionRecommendButton" title="Recommend to share this article with your followers and let the author know you liked it" aria-label="Recommend to share this article with your followers and let the author know you liked it" data-action="sign-in-prompt" data-sign-in-action="upvote" data-requires-token="true" data-redirect="https://medium.com/_/vote/p/b5151dd03f3f" data-action-source="placement_card_footer_grid---------0-44"><span class="button-defaultState"><span class="svgIcon svgIcon--heart svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M12.5 21a.492.492 0 0 1-.327-.122c-.278-.24-.61-.517-.978-.826-2.99-2.5-7.995-6.684-7.995-10.565C3.2 6.462 5.578 4 8.5 4c1.55 0 3 .695 4 1.89a5.21 5.21 0 0 1 4-1.89c2.923 0 5.3 2.462 5.3 5.487 0 3.97-4.923 8.035-7.865 10.464-.42.35-.798.66-1.108.93a.503.503 0 0 1-.327.12zM8.428 4.866c-2.414 0-4.378 2.05-4.378 4.568 0 3.475 5.057 7.704 7.774 9.975.243.2.47.39.676.56.245-.21.52-.43.813-.68 2.856-2.36 7.637-6.31 7.637-9.87 0-2.52-1.964-4.57-4.377-4.57-1.466 0-2.828.76-3.644 2.04-.1.14-.26.23-.43.23-.18 0-.34-.09-.43-.24-.82-1.27-2.18-2.03-3.65-2.03z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--heartFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M12.5 21a.492.492 0 0 1-.327-.122c-.278-.24-.61-.517-.978-.826-2.99-2.5-7.995-6.684-7.995-10.565C3.2 6.462 5.578 4 8.5 4c1.55 0 3 .695 4 1.89a5.21 5.21 0 0 1 4-1.89c2.923 0 5.3 2.462 5.3 5.487 0 3.97-4.923 8.035-7.865 10.464-.42.35-.798.66-1.108.93a.503.503 0 0 1-.327.12z" fill-rule="evenodd"></path></svg></span></span></button><button class="button button--chromeless u-baseColor--buttonNormal u-disablePointerEvents u-marginLeft4" data-action="show-recommends" data-action-value="b5151dd03f3f">3</button></div></div><div class="u-height20 u-borderRightLighter u-inlineBlock u-relative u-marginRight10 u-marginLeft12"></div><div class="buttonSet"><button class="button button--chromeless is-touchIconFadeInPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="sign-in-prompt" data-sign-in-action="add-to-bookmarks" data-requires-token="true" data-redirect="https://medium.com/_/bookmark/p/b5151dd03f3f"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V6zm-6.838 9.97L7 19.636V6c0-.55.45-1 1-1h9c.55 0 1 .45 1 1v13.637l-5.162-3.668a.49.49 0 0 0-.676 0z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="26" viewBox="0 0 25 26"><path d="M19 7c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 17.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V7z" fill-rule="evenodd"></path></svg></span></span></button></div></div></div></div></div></div><div class="col u-padding8 u-xs-size12of12 u-size4of12"><div class="u-height280 u-sizeFullWidth u-backgroundWhite u-borderCardBorder u-boxShadow u-borderBox u-borderRadius4 js-trackedPost" data-post-id="fec68c05aa92" data-source="placement_card_footer_grid---------1-40" data-tracking-context="placement" data-scroll="native"><a class="link link--noUnderline u-baseColor--link" href="https://gab41.lab41.org/lab41-reading-group-skip-thought-vectors-fec68c05aa92?source=placement_card_footer_grid---------1-40" data-action-source="placement_card_footer_grid---------1-40"><div class="u-backgroundCover u-backgroundColorGrayLight u-height100 u-sizeFullWidth u-borderBottomLight u-borderRadiusTop4" style="background-image: url(&quot;https://cdn-images-1.medium.com/fit/c/800/240/1*GrPMDu7Yd2v3buWyQhbP3A.jpeg&quot;); background-position: 50% 50% !important;"></div></a><div class="u-padding15 u-borderBox u-flexColumn u-height180"><a class="link link--noUnderline u-flex1 u-baseColor--link" href="https://gab41.lab41.org/lab41-reading-group-skip-thought-vectors-fec68c05aa92?source=placement_card_footer_grid---------1-40" data-action-source="placement_card_footer_grid---------1-40"><div class="postMetaInline u-marginBottom7">Related reads</div><div class="u-textColorDarkest u-contentSansBold u-fontSize24 u-maxHeight2LineHeightTighter u-lineClamp2 u-textOverflowEllipsis u-letterSpacingTight u-paddingBottom2">Lab41 Reading Group: Skip-Thought Vectors</div></a><div class="u-paddingTop10 u-flex0 u-flexCenter"><div class="u-flex1"><div class="u-flexCenter"><div class="postMetaInline-avatar u-flex0"><a class="link avatar u-baseColor--link" href="https://gab41.lab41.org/@Alex.Gude" data-action="show-user-card" data-action-value="a6ad23d03f88" data-action-type="hover" data-user-id="a6ad23d03f88" data-collection-slug="gab41" dir="auto"><img src="./Theano vs Tensorflow – Richard Townsend – Medium_files/1-ujaNrV-4A1J_TIprVWttaw.jpeg" class="avatar-image u-size36x36 u-xs-size32x32" alt="Go to the profile of Alex Gude"></a></div><div class="postMetaInline-authorLockup u-flex1 u-noWrapWithEllipsis"><a class="link link link--darken link--darker u-baseColor--link" href="https://gab41.lab41.org/@Alex.Gude?source=placement_card_footer_grid---------1-40" data-action="show-user-card" data-action-source="placement_card_footer_grid---------1-40" data-action-value="a6ad23d03f88" data-action-type="hover" data-user-id="a6ad23d03f88" data-collection-slug="gab41" dir="auto">Alex Gude</a><div class="u-fontSize12 u-baseColor--textNormal u-textColorNormal js-postMetaInlineSupplemental"><span class="readingTime u-textColorNormal" title="4 min read"></span></div></div></div></div><div class="u-flex0 u-flexCenter"><div class="buttonSet"><div class="js-actionRecommend" data-post-id="fec68c05aa92" data-is-label-padded="true" data-source="placement_card_footer_grid---------1-40"><button class="button button--primary button--chromeless is-touchIconFadeInPulse u-accentColor--buttonNormal button--withIcon button--withSvgIcon u-accentColor--iconLight js-actionRecommendButton" title="Recommend to share this article with your followers and let the author know you liked it" aria-label="Recommend to share this article with your followers and let the author know you liked it" data-action="sign-in-prompt" data-sign-in-action="upvote" data-requires-token="true" data-redirect="https://medium.com/_/vote/p/fec68c05aa92" data-action-source="placement_card_footer_grid---------1-40"><span class="button-defaultState"><span class="svgIcon svgIcon--heart svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M12.5 21a.492.492 0 0 1-.327-.122c-.278-.24-.61-.517-.978-.826-2.99-2.5-7.995-6.684-7.995-10.565C3.2 6.462 5.578 4 8.5 4c1.55 0 3 .695 4 1.89a5.21 5.21 0 0 1 4-1.89c2.923 0 5.3 2.462 5.3 5.487 0 3.97-4.923 8.035-7.865 10.464-.42.35-.798.66-1.108.93a.503.503 0 0 1-.327.12zM8.428 4.866c-2.414 0-4.378 2.05-4.378 4.568 0 3.475 5.057 7.704 7.774 9.975.243.2.47.39.676.56.245-.21.52-.43.813-.68 2.856-2.36 7.637-6.31 7.637-9.87 0-2.52-1.964-4.57-4.377-4.57-1.466 0-2.828.76-3.644 2.04-.1.14-.26.23-.43.23-.18 0-.34-.09-.43-.24-.82-1.27-2.18-2.03-3.65-2.03z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--heartFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M12.5 21a.492.492 0 0 1-.327-.122c-.278-.24-.61-.517-.978-.826-2.99-2.5-7.995-6.684-7.995-10.565C3.2 6.462 5.578 4 8.5 4c1.55 0 3 .695 4 1.89a5.21 5.21 0 0 1 4-1.89c2.923 0 5.3 2.462 5.3 5.487 0 3.97-4.923 8.035-7.865 10.464-.42.35-.798.66-1.108.93a.503.503 0 0 1-.327.12z" fill-rule="evenodd"></path></svg></span></span></button><button class="button button--chromeless u-baseColor--buttonNormal u-disablePointerEvents u-marginLeft4" data-action="show-recommends" data-action-value="fec68c05aa92">16</button></div></div><div class="u-height20 u-borderRightLighter u-inlineBlock u-relative u-marginRight10 u-marginLeft12"></div><div class="buttonSet"><button class="button button--chromeless is-touchIconFadeInPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="sign-in-prompt" data-sign-in-action="add-to-bookmarks" data-requires-token="true" data-redirect="https://medium.com/_/bookmark/p/fec68c05aa92"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V6zm-6.838 9.97L7 19.636V6c0-.55.45-1 1-1h9c.55 0 1 .45 1 1v13.637l-5.162-3.668a.49.49 0 0 0-.676 0z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="26" viewBox="0 0 25 26"><path d="M19 7c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 17.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V7z" fill-rule="evenodd"></path></svg></span></span></button></div></div></div></div></div></div><div class="col u-padding8 u-xs-size12of12 u-size4of12"><div class="u-height280 u-sizeFullWidth u-backgroundWhite u-borderCardBorder u-boxShadow u-borderBox u-borderRadius4 js-trackedPost" data-post-id="e3cc367956fb" data-source="placement_card_footer_grid---------2-40" data-tracking-context="placement" data-scroll="native"><a class="link link--noUnderline u-baseColor--link" href="https://blog.insightdatascience.com/example-ml-projects-in-data-science-data-engineering-and-artificial-intelligence-e3cc367956fb?source=placement_card_footer_grid---------2-40" data-action-source="placement_card_footer_grid---------2-40"><div class="u-backgroundCover u-backgroundColorGrayLight u-height100 u-sizeFullWidth u-borderBottomLight u-borderRadiusTop4" style="background-image: url(&quot;https://cdn-images-1.medium.com/fit/c/800/240/1*Om8eWYPFQ7hnuvsZvPp94w.jpeg&quot;); background-position: 50% 50% !important;"></div></a><div class="u-padding15 u-borderBox u-flexColumn u-height180"><a class="link link--noUnderline u-flex1 u-baseColor--link" href="https://blog.insightdatascience.com/example-ml-projects-in-data-science-data-engineering-and-artificial-intelligence-e3cc367956fb?source=placement_card_footer_grid---------2-40" data-action-source="placement_card_footer_grid---------2-40"><div class="postMetaInline u-marginBottom7">Related reads</div><div class="u-textColorDarkest u-contentSansBold u-fontSize24 u-maxHeight2LineHeightTighter u-lineClamp2 u-textOverflowEllipsis u-letterSpacingTight u-paddingBottom2">Example ML projects in Data Science, Data Engineering, and Artificial Intelligence</div></a><div class="u-paddingTop10 u-flex0 u-flexCenter"><div class="u-flex1"><div class="u-flexCenter"><div class="postMetaInline-avatar u-flex0"><a class="link avatar u-baseColor--link" href="https://blog.insightdatascience.com/@jkarnows" data-action="show-user-card" data-action-value="959a893f35ce" data-action-type="hover" data-user-id="959a893f35ce" data-collection-slug="insight-data" dir="auto"><img src="./Theano vs Tensorflow – Richard Townsend – Medium_files/0-P8Pmkt3106rRO19p" class="avatar-image u-size36x36 u-xs-size32x32" alt="Go to the profile of Jeremy Karnowski"></a></div><div class="postMetaInline-authorLockup u-flex1 u-noWrapWithEllipsis"><a class="link link link--darken link--darker u-baseColor--link" href="https://blog.insightdatascience.com/@jkarnows?source=placement_card_footer_grid---------2-40" data-action="show-user-card" data-action-source="placement_card_footer_grid---------2-40" data-action-value="959a893f35ce" data-action-type="hover" data-user-id="959a893f35ce" data-collection-slug="insight-data" dir="auto">Jeremy Karnowski</a><div class="u-fontSize12 u-baseColor--textNormal u-textColorNormal js-postMetaInlineSupplemental"><span class="readingTime u-textColorNormal" title="3 min read"></span></div></div></div></div><div class="u-flex0 u-flexCenter"><div class="buttonSet"><div class="js-actionRecommend" data-post-id="e3cc367956fb" data-is-label-padded="true" data-source="placement_card_footer_grid---------2-40"><button class="button button--primary button--chromeless is-touchIconFadeInPulse u-accentColor--buttonNormal button--withIcon button--withSvgIcon u-accentColor--iconLight js-actionRecommendButton" title="Recommend to share this article with your followers and let the author know you liked it" aria-label="Recommend to share this article with your followers and let the author know you liked it" data-action="sign-in-prompt" data-sign-in-action="upvote" data-requires-token="true" data-redirect="https://medium.com/_/vote/p/e3cc367956fb" data-action-source="placement_card_footer_grid---------2-40"><span class="button-defaultState"><span class="svgIcon svgIcon--heart svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M12.5 21a.492.492 0 0 1-.327-.122c-.278-.24-.61-.517-.978-.826-2.99-2.5-7.995-6.684-7.995-10.565C3.2 6.462 5.578 4 8.5 4c1.55 0 3 .695 4 1.89a5.21 5.21 0 0 1 4-1.89c2.923 0 5.3 2.462 5.3 5.487 0 3.97-4.923 8.035-7.865 10.464-.42.35-.798.66-1.108.93a.503.503 0 0 1-.327.12zM8.428 4.866c-2.414 0-4.378 2.05-4.378 4.568 0 3.475 5.057 7.704 7.774 9.975.243.2.47.39.676.56.245-.21.52-.43.813-.68 2.856-2.36 7.637-6.31 7.637-9.87 0-2.52-1.964-4.57-4.377-4.57-1.466 0-2.828.76-3.644 2.04-.1.14-.26.23-.43.23-.18 0-.34-.09-.43-.24-.82-1.27-2.18-2.03-3.65-2.03z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--heartFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M12.5 21a.492.492 0 0 1-.327-.122c-.278-.24-.61-.517-.978-.826-2.99-2.5-7.995-6.684-7.995-10.565C3.2 6.462 5.578 4 8.5 4c1.55 0 3 .695 4 1.89a5.21 5.21 0 0 1 4-1.89c2.923 0 5.3 2.462 5.3 5.487 0 3.97-4.923 8.035-7.865 10.464-.42.35-.798.66-1.108.93a.503.503 0 0 1-.327.12z" fill-rule="evenodd"></path></svg></span></span></button><button class="button button--chromeless u-baseColor--buttonNormal u-disablePointerEvents u-marginLeft4" data-action="show-recommends" data-action-value="e3cc367956fb">29</button></div></div><div class="u-height20 u-borderRightLighter u-inlineBlock u-relative u-marginRight10 u-marginLeft12"></div><div class="buttonSet"><button class="button button--chromeless is-touchIconFadeInPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="sign-in-prompt" data-sign-in-action="add-to-bookmarks" data-requires-token="true" data-redirect="https://medium.com/_/bookmark/p/e3cc367956fb"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M19 6c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 16.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V6zm-6.838 9.97L7 19.636V6c0-.55.45-1 1-1h9c.55 0 1 .45 1 1v13.637l-5.162-3.668a.49.49 0 0 0-.676 0z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="26" viewBox="0 0 25 26"><path d="M19 7c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v14.66h.012c.01.103.045.204.12.285a.5.5 0 0 0 .706.03L12.5 17.85l5.662 4.126a.508.508 0 0 0 .708-.03.5.5 0 0 0 .118-.285H19V7z" fill-rule="evenodd"></path></svg></span></span></button></div></div></div></div></div></div></div></div></div></div><div class="u-padding0 u-clearfix u-backgroundGrayLightest u-print-hide supplementalPostContent js-responsesWrapper" data-action-scope="_actionscope_5"><div class="container u-maxWidth740"><div class="responsesStreamWrapper u-maxWidth640 js-responsesStreamWrapper"><div class="container u-maxWidth640 responsesStream-title u-paddingTop15"><div class="row"><header class="heading u-clearfix"><div class="u-clearfix"><div class="heading-content u-floatLeft"><span class="heading-title heading-title--semibold">Responses</span></div></div></header></div></div><div class="container u-maxWidth640 u-marginBottom30 responsesStream-editor cardChromeless js-responsesStreamEditor"><div class="row"><div class="col u-size12of12"><div class="u-paddingTop30 u-paddingBottom30 u-paddingLeft0 u-paddingRight0 u-borderBottomLightest js-responsesLoggedOutPrompt"><button class="button button--chromeless is-touchIconBlackPulse u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--withIconAndLabel button--loggedOutPrompt" data-action="sign-in-prompt" data-redirect="https://medium.com/@sentimentron/faceoff-theano-vs-tensorflow-e25648c31800#--respond" data-action-source="logged_out_response_prompt"><span class="svgIcon svgIcon--response svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M21.27 20.058c1.89-1.826 2.754-4.17 2.754-6.674C24.024 8.21 19.67 4 14.1 4 8.53 4 4 8.21 4 13.384c0 5.175 4.53 9.385 10.1 9.385 1.007 0 2-.14 2.95-.41.285.25.592.49.918.7 1.306.87 2.716 1.31 4.19 1.31.276-.01.494-.14.6-.36a.625.625 0 0 0-.052-.65c-.61-.84-1.042-1.71-1.282-2.58a5.417 5.417 0 0 1-.154-.75zm-3.85 1.324l-.083-.28-.388.12a9.72 9.72 0 0 1-2.85.424c-4.96 0-8.99-3.706-8.99-8.262 0-4.556 4.03-8.263 8.99-8.263 4.95 0 8.77 3.71 8.77 8.27 0 2.25-.75 4.35-2.5 5.92l-.24.21v.32c0 .07 0 .19.02.37.03.29.1.6.19.92.19.7.49 1.4.89 2.08-.93-.14-1.83-.49-2.67-1.06-.34-.22-.88-.48-1.16-.74z"></path></svg></span><span class="button-label  js-buttonLabel">Write a response…</span></button></div></div></div></div><div class="container u-maxWidth640 u-marginBottom30 u-borderTopLighter u-hide js-noOtherResponses"><div class="row"><div class="col u-size12of12"><div class="u-paddingTop20 u-paddingBottom25"><div class="u-inlineBlock u-verticalAlignTop u-paddingRight10"><div class="avatar u-inline"><img src="./Theano vs Tensorflow – Richard Townsend – Medium_files/1-dmbNkD5D-u45r44go_cf0g.png" class="avatar-image u-size36x36 u-xs-size32x32" alt="Unknown user"></div></div><div class="u-inlineBlock"><div class="u-lineHeight36 u-textColorNormal u-contentSerifRegular">No responses yet</div></div></div></div></div></div><div class="responsesStream js-responsesStream"></div><div class="container u-maxWidth640 js-showOtherResponses"><div class="row"><button class="button button--primary button--withChrome u-accentColor--buttonNormal responsesStream-showOtherResponses cardChromeless u-sizeFullWidth" data-action="show-other-responses">Show all responses</button></div></div><div class="responsesStream js-responsesStreamOther"></div></div></div></div><div class="supplementalPostContent js-readNext"></div><div class="supplementalPostContent js-heroPromo"></div></footer></article></main><div class="u-marginAuto u-maxWidth1000"><div class="js-postShareWidget u-foreground u-sm-hide u-transition--fadeOut300 u-fixed" data-scroll="fixed" style="top: 150px;"><ul><li class="u-uiTextSemibold u-textAlignCenter u-textColorNormal u-fontSize12 u-textUppercase">Share</li><li class="u-textAlignCenter"><div class="js-actionRecommend" data-post-id="e25648c31800" data-is-icon-29px="true" data-is-vertical="true" data-has-recommend-list="true" data-source="post_share_widget"><button class="button button--primary button--large button--chromeless is-touchIconFadeInPulse u-accentColor--buttonNormal button--withIcon button--withSvgIcon u-accentColor--iconLight js-actionRecommendButton" title="Recommend to share this article with your followers and let the author know you liked it" aria-label="Recommend to share this article with your followers and let the author know you liked it" data-action="sign-in-prompt" data-sign-in-action="upvote" data-requires-token="true" data-redirect="https://medium.com/_/vote/p/e25648c31800" data-action-source="post_share_widget"><span class="button-defaultState"><span class="svgIcon svgIcon--heart svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M16.215 23.716c-.348.288-.984.826-1.376 1.158a.526.526 0 0 1-.68 0c-.36-.307-.92-.78-1.22-1.03C9.22 20.734 3 15.527 3 10.734 3 7.02 5.916 4 9.5 4c1.948 0 3.77.898 5 2.434C15.73 4.898 17.552 4 19.5 4c3.584 0 6.5 3.02 6.5 6.734 0 4.9-6.125 9.96-9.785 12.982zM19.5 5.2c-1.774 0-3.423.923-4.41 2.468a.699.699 0 0 1-.59.323.706.706 0 0 1-.59-.32c-.988-1.54-2.637-2.47-4.41-2.47-2.922 0-5.3 2.49-5.3 5.54 0 4.23 6.19 9.41 9.517 12.19.217.18.566.48.783.66l.952-.79c3.496-2.88 9.348-7.72 9.348-12.05 0-3.05-2.378-5.53-5.3-5.53z"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--heartFilled svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M19.5 4c-1.948 0-3.77.898-5 2.434C13.27 4.898 11.448 4 9.5 4 5.916 4 3 7.02 3 10.734c0 4.793 6.227 10 9.95 13.11.296.25.853.723 1.212 1.03.196.166.48.166.677 0 .39-.332 1.02-.87 1.37-1.158 3.66-3.022 9.79-8.08 9.79-12.982C26 7.02 23.08 4 19.5 4z" fill-rule="evenodd"></path></svg></span></span></button><button class="button button--chromeless u-baseColor--buttonNormal  u-block u-marginAuto u-marginTopNegative5" data-action="show-recommends" data-action-value="e25648c31800">25</button></div></li><li class="u-textAlignCenter"><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon" title="Share on Twitter" aria-label="Share on Twitter" data-action="share-on-twitter" data-action-source="post_share_widget"><span class="svgIcon svgIcon--twitter svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M21.967 11.8c.018 5.93-4.607 11.18-11.177 11.18-2.172 0-4.25-.62-6.047-1.76l-.268.422-.038.5.186.013.168.012c.3.02.44.032.6.046 2.06-.026 3.95-.686 5.49-1.86l1.12-.85-1.4-.048c-1.57-.055-2.92-1.08-3.36-2.51l-.48.146-.05.5c.22.03.48.05.75.08.48-.02.87-.07 1.25-.15l2.33-.49-2.32-.49c-1.68-.35-2.91-1.83-2.91-3.55 0-.05 0-.01-.01.03l-.49-.1-.25.44c.63.36 1.35.57 2.07.58l1.7.04L7.4 13c-.978-.662-1.59-1.79-1.618-3.047a4.08 4.08 0 0 1 .524-1.8l-.825.07a12.188 12.188 0 0 0 8.81 4.515l.59.033-.06-.59v-.02c-.05-.43-.06-.63-.06-.87a3.617 3.617 0 0 1 6.27-2.45l.2.21.28-.06c1.01-.22 1.94-.59 2.73-1.09l-.75-.56c-.1.36-.04.89.12 1.36.23.68.58 1.13 1.17.85l-.21-.45-.42-.27c-.52.8-1.17 1.48-1.92 2L22 11l.016.28c.013.2.014.35 0 .52v.04zm.998.038c.018-.22.017-.417 0-.66l-.498.034.284.41a8.183 8.183 0 0 0 2.2-2.267l.97-1.48-1.6.755c.17-.08.3-.02.34.03a.914.914 0 0 1-.13-.292c-.1-.297-.13-.64-.1-.766l.36-1.254-1.1.695c-.69.438-1.51.764-2.41.963l.48.15a4.574 4.574 0 0 0-3.38-1.484 4.616 4.616 0 0 0-4.61 4.613c0 .29.02.51.08.984l.01.02.5-.06.03-.5c-3.17-.18-6.1-1.7-8.08-4.15l-.48-.56-.36.64c-.39.69-.62 1.48-.65 2.28.04 1.61.81 3.04 2.06 3.88l.3-.92c-.55-.02-1.11-.17-1.6-.45l-.59-.34-.14.67c-.02.08-.02.16 0 .24-.01 2.12 1.55 4.01 3.69 4.46l.1-.49-.1-.49c-.33.07-.67.12-1.03.14-.18-.02-.43-.05-.64-.07l-.76-.09.23.73c.57 1.84 2.29 3.14 4.28 3.21l-.28-.89a8.252 8.252 0 0 1-4.85 1.66c-.12-.01-.26-.02-.56-.05l-.17-.01-.18-.01L2.53 21l1.694 1.07a12.233 12.233 0 0 0 6.58 1.917c7.156 0 12.2-5.73 12.18-12.18l-.002.04z"></path></svg></span></button></li><li class="u-textAlignCenter"><button class="button button--large button--dark button--chromeless is-touchIconBlackPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon" title="Share on Facebook" aria-label="Share on Facebook" data-action="share-on-facebook" data-action-source="post_share_widget"><span class="svgIcon svgIcon--facebook svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M16.39 23.61v-5.808h1.846a.55.55 0 0 0 .546-.48l.36-2.797a.551.551 0 0 0-.547-.62H16.39V12.67c0-.67.12-.813.828-.813h1.474a.55.55 0 0 0 .55-.55V8.803a.55.55 0 0 0-.477-.545c-.436-.06-1.36-.116-2.22-.116-2.5 0-4.13 1.62-4.13 4.248v1.513H10.56a.551.551 0 0 0-.55.55v2.797c0 .304.248.55.55.55h1.855v5.76c-4.172-.96-7.215-4.7-7.215-9.1 0-5.17 4.17-9.36 9.31-9.36 5.14 0 9.31 4.19 9.31 9.36 0 4.48-3.155 8.27-7.43 9.15M14.51 4C8.76 4 4.1 8.684 4.1 14.46c0 5.162 3.75 9.523 8.778 10.32a.55.55 0 0 0 .637-.543v-6.985a.551.551 0 0 0-.55-.55H11.11v-1.697h1.855a.55.55 0 0 0 .55-.55v-2.063c0-2.02 1.136-3.148 3.03-3.148.567 0 1.156.027 1.597.06v1.453h-.924c-1.363 0-1.93.675-1.93 1.912v1.78c0 .3.247.55.55.55h2.132l-.218 1.69H15.84c-.305 0-.55.24-.55.55v7.02c0 .33.293.59.623.54 5.135-.7 9.007-5.11 9.007-10.36C24.92 8.68 20.26 4 14.51 4"></path></svg></span></button></li><li class="u-textAlignCenter"><button class="button button--large button--dark button--chromeless is-touchIconFadeInPulse u-baseColor--buttonDark button--withIcon button--withSvgIcon button--bookmark js-bookmarkButton" title="Bookmark this story to read later" aria-label="Bookmark this story to read later" data-action="sign-in-prompt" data-sign-in-action="add-to-bookmarks" data-requires-token="true" data-redirect="https://medium.com/_/bookmark/p/e25648c31800"><span class="button-defaultState"><span class="svgIcon svgIcon--bookmark svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4zM21 23l-5.91-3.955-.148-.107a.751.751 0 0 0-.884 0l-.147.107L8 23V6.615C8 5.725 8.725 5 9.615 5h9.77C20.275 5 21 5.725 21 6.615V23z" fill-rule="evenodd"></path></svg></span></span><span class="button-activeState"><span class="svgIcon svgIcon--bookmarkFilled svgIcon--29px"><svg class="svgIcon-use" width="29" height="29" viewBox="0 0 29 29"><path d="M19.385 4h-9.77A2.623 2.623 0 0 0 7 6.615V23.01a1.022 1.022 0 0 0 1.595.847l5.905-4.004 5.905 4.004A1.022 1.022 0 0 0 22 23.011V6.62A2.625 2.625 0 0 0 19.385 4z" fill-rule="evenodd"></path></svg></span></span></button></li></ul></div></div><div class="u-fixed u-bottom0 u-sizeFullWidth u-backgroundWhite u-boxShadowTop u-borderBox u-paddingTop10 u-paddingBottom10 u-zIndexMetabar u-xs-paddingLeft10 u-xs-paddingRight10 js-stickyFooter"><div class="u-maxWidth700 u-marginAuto u-flexCenter"><div class="u-fontSize16 u-flex1 u-flexCenter"><div class="u-flex0 u-inlineBlock u-paddingRight20 u-xs-paddingRight10"><a class="link avatar u-inline u-baseColor--link" href="https://medium.com/@sentimentron" data-action="show-user-card" data-action-value="ec21902de320" data-action-type="hover" data-user-id="ec21902de320" dir="auto"><img src="./Theano vs Tensorflow – Richard Townsend – Medium_files/0-j0J7Tp44phEIV9r3(2).jpg" class="avatar-image avatar-image--smaller" alt="Go to the profile of Richard Townsend"></a></div><div class="u-flex1 u-inlineBlock"><div class="u-xs-hide">Never miss a story from<strong> Richard Townsend</strong>, when you sign up for Medium. <a class="link link--accent u-accentColor--textNormal u-accentColor--textDarken u-baseColor--link" href="https://medium.com/@Medium/personalize-your-medium-experience-with-users-publications-tags-26a41ab1ee0c#.hx4zuv3mg" data-action-source="sticky_footer">Learn more</a></div><div class="u-xs-show">Never miss a story from<strong> Richard Townsend</strong></div></div></div><div class="u-marginLeft50 u-xs-marginAuto"><span class="followState js-followState buttonSet-inner" data-user-id="ec21902de320"><button class="button u-noUserSelect button--withChrome u-baseColor--buttonNormal button--withHover button--unblock js-unblockButton u-uiTextSemibold u-textUppercase u-fontSize12" data-action="sign-in-prompt" data-sign-in-action="toggle-block-user" data-requires-token="true" data-action-source="sticky_footer"><span class="button-label  button-defaultState">Blocked</span><span class="button-label button-hoverState">Unblock</span></button><button class="button button--primary is-active u-noUserSelect button--withChrome u-accentColor--buttonNormal button--follow js-followButton u-uiTextSemibold u-textUppercase u-fontSize12" data-action="sign-in-prompt" data-sign-in-action="toggle-subscribe-user" data-requires-token="true" data-redirect="https://medium.com/_/subscribe/user/ec21902de320" data-action-source="sticky_footer_follow"><span class="button-label  button-defaultState js-buttonLabel">Follow</span><span class="button-label button-activeState">Get updates</span></button></span></div></div></div><div class="highlightMenu" data-action-scope="_actionscope_3"><div class="highlightMenu-inner"><div class="buttonSet"><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--highlightMenu u-accentColor--highlightStrong js-highlightMenuQuoteButton" data-action="sign-in-prompt" data-sign-in-action="quote" data-requires-token="true" data-redirect-type="quote" data-action-source="quote_menu"><span class="svgIcon svgIcon--highlighter svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M13.7 15.964l5.204-9.387-4.726-2.62-5.204 9.387 4.726 2.62zm-.493.885l-1.313 2.37-1.252.54-.702 1.263-3.796-.865 1.228-2.213-.202-1.35 1.314-2.37 4.722 2.616z" fill-rule="evenodd"></path></svg></span></button><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--highlightMenu " data-action="sign-in-prompt" data-sign-in-action="quote-respond" data-action-source="quote_menu"><span class="svgIcon svgIcon--responseFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M19.074 21.117c-1.244 0-2.432-.37-3.532-1.096a7.792 7.792 0 0 1-.703-.52c-.77.21-1.57.32-2.38.32-4.67 0-8.46-3.5-8.46-7.8C4 7.7 7.79 4.2 12.46 4.2c4.662 0 8.457 3.5 8.457 7.803 0 2.058-.85 3.984-2.403 5.448.023.17.06.35.118.55.192.69.537 1.38 1.026 2.04.15.21.172.48.058.7a.686.686 0 0 1-.613.38h-.03z" fill-rule="evenodd"></path></svg></span></button><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--highlightMenu " data-action="twitter" data-action-source="quote_menu"><span class="svgIcon svgIcon--twitterFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><path d="M21.725 5.338c-.744.47-1.605.804-2.513 1.006a3.978 3.978 0 0 0-2.942-1.293c-2.22 0-4.02 1.81-4.02 4.02 0 .32.034.63.07.94-3.31-.18-6.27-1.78-8.255-4.23a4.544 4.544 0 0 0-.574 2.01c.04 1.43.74 2.66 1.8 3.38-.63-.01-1.25-.19-1.79-.5v.08c0 1.93 1.38 3.56 3.23 3.95-.34.07-.7.12-1.07.14-.25-.02-.5-.04-.72-.07.49 1.58 1.97 2.74 3.74 2.8a8.49 8.49 0 0 1-5.02 1.72c-.3-.03-.62-.04-.93-.07A11.447 11.447 0 0 0 8.88 21c7.386 0 11.43-6.13 11.414-11.414.015-.21.01-.38 0-.578a7.604 7.604 0 0 0 2.01-2.08 7.27 7.27 0 0 1-2.297.645 3.856 3.856 0 0 0 1.72-2.23"></path></svg></span></button><div class="buttonSet-separator"></div><button class="button button--chromeless u-baseColor--buttonNormal button--withIcon button--withSvgIcon button--highlightMenu " data-action="sign-in-prompt" data-sign-in-action="highlight" data-action-source="quote_menu"><span class="svgIcon svgIcon--privatenoteFilled svgIcon--25px"><svg class="svgIcon-use" width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M17.662 4.552H7.346A4.36 4.36 0 0 0 3 8.898v5.685c0 2.168 1.614 3.962 3.697 4.28v2.77c0 .303.35.476.59.29l3.904-2.994h6.48c2.39 0 4.35-1.96 4.35-4.35V8.9c0-2.39-1.95-4.346-4.34-4.346zM16 14.31a.99.99 0 0 1-1.003.99h-4.994C9.45 15.3 9 14.85 9 14.31v-3.02a.99.99 0 0 1 1-.99v-.782a2.5 2.5 0 0 1 2.5-2.51c1.38 0 2.5 1.13 2.5 2.51v.782c.552.002 1 .452 1 .99v3.02z"></path><path d="M14 9.81c0-.832-.674-1.68-1.5-1.68-.833 0-1.5.84-1.5 1.68v.49h3v-.49z"></path></g></svg></span></button></div></div><div class="highlightMenu-arrowClip"><span class="highlightMenu-arrow"></span></div></div></div></div></div><div class="loadingBar"></div><script>// <![CDATA[
window["obvInit"] = function (opt_embedded) {window["obvInit"]["embedded"] = opt_embedded; window["obvInit"]["ready"] = true;}
// ]]></script><script>// <![CDATA[
var GLOBALS = {"audioUrl":"https://d1fcbxp97j4nb2.cloudfront.net","baseUrl":"https://medium.com","buildLabel":"28671-50a1c5f","currentUser":{"userId":"lo_caa1d2a5a575","isVerified":false,"subscriberEmail":""},"currentUserHasUnverifiedEmail":false,"isAuthenticated":false,"isCurrentUserVerified":false,"language":"en-us","mediumTwitterScreenName":"medium","miroUrl":"https://cdn-images-1.medium.com","moduleUrls":{"base":"https://cdn-static-1.medium.com/_/fp/gen-js/main-base.bundle.oDalMnO-lBd4icN4yufEiA.js","notes":"https://cdn-static-1.medium.com/_/fp/gen-js/main-notes.bundle.tKOqulXX3p97KoRSkYK7yQ.js","posters":"https://cdn-static-1.medium.com/_/fp/gen-js/main-posters.bundle.VZGzerzvA1ok-TwbZsfRYg.js","common-async":"https://cdn-static-1.medium.com/_/fp/gen-js/main-common-async.bundle.7qFbgfqtBohjBP8JeqhnQQ.js","stats":"https://cdn-static-1.medium.com/_/fp/gen-js/main-stats.bundle.HCDnMYdjaS2s99OtJqR9Rw.js","home-screens":"https://cdn-static-1.medium.com/_/fp/gen-js/main-home-screens.bundle.UntaWoX_bi8Y7SwidSk4Jw.js","misc-screens":"https://cdn-static-1.medium.com/_/fp/gen-js/main-misc-screens.bundle.BROcYVpDGiqfYZXWdKq_qw.js"},"previewConfig":{"weightThreshold":1,"weightImageParagraph":0.51,"weightIframeParagraph":0.8,"weightTextParagraph":0.08,"weightEmptyParagraph":0,"weightP":0.003,"weightH":0.005,"weightBq":0.003,"minPTextLength":60,"truncateBoundaryChars":20,"detectTitle":true,"detectTitleLevThreshold":0.15},"productName":"Medium","supportsEdit":true,"termsUrl":"//medium.com/policy/9db0094a1e0f","textshotHost":"textshot.medium.com","transactionId":"1493015003144:6176a68d8cff","useragent":{"browser":"chrome","family":"chrome","os":"mac","version":57,"supportsDesktopEdit":true,"supportsInteract":true,"supportsView":true,"isMobile":false,"isTablet":false,"isNative":false,"supportsFileAPI":true,"isTier1":true,"clientVersion":"","unknownParagraphsBad":false,"clientChannel":"","supportsRealScrollEvents":true,"supportsVhUnits":true,"ruinsViewportSections":false,"supportsHtml5Video":true,"supportsMagicUnderlines":true,"isWebView":false,"isFacebookWebView":false,"supportsProgressiveMedia":true,"supportsPromotedPosts":true,"isBot":false,"isNativeIphone":false,"supportsCssVariables":true,"supportsScrollableMetabar":true},"variants":{"allow_access":true,"allow_signup":true,"allow_test_auth":"disallow","signin_services":"twitter,facebook,google,email,google-fastidv","signup_services":"twitter,facebook,google,email,google-fastidv","android_rating_prompt_recommend_threshold":5,"google_sign_in_android":true,"enable_onboarding":true,"ios_custom_miro_url":"https://cdn-images-1.medium.com","reengagement_notification_duration":3,"enable_adsnative_integration":true,"browsable_stream_config_bucket":"curated-topics","ios_small_post_preview_truncation_length":5.5,"ios_large_post_preview_truncation_length":5.5,"disable_ios_catalog_badging":true,"enable_series_creation":true,"enable_your_series_pages":true,"enable_productionized_series":true,"enable_dedicated_series_tab_api_ios":true,"enable_clap_milestone_notifications":true,"enable_series_stats_page":true,"should_receive_daily_push_notification":true,"enable_prepublish_share_settings":true,"enable_direct_auth_connect":true,"enable_post_import":true,"enable_sponsored_post_labelling":true,"enable_logged_in_follow_on_collection_post":true,"promoted_story_placement_locations":"POST_PAGE_FOOTER","show_topics":true,"enable_search_collection_by_tag_recency_filter":true,"search_collection_by_tag_filter_min_votes":10,"enable_sms_app_promo":true,"enable_export_members":true,"enable_series_card_background_creation":true,"enable_loyal_writers_onboarding":true,"enable_onboarding_hybrid_users":true,"enable_onboarding_users_by_tag":true,"enable_ios_onboarding_notifications":true,"can_see_subscription_branding":true,"enable_subscriptions_landing_page":true,"enable_partner_program_landing_page":true,"enable_hide_broken_links":true,"enable_pay_for_custom_domain":true,"enable_promos_from_dynamo":true,"enable_promos_in_placement":true,"enable_series_promo_in_email":true,"enable_sms":true,"enable_series_in_user_profiles":true,"enable_new_logged_out_bento_operation":true,"enable_shadow_read_new_stats_source":true},"xsrfToken":"","iosAppId":"828256236","supportEmail":"yourfriends@medium.com","teamName":"Team Medium","fp":{"/icons/favicon.svg":"https://cdn-static-1.medium.com/_/fp/icons/favicon.KjTfUJo7yJH_fCoUzzH3cg.svg","/icons/favicon-dev-editor.ico":"https://cdn-static-1.medium.com/_/fp/icons/favicon-dev-editor.YKKRxBO8EMvIqhyCwIiJeQ.ico","/icons/favicon-hatch-editor.ico":"https://cdn-static-1.medium.com/_/fp/icons/favicon-hatch-editor.BuEyHIqlyh2s_XEk4Rl32Q.ico","/icons/favicon-medium-editor.ico":"https://cdn-static-1.medium.com/_/fp/icons/favicon-medium-editor.PiakrZWB7Yb80quUVQWM6g.ico"},"authBaseUrl":"https://medium.com","imageUploadSizeMb":25,"isAuthDomainRequest":true,"algoliaApiEndpoint":"https://MQ57UUUQZ2-dsn.algolia.net","algoliaAppId":"MQ57UUUQZ2","algoliaSearchOnlyApiKey":"394474ced050e3911ae2249ecc774921","iosAppStoreUrl":"https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&mt=8","iosAppLinkBaseUrl":"medium:","algoliaIndexPrefix":"medium_","androidPlayStoreUrl":"https://play.google.com/store/apps/details?id=com.medium.reader","googleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","androidPackage":"com.medium.reader","androidPlayStoreMarketScheme":"market://details?id=com.medium.reader","googleAuthUri":"https://accounts.google.com/o/oauth2/auth","androidScheme":"medium","layoutData":{"useDynamicScripts":false,"googleAnalyticsTrackingCode":"UA-24232453-2","jsShivUrl":"https://cdn-static-1.medium.com/_/fp/js/shiv.RI2ePTZ5gFmMgLzG5bEVAA.js","useDynamicCss":false,"faviconUrl":"https://cdn-static-1.medium.com/_/fp/icons/favicon-medium.TAS6uQ-Y7kcKgi0xjcYHXw.ico","faviconImageId":"1*W0nmth_X8nFKjn6BZ388UQ.png","fontSets":[{"id":1,"url":"https://cdn-static-1.medium.com/_/fp/css/fonts-base.by5Oi_VbnwEIvhnWIsuUjA.css"},{"id":4,"url":"https://cdn-static-1.medium.com/_/fp/css/fonts-lazy-base.g08Jj5TZPAiuPWj5YNUsSg.css"},{"id":6,"url":"https://cdn-static-1.medium.com/_/fp/css/fonts-latin-base.141WxxXgxGxNcfeza73H7Q.css"},{"id":7,"url":"https://cdn-static-1.medium.com/_/fp/css/fonts-lazy-latin-base.jMU532QDmysQMOINr-cr2A.css"}],"editorFaviconUrl":"https://cdn-static-1.medium.com/_/fp/icons/favicon-medium-editor.PiakrZWB7Yb80quUVQWM6g.ico"},"authBaseUrlRev":"moc.muidem//:sptth","isDnt":false,"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","archiveUploadSizeMb":100,"paymentData":{"currencies":{"1":{"label":"US Dollar","external":"usd"}},"countries":{"1":{"label":"United States of America","external":"US"}},"accountTypes":{"1":{"label":"Individual","external":"individual"},"2":{"label":"Company","external":"company"}}},"previewConfig2":{"weightThreshold":1,"weightImageParagraph":0.05,"raiseImage":true,"enforceHeaderHierarchy":true,"isImageInsetRight":true},"isAmp":false,"iosScheme":"medium","isSwBoot":false,"lightstep":{"accessToken":"ce5be895bef60919541332990ac9fef2","carrier":"{\"ot-tracer-spanid\":\"588a311e1b0cd80a\",\"ot-tracer-traceid\":\"692da6db6bee2404\",\"ot-tracer-sampled\":\"true\"}","host":"collector-medium.lightstep.com"},"facebook":{"key":"542599432471018","secret":"c14df7146e9052a1131f3c900c1f0644","token":"542599432471018|1JqjIwxSfY9jOt_KwjWEl1R7T6I","namespace":"medium-com","scope":{"default":["public_profile","email","user_friends"],"connect":["public_profile","email","user_friends"],"login":["public_profile","email","user_friends"],"share":["public_profile","email","user_friends","publish_actions"]},"smartPublishWhitelistedPublications":["bcc38c8f6edf","f3726e2a5878","828a270689e","81c7d351c056","f30e42fd7ff8","8bf1d7d3081b","d16afa0ae7c","d8f3f6ad9c31","e74de0cedea9","15f753907972","c8c6a6b01ebd","3412b9729488","2ce4bbcf83bb","544c7006046e","7bfcdbc6b30a","a268fd916824","458a773bccd2"],"instantArticles":{"published":true,"developmentMode":false}},"mailingListArchiveUploadSizeMb":2,"availableMembershipPlans":[],"editorsPicksTopicId":"3985d2a191c5","popularOnMediumTopicId":"9d34e48ecf94","memberContentTopicId":"13d7efd82fb2","isDoNotAuth":false,"goldfinchUrl":"https://goldfinch.medium.com"}
// ]]></script><script charset="UTF-8" src="./Theano vs Tensorflow – Richard Townsend – Medium_files/main-base.bundle.oDalMnO-lBd4icN4yufEiA.js" async=""></script><script>// <![CDATA[
window["obvInit"]({"value":{"id":"e25648c31800","versionId":"758ee7514621","creatorId":"ec21902de320","creator":{"userId":"ec21902de320","name":"Richard Townsend","username":"sentimentron","createdAt":1447541736210,"lastPostCreatedAt":1488061363719,"imageId":"0*j0J7Tp44phEIV9r3.jpg","backgroundImageId":"","bio":"I program operating systems by day, and Natural Language models by night.","twitterScreenName":"","socialStats":{"userId":"ec21902de320","usersFollowedCount":6,"usersFollowedByCount":46,"type":"SocialStats"},"social":{"userId":"lo_caa1d2a5a575","targetUserId":"ec21902de320","type":"Social"},"facebookAccountId":"10153299829709226","allowNotes":1,"type":"User"},"homeCollectionId":"","title":"Theano vs Tensorflow","detectedLanguage":"en","latestVersion":"758ee7514621","latestPublishedVersion":"758ee7514621","hasUnpublishedEdits":false,"latestRev":3336,"createdAt":1447541774205,"updatedAt":1492764354566,"acceptedAt":0,"firstPublishedAt":1464629129213,"latestPublishedAt":1464630844005,"vote":false,"experimentalCss":"","displayAuthor":"","content":{"subtitle":"Should you rewrite everything?","bodyModel":{"paragraphs":[{"name":"aea6","type":3,"text":"Porting a model to TensorFlow","markups":[]},{"name":"f4ff","type":4,"text":"","markups":[],"layout":5,"metadata":{"id":"1*5JiPSy-VWASl7L9kflq4ag.png","originalWidth":2500,"originalHeight":1200}},{"name":"5647","type":1,"text":"TensorFlow is a recent addition to a constellation of frameworks designed to accelerate the process of building deep models. Of these, I’ve only previously had time to learn Theano — one of the more venerable frameworks in this fairly young field. Just like TensorFlow, Theano uses Python as a meta-programming language to describe a model symbolically — add these two tensors together; take the average of this over that axis — and then differentiate it to ensure that parameter optimisation is tractable and efficient. Unlike TensorFlow however, Theano requires end-users to re-implement lots of the standard components that often crop up in models — especially optimisers, cost calculations and things like dropout (often used in combination with softmax). Both libraries also allow a mix of GPU and CPU code generation. But aside from style, which framework helps you get results fast? Which is easier to program? Which produces models which train quickly? TensorFlow offers a nice API, lots of built in functionality and a robust device model and integrated cluster awareness, whereas Theano offers more aggressive compute graph optimisation and lots of tuneable parameters. So which on balance provides the best blend of performance and productivity?","markups":[{"type":3,"start":37,"end":65,"href":"http://deeplearning.net/software_links/","title":"","rel":"","anchorType":0},{"type":3,"start":1026,"end":1080,"href":"https://www.tensorflow.org/versions/r0.8/how_tos/using_gpu/index.html","title":"","rel":"","anchorType":0},{"type":3,"start":1104,"end":1146,"href":"http://deeplearning.net/software/theano/extending/optimization.html","title":"","rel":"","anchorType":0},{"type":3,"start":1151,"end":1178,"href":"http://deeplearning.net/software/theano/library/config.html","title":"","rel":"","anchorType":0}]},{"name":"9b19","type":3,"text":"Introducing Dracula","markups":[]},{"name":"1060","type":1,"text":"To find out, I decided to port a reasonably simple natural language model — called Dracula — from Theano to TensorFlow. Dracula is an LSTM-based sequence tagger (the initial application is part-of-speech tagging) that operates at the level of individual characters, making its models small and reducing the need for preprocessing operations like thresholding rare words, building dictionaries of proper nouns, filtering emoticons and other pre-processing that’s unlikely to help performance outside the validation environment, meaning it’s good for less-structured environments like Twitter.","markups":[{"type":3,"start":76,"end":91,"href":"http://dracula.sentimentron.co.uk","title":"","rel":"","anchorType":0}]},{"name":"3bfe","type":4,"text":"","markups":[],"layout":1,"metadata":{"id":"1*ASLWyfro_yRaAQWAccQ31g.png","originalWidth":2500,"originalHeight":1310}},{"name":"f8cd","type":1,"text":"Dracula has a couple of main steps:","markups":[]},{"name":"33e6","type":10,"text":"Generating character embeddings inputs;","markups":[]},{"name":"728c","type":10,"text":"Applying zero or more LSTM layers per word, at the character level;","markups":[]},{"name":"cb98","type":10,"text":"Mean-pooling the character-level representations into character-level representations;","markups":[]},{"name":"c0e8","type":10,"text":"Applying zero or more LSTM layers per sentence, at the word-level;","markups":[]},{"name":"d97a","type":10,"text":"Applying softmax to generate the final per-word labels.","markups":[]},{"name":"3026","type":1,"text":"This makes it just tractable enough for a reasonably short port, but just complicated enough to hit some unusual TensorFlow API corners.","markups":[]},{"name":"6719","type":3,"text":"Going out of the box","markups":[]},{"name":"9dd7","type":1,"text":"Theano needs a fairly standard set of tools and is easily installed via pip. TensorFlow is just as straightforward: just follow the instructions. However, when I first evaluated TensorFlow several months ago, I quickly found out that they’d hard-coded a dependency on the CUDA 7.0 SDK into their build files, making it very difficult to run on system using a later version of CUDA. In the last few weeks, the TensorFlow team have released version 0.8, which corrects that problem. It also now supports Python 3 — which I’m gradually switching to — but for the rest of this post I’m using 2.7.","markups":[{"type":3,"start":241,"end":307,"href":"https://github.com/tensorflow/tensorflow/issues/20","title":"","rel":"","anchorType":0}]},{"name":"daa4","type":1,"text":"Once installed, I tested it out using an example script from Google, reproduced below:","markups":[]},{"name":"1401","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"07ad30bdb50d3cb6c4affab5213cf261"}},{"name":"5074","type":1,"text":"Here’s a rough equivalent in Theano:","markups":[]},{"name":"9242","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"ec7425d32ba1efdb7a6894d9e97f9959"}},{"name":"a915","type":1,"text":"These two little scripts actually encapsulate a great deal of the difference between the two frameworks. Each starts off with two identically-generated numpy arrays describing the input, and the target output (it’s mathematically z = 0.1 * x + 0.2 * y). Next, comes model initialisation:","markups":[{"type":2,"start":230,"end":251}]},{"name":"1b88","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"2b8b8c3916cbe0e06c8b332bf0ae113a"}},{"name":"d01f","type":1,"text":"Note that TensorFlow doesn’t require any special treatment of the x and y variables: they just exist in their native forms. Theano meanwhile requires some additional plumbing to say that the variables are symbolic inputs to the function. The syntax defining what the b and W variables look like is also, in my opinion, a little nicer.","markups":[{"type":2,"start":66,"end":68},{"type":2,"start":72,"end":73},{"type":2,"start":267,"end":268},{"type":2,"start":273,"end":274}]},{"name":"043b","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"83f5f593fa30aacf2736918d7bb2097f"}},{"name":"5fdd","type":1,"text":"Next up is the way of actually learning: gradient descent.","markups":[]},{"name":"8548","type":10,"text":"These lines are all about specifying what we’re minimising, in this case mean squared error. The syntax is similar.","markups":[]},{"name":"a51a","type":10,"text":"Lines marked (2) are about setting up the code to compute the gradients with respect to each of the variables we’re learning, and changing the weights in response to a new gradient. TensorFlow gives access to lots of good optimisers out of the box (including gradient descent and Adadelta). Theano makes me do all the hard work. This is both a good and bad thing: it offers ultimate control, but also affects code comprehension and increases verification effort.","markups":[]},{"name":"e91f","type":10,"text":"Finally, we form a training function that zips together everything previously so we can update it.","markups":[]},{"name":"d716","type":1,"text":"Finally, we get to the body of the training itself:","markups":[]},{"name":"17f9","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"0857cfb3082a3aa0b99ec03077cf125e"}},{"name":"cad5","type":1,"text":"Again, the function of these fragments is essentially identical: but TensorFlow’s philosophy of encapsulating the graph execution in the Session object does feel conceptually cleaner than Theano’s.","markups":[{"type":2,"start":137,"end":144}]},{"name":"10dc","type":3,"text":"Porting the embeddings matrix","markups":[]},{"name":"f5d8","type":1,"text":"Step 1 of Dracula is to take two arrays per batch as input: one represents the character indices for each tweet, and the other describes how the characters are laid out into words that we want to classify. Here’s what the embeddings matrix code looks in Theano:","markups":[{"type":3,"start":206,"end":261,"href":"https://github.com/Sentimentron/Dracula/blob/2016-04-16/nn_layers.py#L10","title":"","rel":"","anchorType":0}]},{"name":"e8b4","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"4d5c0661fb86a49aa5f0fd989d50e4a3"}},{"name":"658f","type":1,"text":"And here’s how it looks in TensorFlow:","markups":[]},{"name":"e8fd","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"ce40358d9b594970bcc87947d85c3953"}},{"name":"0cbe","type":1,"text":"TensorFlow doesn’t have a flatten operation like Theano does (for those looking — pass -1 into the reshape function’s shape parameter), but actually that turned out not to be necessary: gather does the equivalent operation by slicing up the embeddings matrix Wemb into slices defined by the matrix of indices x. Whilst TensorFlow’s written documentation is generally excellent — if a bit confusing — it’s online documentation is especially excellent: whilst I was groping around for gather, TensorFlow gave me really excellent error messages to help me figure out what was going on. Since I first ported some of the code, 0.8 introduces a new function which improves handling of very large embeddings matrices distributed across multiple machines.","markups":[{"type":3,"start":82,"end":133,"href":"http://tensorflow.org/api_docs/python/array_ops.html#reshape","title":"","rel":"","anchorType":0},{"type":3,"start":186,"end":192,"href":"https://www.tensorflow.org/versions/r0.8/api_docs/python/array_ops.html#gather","title":"","rel":"","anchorType":0},{"type":3,"start":583,"end":747,"href":"https://www.tensorflow.org/versions/r0.8/api_docs/python/nn.html#embedding_lookup","title":"","rel":"","anchorType":0},{"type":2,"start":26,"end":33},{"type":2,"start":99,"end":106},{"type":2,"start":186,"end":192},{"type":2,"start":259,"end":263},{"type":2,"start":309,"end":312},{"type":2,"start":483,"end":490}]},{"name":"b60e","type":3,"text":"Aside: testing TensorFlow","markups":[]},{"name":"f1ab","type":1,"text":"As I port each layer of Dracula over to TensorFlow, I’m adding and revising tests as I go along. I use Python’s unittest module because it’s convenient and built-in, but it’s more interesting to discuss how TensorFlow fits in. Here’s the test for the above:","markups":[{"type":2,"start":112,"end":120}]},{"name":"77d5","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"9dce1b19c77c46418f5e689130addd53"}},{"name":"9fe3","type":1,"text":"Straightforward stuff, set up some numpy arrays, declare the embeddings matrix as a tf.Variable (since in the model it’s learned) and declare the input index array as a constant for evaluation. We then run through the session boilerplate, execute the embeddings_layer function to get a Tensor, and then use eval to turn it into a numpy array for assertion.","markups":[{"type":2,"start":251,"end":267},{"type":2,"start":307,"end":311}]},{"name":"a999","type":3,"text":"Per-word averaging / max pooling","markups":[]},{"name":"b10b","type":1,"text":"Per-word averaging is a convolution operation that takes the embeddings or letter-level LSTM output for each character, and turns it into a discrete word embedding that can then be fed to higher recurrent layers. Getting this bit right was the hardest part of creating the first version of the model and underwent several revisions to improve performance. The final version uses a (max word index, max char index, batch size, embedding size)-sized tensor from the embeddings layer and then averages out the second dimension, leaving a 3D (max word index, batch size, embedding size) tensor. The mask is used to communicate to the algorithm which bits of the input are defined (i.e. covered by actual letters in the input), so the input is masked off via element-wise multiplication and then summed to produce the divider. The divider is normalised so that it contains no zeros (if a zero’s on the bottom, then there should be a zero on top too). The per-dimension total is then element-wise divided by this result. Theano’s code is relatively straightforward:","markups":[{"type":2,"start":381,"end":442},{"type":2,"start":447,"end":448},{"type":2,"start":538,"end":583}]},{"name":"0edb","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"6f111a544f3d50fba8029e9e3b06d063"}},{"name":"7972","type":1,"text":"The dimshuffle calls aren’t actually unnecessary, and I picked this up during the port (they’ll be removed in a future version). Note than in Theano, operations like sum are often attached to the tensors themselves, indicating that the result is derived from the previous step in the computational graph. Operations which bring multiple parts of the compute graph together (like eq) are still defined within Theano’s main namespace. Tensorflow’s version looks very similar, but moves everything into the main namespace.","markups":[{"type":2,"start":4,"end":14},{"type":2,"start":166,"end":169},{"type":2,"start":379,"end":381}]},{"name":"30b3","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"7c27cfaec6e676a166cee6d01ac9ec42"}},{"name":"ef67","type":3,"text":"Softmax and dropout","markups":[]},{"name":"a5b9","type":1,"text":"The softmax layer is used to produce a probability distribution across the possible labels. Both frameworks assume that the input to softmax is 2D, so we have to use the frameworks’ iteration constructs to scan across each 2D slice of the 3D output of Dracula. Both final softmax layers use dropout during training to try to fight overfitting.","markups":[]},{"name":"4991","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"9c73c9cb5bf35ac5230daf25c96d5805"}},{"name":"3442","type":1,"text":"Again, there’s an issue with undefined input, which should always be given a particular label. The way this is accomplished by Dracula in Theano is to create a default tensor with the probability distribution of the undefined label, and then setting the defined areas to the output of softmax. Theano’s scan function is used to convert the (max word index, batch size, embedding size) input into a (batch size, embedding size) slice.","markups":[{"type":3,"start":285,"end":292,"href":"http://deeplearning.net/software/theano/library/tensor/nnet/nnet.html#tensor.nnet.softmax","title":"","rel":"","anchorType":0},{"type":3,"start":303,"end":307,"href":"http://deeplearning.net/software/theano/library/scan.html","title":"","rel":"","anchorType":0},{"type":2,"start":340,"end":384},{"type":2,"start":398,"end":426}]},{"name":"5703","type":1,"text":"Tensorflow’s implementation is a little more complicated because I opted to use the same implementation to produce both the probability distributions and the raw activations for computing the cost. This is needed because of the cost function I chose, which for some inexplicable reason does softmax internally (“for efficiency”).","markups":[{"type":3,"start":251,"end":328,"href":"https://www.tensorflow.org/versions/r0.8/api_docs/python/nn.html#sparse_softmax_cross_entropy_with_logits","title":"","rel":"","anchorType":0}]},{"name":"1f60","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"1def06292e997e5e672964abba9d524a"}},{"name":"90c9","type":1,"text":"Overall it’s very straightforward: TensorFlow has a built in drop-out function, and map_fn takes care of creating the 2D slices. Because TensorFlow’s indexing capability is limited, it’s not possible to mask undefined regions of the input in TensorFlow like in Theano: but it’s possible to work around it in this case by using the correct cost function.","markups":[{"type":2,"start":84,"end":90}]},{"name":"9a78","type":3,"text":"Gluing it together with LSTM layers","markups":[]},{"name":"d2fc","type":1,"text":"Dracula supports a variable number of LSTM layers at both the word and character levels to perform sequence tagging. This — more than anywhere else — is where the port differs from Theano. The Theano implementation applies the modifed form of the LSTM presented in the sentiment analysis demo multiple times, and supports both 2D and 3D versions (thanks to broadcasting). The forward and backward iterations are summed to produce the final output.","markups":[]},{"name":"6f96","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"cf7760d7739c9675430bedab56059a46"}},{"name":"2951","type":1,"text":"The TensorFlow version has only one single activation weight and bias, and the multiple layers are natively supported within the framework. TensorFlow requires two 2D scans (both per-word and per-letter) to compute the output.","markups":[]},{"name":"ce28","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"5424e562e2d2d92c8f6acdcf5d7f405c"}},{"name":"1485","type":3,"text":"Cost function","markups":[]},{"name":"26ab","type":1,"text":"This was surprisingly one of the more difficult pieces to port. In Theano, the cost is computed with via mean squared-error based on the negative log probabilities, and looks like this:","markups":[]},{"name":"ef0a","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"f830951933887b88cc6345561ccb1414"}},{"name":"bced","type":1,"text":"TensorFlow’s got a function which does much the same thing, and (guess what!) it only operates on 2D tensors. So to port this code, it’s necessary to iterate in much the same way, with the caveat that indexing via lists, TensorFlow Variable objects and other symbolic tensors is not supported. As a result, it’s not possible do a map_fn on a tf.range and access the labels and computed probabilities within the scanning function like in Theano, and it’s not possible to pass more than one tensor in either.","markups":[{"type":3,"start":0,"end":58,"href":"https://www.tensorflow.org/versions/r0.8/api_docs/python/nn.html#sparse_softmax_cross_entropy_with_logits","title":"","rel":"","anchorType":0},{"type":3,"start":330,"end":336,"href":"https://www.tensorflow.org/versions/r0.8/api_docs/python/functional_ops.html#map_fn","title":"","rel":"","anchorType":0},{"type":3,"start":342,"end":350,"href":"https://www.tensorflow.org/versions/r0.8/api_docs/python/constant_op.html#range","title":"","rel":"","anchorType":0},{"type":3,"start":445,"end":506,"href":"http://stackoverflow.com/questions/37086098/does-tensorflow-map-fn-support-taking-more-than-one-tensor","title":"","rel":"","anchorType":0},{"type":2,"start":330,"end":336}]},{"name":"fc76","type":1,"text":"The solution was to combine the tensors representing the reference labels (y) and the unscaled activations (pred_logits) are combined and then unpacked within the map routine. This is a little gross, but it works.","markups":[{"type":2,"start":75,"end":76},{"type":2,"start":108,"end":119}]},{"name":"66b0","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"979ad6cc80d8c6c1d911df598004276b"}},{"name":"b57e","type":3,"text":"Supporting code and infrastructure","markups":[]},{"name":"7a45","type":1,"text":"Instead of needing numpy to save Theano’s parameters, TensorFlow has the capability to save tensor values built-in, so that’s great. The only catch is that all variables must be specified in advance (otherwise TensorFlow will complain when model parameters are reloaded), meaning that hyper-parameter optimisations where layers are added or removed have to be considered in advance.","markups":[]},{"name":"a836","type":11,"text":"","markups":[],"layout":1,"iframe":{"mediaResourceId":"4eb099a0937b449d767ed538156ab907"}},{"name":"0083","type":1,"text":"Saving the state of the graph is as easy as creating a tf.train.Saver object with some tf.Variables, including it in the session and then calling it’s save method. The Saver object also supports incremental checkpointing, making it a good fit for environments where training can stop and start (like Amazon EC2 Spot Instances).","markups":[{"type":3,"start":55,"end":76,"href":"https://www.tensorflow.org/versions/r0.8/api_docs/python/state_ops.html#Saver","title":"","rel":"","anchorType":0}]},{"name":"3fea","type":3,"text":"Performance","markups":[]},{"name":"70e2","type":1,"text":"TensorFlow has acquired a reputation for being sluggish, and that certainly bears out in my testing. For the initial pre-training stage (with no LSTM layers, just embeddings, averaging and softmax), TensorFlow takes 163 seconds per epoch to train on my single NVidia GTX 980 consumer-class GPU. With letter layer LSTMs, it takes 5503 seconds per epoch. In Theano, the first stage takes 95 seconds per epoch and the second requires 1709, despite doing more work in the LSTM layers. Whilst there is likely some optimisation work to do, a significant amount of this difference is probably down to Theano’s more aggressive compilation and optimisation strategy, which can result in long startup times for the model. Without optimisation enabled, the model starts up as quickly under Theano as it does under TensorFlow. The good news is that TensorFlow’s performance is improving, and for certain workloads it’s quite competitive with other specialized frameworks. But for single-machine workloads, it’s quite hard to recommend it at this stage.","markups":[{"type":3,"start":0,"end":55,"href":"https://www.reddit.com/r/MachineLearning/comments/3shflv/tensorflows_poor_performance_means_they_dont_use/","title":"","rel":"","anchorType":0},{"type":3,"start":815,"end":959,"href":"https://github.com/soumith/convnet-benchmarks","title":"","rel":"","anchorType":0}]},{"name":"0c26","type":3,"text":"Conclusion","markups":[]},{"name":"5b90","type":1,"text":"The big unknown is whether Theano can turn into TensorFlow (e.g. by adding multi-GPU support) faster than TensorFlow can turn into Theano. I wouldn’t count on it: with a fully managed cloud platform already available, its growing adoption inside Google, custom hardware, Google’s significant developer resources and mind-share, and the promise to bring the core engine to other platforms, there’s no chance of TensorFlow going anywhere in the near future. Right now, assuming the compute time involved in training is cheap, there may be small productivity improvements under TensorFlow — it has built-in optimizers, more built in neural network capabilities, and tightly integrated check-pointing — but its performance and its potential just hasn’t arrived yet. Whilst I’m not officially releasing or supporting the code behind this article (which definitely bears the scars of battle), I’m going to keep it around and update it for TensorFlow 0.9 (hopefully due soon).","markups":[{"type":3,"start":65,"end":92,"href":"http://deeplearning.net/software/theano/tutorial/using_multi_gpu.html","title":"","rel":"","anchorType":0},{"type":3,"start":163,"end":216,"href":"https://cloud.google.com/ml/","title":"","rel":"","anchorType":0},{"type":3,"start":218,"end":252,"href":"http://googleresearch.blogspot.co.uk/2016/04/deepmind-moves-to-tensorflow.html","title":"","rel":"","anchorType":0},{"type":3,"start":254,"end":269,"href":"https://cloudplatform.googleblog.com/2016/05/Google-supercharges-machine-learning-tasks-with-custom-chip.html","title":"","rel":"","anchorType":0},{"type":3,"start":762,"end":840,"href":"https://github.com/Sentimentron/Dracula/tree/tensorflow3","title":"","rel":"","anchorType":0}]}],"sections":[{"name":"57d8","startIndex":0},{"name":"485e","startIndex":13}]},"postDisplay":{"coverless":true}},"virtuals":{"allowNotes":true,"previewImage":{"imageId":"1*5JiPSy-VWASl7L9kflq4ag.png","filter":"","backgroundSize":"","originalWidth":2500,"originalHeight":1200,"strategy":"resample","height":0,"width":0},"wordCount":2263,"imageCount":2,"readingTime":8.922955974842766,"subtitle":"Should you rewrite everything?","usersBySocialRecommends":[],"recommends":25,"socialRecommends":[],"isBookmarked":false,"tags":[{"slug":"deep-learning","name":"Deep Learning","postCount":2321,"virtuals":{"isFollowing":false},"metadata":{"followerCount":6068,"postCount":2321,"coverImage":{"id":"1*10J-DLRWCaGE1GM_A7TFVg.jpeg","originalWidth":1200,"originalHeight":800,"isFeatured":true}},"type":"Tag"},{"slug":"machine-learning","name":"Machine Learning","postCount":12719,"virtuals":{"isFollowing":false},"metadata":{"followerCount":16548,"postCount":12719,"coverImage":{"id":"1*xyIj5pkzC8ldTCpHsfeztw.jpeg","originalWidth":1500,"originalHeight":800,"isFeatured":true,"focusPercentX":50,"focusPercentY":50}},"type":"Tag"},{"slug":"tensorflow","name":"TensorFlow","postCount":375,"virtuals":{"isFollowing":false},"metadata":{"followerCount":1090,"postCount":375,"coverImage":{"id":"1*W2vzGrXR1ua5KN-X0m9oMw.jpeg","originalWidth":1920,"originalHeight":1431,"isFeatured":true}},"type":"Tag"}],"socialRecommendsCount":0,"responsesCreatedCount":1,"links":{"entries":[],"version":"0.3","generatedAt":1471930611885},"isLockedPreviewOnly":false,"takeoverId":"","metaDescription":"","totalClapCount":0},"coverless":true,"slug":"faceoff-theano-vs-tensorflow","translationSourcePostId":"","translationSourceCreatorId":"","isApprovedTranslation":false,"inResponseToPostId":"","inResponseToRemovedAt":0,"isTitleSynthesized":false,"allowResponses":true,"importedUrl":"","importedPublishedAt":0,"visibility":0,"uniqueSlug":"faceoff-theano-vs-tensorflow-e25648c31800","previewContent":{"bodyModel":{"paragraphs":[{"name":"previewImage","type":4,"text":"","layout":10,"metadata":{"id":"1*5JiPSy-VWASl7L9kflq4ag.png","originalWidth":2500,"originalHeight":1200}},{"name":"previewTitle","type":3,"text":"Theano vs Tensorflow","alignment":1},{"name":"previewSubtitle","type":13,"text":"Should you rewrite everything?","alignment":1}],"sections":[{"startIndex":0}]},"isFullContent":false},"license":0,"inResponseToMediaResourceId":"","canonicalUrl":"https://medium.com/@sentimentron/faceoff-theano-vs-tensorflow-e25648c31800","approvedHomeCollectionId":"","newsletterId":"","webCanonicalUrl":"https://medium.com/@sentimentron/faceoff-theano-vs-tensorflow-e25648c31800","mediumUrl":"https://medium.com/@sentimentron/faceoff-theano-vs-tensorflow-e25648c31800","migrationId":"","notifyFollowers":true,"notifyTwitter":false,"isSponsored":false,"isRequestToPubDisabled":false,"notifyFacebook":false,"responseHiddenOnParentPostAt":0,"isSeries":false,"isSubscriptionLocked":false,"seriesLastAppendedAt":0,"type":"Post"},"mentionedUsers":[],"collaborators":[],"membershipPlans":[],"collectionUserRelations":[],"mode":null,"references":{"User":{"ec21902de320":{"userId":"ec21902de320","name":"Richard Townsend","username":"sentimentron","createdAt":1447541736210,"lastPostCreatedAt":1488061363719,"imageId":"0*j0J7Tp44phEIV9r3.jpg","backgroundImageId":"","bio":"I program operating systems by day, and Natural Language models by night.","twitterScreenName":"","socialStats":{"userId":"ec21902de320","usersFollowedCount":6,"usersFollowedByCount":46,"type":"SocialStats"},"social":{"userId":"lo_caa1d2a5a575","targetUserId":"ec21902de320","type":"Social"},"facebookAccountId":"10153299829709226","allowNotes":1,"type":"User"}},"Social":{"ec21902de320":{"userId":"lo_caa1d2a5a575","targetUserId":"ec21902de320","type":"Social"}},"SocialStats":{"ec21902de320":{"userId":"ec21902de320","usersFollowedCount":6,"usersFollowedByCount":46,"type":"SocialStats"}}}})
// ]]></script><div class="surface-scrollOverlay"></div><script charset="UTF-8" src="./Theano vs Tensorflow – Richard Townsend – Medium_files/main-common-async.bundle.7qFbgfqtBohjBP8JeqhnQQ.js"></script><script charset="UTF-8" src="./Theano vs Tensorflow – Richard Townsend – Medium_files/main-notes.bundle.tKOqulXX3p97KoRSkYK7yQ.js"></script></body></html>